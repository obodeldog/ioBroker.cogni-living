const a0_0xfbe6b3=a0_0x9c2a;(function(_0x57b215,_0x3388d3){const _0x1e38e0=a0_0x9c2a,_0x51ca72=_0x57b215();while(!![]){try{const _0x5dcbea=-parseInt(_0x1e38e0(0x233))/0x1*(-parseInt(_0x1e38e0(0x20b))/0x2)+parseInt(_0x1e38e0(0x263))/0x3+parseInt(_0x1e38e0(0x1ac))/0x4*(parseInt(_0x1e38e0(0x1ed))/0x5)+-parseInt(_0x1e38e0(0x199))/0x6+parseInt(_0x1e38e0(0x2e4))/0x7*(parseInt(_0x1e38e0(0x1ad))/0x8)+parseInt(_0x1e38e0(0x2d0))/0x9+-parseInt(_0x1e38e0(0x138))/0xa;if(_0x5dcbea===_0x3388d3)break;else _0x51ca72['push'](_0x51ca72['shift']());}catch(_0x58a18e){_0x51ca72['push'](_0x51ca72['shift']());}}}(a0_0x57ed,0x92b2d));const a0_0x49aad5=(function(){let _0x5e3a93=!![];return function(_0x3b841d,_0x2d563b){const _0xcd28de=_0x5e3a93?function(){const _0x3baa09=a0_0x9c2a;if(_0x2d563b){const _0x583800=_0x2d563b[_0x3baa09(0x1d5)](_0x3b841d,arguments);return _0x2d563b=null,_0x583800;}}:function(){};return _0x5e3a93=![],_0xcd28de;};}()),a0_0x400e78=a0_0x49aad5(this,function(){const _0x298486=a0_0x9c2a;return a0_0x400e78[_0x298486(0x146)]()[_0x298486(0x1d4)](_0x298486(0x2cb))['toString']()['constructor'](a0_0x400e78)[_0x298486(0x1d4)](_0x298486(0x2cb));});a0_0x400e78();'use strict';const utils=require(a0_0xfbe6b3(0x2c9)),{GoogleGenerativeAI}=require(a0_0xfbe6b3(0x1a9)),schedule=require(a0_0xfbe6b3(0x1ee)),{spawn,exec}=require('child_process'),path=require(a0_0xfbe6b3(0x191)),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0xfbe6b3(0x1ca),LTM_SCHEDULE=a0_0xfbe6b3(0x2b8),MODE_RESET_SCHEDULE=a0_0xfbe6b3(0x140),ANALYSIS_HISTORY_MAX_SIZE=0x64,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,LTM_DP_RAW_LOG=a0_0xfbe6b3(0x13f),LTM_DP_DAILY_DIGESTS=a0_0xfbe6b3(0x1b6),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0xfbe6b3(0x2cf),LTM_DP_BASELINE_STATUS=a0_0xfbe6b3(0x26d),LTM_DP_DRIFT_CHANNEL=a0_0xfbe6b3(0x2f9),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0xfbe6b3(0x1f1),LTM_DP_DRIFT_LAST_CHECK=a0_0xfbe6b3(0x135),SYSTEM_DP_MODE='system.mode',HARD_IGNORE_TERMS=['scriptProblem',a0_0xfbe6b3(0x27c),a0_0xfbe6b3(0x236),a0_0xfbe6b3(0x160),a0_0xfbe6b3(0x1dd),a0_0xfbe6b3(0x25a),a0_0xfbe6b3(0x1c2),a0_0xfbe6b3(0x1a4),a0_0xfbe6b3(0x12f),a0_0xfbe6b3(0x223),a0_0xfbe6b3(0x27d),a0_0xfbe6b3(0x18d),a0_0xfbe6b3(0x32e),a0_0xfbe6b3(0x2db),a0_0xfbe6b3(0x1f9),a0_0xfbe6b3(0x331),'reachable',a0_0xfbe6b3(0x194)],BAD_NAMES=['targetposition',a0_0xfbe6b3(0x2d8),a0_0xfbe6b3(0x181),a0_0xfbe6b3(0x274),a0_0xfbe6b3(0x1a6),a0_0xfbe6b3(0x262),'on',a0_0xfbe6b3(0x2f0),a0_0xfbe6b3(0x16d),a0_0xfbe6b3(0x22d),'shutter','blind',a0_0xfbe6b3(0x14c),a0_0xfbe6b3(0x214),a0_0xfbe6b3(0x177),a0_0xfbe6b3(0x27e),a0_0xfbe6b3(0x143),a0_0xfbe6b3(0x32b),a0_0xfbe6b3(0x330),a0_0xfbe6b3(0x1e7),'energy',a0_0xfbe6b3(0x24b),a0_0xfbe6b3(0x142),'actual_temperature',a0_0xfbe6b3(0x231)],ADAPTER_BLACKLIST=['system.',a0_0xfbe6b3(0x2ac),'info.',a0_0xfbe6b3(0x1b9),'history.',a0_0xfbe6b3(0x200),a0_0xfbe6b3(0x238),a0_0xfbe6b3(0x33a),a0_0xfbe6b3(0x227),a0_0xfbe6b3(0x25b),a0_0xfbe6b3(0x1b4)],SYSTEM_MODES={'NORMAL':a0_0xfbe6b3(0x261),'VACATION':a0_0xfbe6b3(0x1a0),'PARTY':'party','GUEST':a0_0xfbe6b3(0x2c4)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0xfbe6b3(0x278)],SYSTEM_MODES[a0_0xfbe6b3(0x259)]],PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen.','senior_aal':'PRIORITÃ„T:\x20Gesundheit/AAL.','family':a0_0xfbe6b3(0x234),'single_comfort':'Fokus\x20auf\x20Komfort.','security':a0_0xfbe6b3(0x239)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0};let activeSequence=[],sequenceTimer=null;async function initZombies(_0x1a151a){const _0x4aaf6d=a0_0xfbe6b3;try{const _0x5dfac9=[_0x4aaf6d(0x1c3),_0x4aaf6d(0x21f)];for(const _0x22e28c of _0x5dfac9){try{const _0x54977f=await _0x1a151a['getObjectAsync'](_0x22e28c);_0x54977f&&await _0x1a151a['delObjectAsync'](_0x22e28c);}catch(_0xb89bc1){}}}catch(_0x29ff77){}}async function initHistory(_0x5e1578){const _0x5e6e31=a0_0xfbe6b3;try{const _0x56ac97=await _0x5e1578[_0x5e6e31(0x2be)](_0x5e6e31(0x1c1));_0x56ac97&&_0x56ac97[_0x5e6e31(0x1fc)]&&(_0x5e1578['eventHistory']=JSON['parse'](_0x56ac97[_0x5e6e31(0x1fc)][_0x5e6e31(0x146)]()));}catch(_0x3eabeb){_0x5e1578[_0x5e6e31(0x315)]=[];}try{const _0x1ab8f2=await _0x5e1578[_0x5e6e31(0x2be)](_0x5e6e31(0x256));if(_0x1ab8f2&&_0x1ab8f2[_0x5e6e31(0x1fc)])_0x5e1578[_0x5e6e31(0x185)]=JSON['parse'](_0x1ab8f2[_0x5e6e31(0x1fc)][_0x5e6e31(0x146)]());}catch(_0xd151f6){_0x5e1578['analysisHistory']=[];}if(_0x5e1578[_0x5e6e31(0x315)]&&_0x5e1578['eventHistory'][_0x5e6e31(0x334)]>0x0){_0x5e1578[_0x5e6e31(0x18e)]['info'](_0x5e6e31(0x308)+_0x5e1578['eventHistory'][_0x5e6e31(0x334)]+_0x5e6e31(0x31e));for(let _0xec7c52=_0x5e1578[_0x5e6e31(0x315)][_0x5e6e31(0x334)]-0x1;_0xec7c52>=0x0;_0xec7c52--){const _0x9d01e5=_0x5e1578['eventHistory'][_0xec7c52];_0x9d01e5&&_0x9d01e5['id']!==undefined&&_0x9d01e5[_0x5e6e31(0x1a6)]!==undefined&&(_0x5e1578[_0x5e6e31(0x2b2)][_0x9d01e5['id']]=_0x9d01e5[_0x5e6e31(0x1a6)]);}}}async function initSystemConfig(_0x5630b4){const _0x278b88=a0_0xfbe6b3;try{const _0x48705a=await _0x5630b4[_0x278b88(0x31d)]('system.config');_0x48705a&&_0x48705a[_0x278b88(0x18f)]&&(_0x5630b4[_0x278b88(0x29c)]={'latitude':_0x48705a[_0x278b88(0x18f)][_0x278b88(0x1cf)]||0x0,'longitude':_0x48705a[_0x278b88(0x18f)][_0x278b88(0x317)]||0x0,'city':_0x48705a[_0x278b88(0x18f)][_0x278b88(0x314)]||''});}catch(_0xe2fbfe){}}async function checkLicense(_0x579b24,_0x15965a){const _0x205403=a0_0xfbe6b3;if(!_0x15965a)return![];_0x579b24['systemUUID']=await getSystemUUID(_0x579b24);if(_0x15965a===_0x205403(0x2c7)||_0x15965a[_0x205403(0x13c)](_0x205403(0x26a)))return!![];return![];}async function getSystemUUID(_0x46b6df){const _0xd64ad9=a0_0xfbe6b3;try{const _0x5e4a0e=await _0x46b6df[_0xd64ad9(0x31d)](_0xd64ad9(0x24d));if(_0x5e4a0e&&_0x5e4a0e[_0xd64ad9(0x1b7)]&&_0x5e4a0e[_0xd64ad9(0x1b7)][_0xd64ad9(0x291)])return _0x5e4a0e['native'][_0xd64ad9(0x291)];return'uuid-not-found';}catch(_0x20747f){return'uuid-error';}}async function createAllObjects(_0x1a2cb6){const _0x2e396f=a0_0xfbe6b3;await checkSystemObjects(_0x1a2cb6),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x2ae),{'type':'state','common':{'name':'Who\x20is\x20present?','type':_0x2e396f(0x1da),'role':_0x2e396f(0x23f),'read':!![],'write':![],'def':''},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x284),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x257),'type':'string','role':_0x2e396f(0x286),'read':!![],'write':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x1c1),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x250),'type':_0x2e396f(0x1da),'role':_0x2e396f(0x286),'read':!![],'write':![]},'native':{}}),await _0x1a2cb6['setObjectNotExistsAsync'](_0x2e396f(0x156),{'type':'state','common':{'name':'Trigger\x20Analysis','type':'boolean','role':_0x2e396f(0x2fd),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x316),{'type':_0x2e396f(0x181),'common':{'name':'Trigger\x20Briefing\x20(Test)','type':_0x2e396f(0x309),'role':_0x2e396f(0x2fd),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)]('analysis.lastResult',{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x31b),'type':_0x2e396f(0x1da),'role':_0x2e396f(0x286),'read':!![],'write':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x241),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x26e),'type':'boolean','role':_0x2e396f(0x235),'read':!![],'write':![],'def':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x2a6),{'type':'state','common':{'name':_0x2e396f(0x28b),'type':_0x2e396f(0x309),'role':_0x2e396f(0x311),'read':!![],'write':![],'def':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x20f),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x26c),'type':_0x2e396f(0x1da),'role':_0x2e396f(0x19b),'read':!![],'write':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)]('analysis.activitySummary',{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x147),'type':_0x2e396f(0x1da),'role':_0x2e396f(0x23f),'read':!![],'write':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x2f8),{'type':'state','common':{'name':'Deviation','type':_0x2e396f(0x1da),'role':_0x2e396f(0x181),'read':!![],'write':![],'def':'N/A'},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x20e),{'type':'state','common':{'name':_0x2e396f(0x305),'type':'string','role':_0x2e396f(0x23f),'read':!![],'write':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x1d3),{'type':'state','common':{'name':_0x2e396f(0x1f6),'type':_0x2e396f(0x1da),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1a2cb6['extendObjectAsync'](_0x2e396f(0x292),{'type':_0x2e396f(0x303),'common':{'name':_0x2e396f(0x228)},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x2ba),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x24c),'type':_0x2e396f(0x309),'role':_0x2e396f(0x180),'read':!![],'write':![],'def':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x2e8),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x2a1),'type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x15b),{'type':'state','common':{'name':_0x2e396f(0x1ce),'type':_0x2e396f(0x1da),'role':_0x2e396f(0x23f),'read':!![],'write':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x230),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x130),'type':_0x2e396f(0x1da),'role':'text','read':!![],'write':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x205),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x255),'type':'string','role':_0x2e396f(0x23f),'read':!![],'write':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x144),{'type':_0x2e396f(0x181),'common':{'name':'Auto\x20Apply\x20Rule','type':_0x2e396f(0x309),'role':_0x2e396f(0x16d),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x279),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x30f),'type':'boolean','role':_0x2e396f(0x2fd),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x1a2cb6['setObjectNotExistsAsync'](_0x2e396f(0x256),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x13e),'type':_0x2e396f(0x1da),'role':_0x2e396f(0x286),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)]('analysis.feedbackHistory',{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x276),'type':_0x2e396f(0x1da),'role':_0x2e396f(0x286),'read':!![],'write':![],'def':'[]'},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2b5)](_0x2e396f(0x1cd),{'type':_0x2e396f(0x303),'common':{'name':_0x2e396f(0x2e2)},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x322),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x1c4),'type':_0x2e396f(0x27f),'role':_0x2e396f(0x296),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x196),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x193),'type':_0x2e396f(0x1da),'role':'text','read':!![],'write':![],'def':'none'},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x29f),{'type':'state','common':{'name':'Health\x20Notes','type':_0x2e396f(0x1da),'role':_0x2e396f(0x23f),'read':!![],'write':![],'def':''},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x21b),{'type':'state','common':{'name':_0x2e396f(0x226),'type':_0x2e396f(0x1da),'role':_0x2e396f(0x23f),'read':!![],'write':![],'def':_0x2e396f(0x224)},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)]('analysis.health.trendValue',{'type':'state','common':{'name':_0x2e396f(0x2f4),'type':_0x2e396f(0x27f),'role':_0x2e396f(0x1a6),'read':!![],'write':![],'def':0x0},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2b5)]('LTM.trainingData',{'type':_0x2e396f(0x303),'common':{'name':_0x2e396f(0x273)},'native':{}}),await _0x1a2cb6['setObjectNotExistsAsync']('LTM.trainingData.sequences',{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x265),'type':_0x2e396f(0x1da),'role':_0x2e396f(0x286),'read':!![],'write':![],'def':'[]','desc':_0x2e396f(0x246)},'native':{}}),await _0x1a2cb6[_0x2e396f(0x2da)](_0x2e396f(0x157),{'type':_0x2e396f(0x181),'common':{'name':_0x2e396f(0x202),'type':_0x2e396f(0x1da),'role':_0x2e396f(0x286),'read':!![],'write':![],'def':'[]','desc':_0x2e396f(0x1a3)},'native':{}}),await checkLtmObjects(_0x1a2cb6),await checkLtmDriftObjects(_0x1a2cb6);}async function checkSystemObjects(_0x3ab962){const _0x213c92=a0_0xfbe6b3;await _0x3ab962['extendObjectAsync'](_0x213c92(0x2c6),{'type':'channel','common':{'name':'System\x20Status\x20&\x20Control'},'native':{}}),await _0x3ab962[_0x213c92(0x2b5)](SYSTEM_DP_MODE,{'type':_0x213c92(0x181),'common':{'name':'System\x20Mode','type':_0x213c92(0x1da),'role':_0x213c92(0x181),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x213c92(0x206)],'states':{[SYSTEM_MODES['NORMAL']]:'Normal',[SYSTEM_MODES[_0x213c92(0x23d)]]:_0x213c92(0x287),[SYSTEM_MODES[_0x213c92(0x278)]]:'Party',[SYSTEM_MODES[_0x213c92(0x259)]]:_0x213c92(0x299)}},'native':{}});}async function checkLtmObjects(_0x3e27f7){const _0x3e73ce=a0_0xfbe6b3;await _0x3e27f7[_0x3e73ce(0x2b5)](_0x3e73ce(0x132),{'type':_0x3e73ce(0x303),'common':{'name':_0x3e73ce(0x132)},'native':{}}),await _0x3e27f7[_0x3e73ce(0x2b5)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x3e73ce(0x175),'type':_0x3e73ce(0x1da),'role':_0x3e73ce(0x286),'read':!![],'write':![]},'native':{}}),await _0x3e27f7[_0x3e73ce(0x2b5)](LTM_DP_DAILY_DIGESTS,{'type':'state','common':{'name':_0x3e73ce(0x133),'type':_0x3e73ce(0x1da),'role':'json','read':!![],'write':![]},'native':{}}),await _0x3e27f7[_0x3e73ce(0x2b5)](LTM_DP_STATUS,{'type':_0x3e73ce(0x181),'common':{'name':_0x3e73ce(0x19c),'type':'string','role':_0x3e73ce(0x23f),'read':!![],'write':![]},'native':{}}),await _0x3e27f7[_0x3e73ce(0x2b5)](LTM_DP_TRIGGER_DIGEST,{'type':_0x3e73ce(0x181),'common':{'name':'Trigger\x20Digest','type':'boolean','role':_0x3e73ce(0x2fd),'read':!![],'write':!![],'def':![]},'native':{}}),await _0x3e27f7[_0x3e73ce(0x2b5)](LTM_DP_BASELINE_STATUS,{'type':_0x3e73ce(0x181),'common':{'name':'Baseline\x20Status','type':_0x3e73ce(0x1da),'role':'text','read':!![],'write':![]},'native':{}});}async function checkLtmDriftObjects(_0x473ef2){const _0x4b8c56=a0_0xfbe6b3;await _0x473ef2[_0x4b8c56(0x2b5)](LTM_DP_DRIFT_CHANNEL,{'type':_0x4b8c56(0x303),'common':{'name':_0x4b8c56(0x2a9)},'native':{}}),await _0x473ef2['extendObjectAsync'](LTM_DP_DRIFT_STATUS,{'type':_0x4b8c56(0x181),'common':{'name':_0x4b8c56(0x29e),'type':_0x4b8c56(0x1da),'role':_0x4b8c56(0x181),'read':!![],'write':![],'def':_0x4b8c56(0x224)},'native':{}}),await _0x473ef2[_0x4b8c56(0x2b5)](LTM_DP_DRIFT_DETAILS,{'type':'state','common':{'name':_0x4b8c56(0x166),'type':_0x4b8c56(0x1da),'role':_0x4b8c56(0x23f),'read':!![],'write':![]},'native':{}}),await _0x473ef2[_0x4b8c56(0x2b5)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x4b8c56(0x181),'common':{'name':_0x4b8c56(0x220),'type':_0x4b8c56(0x27f),'role':_0x4b8c56(0x1e2),'read':!![],'write':![]},'native':{}});}async function loadSystemMode(_0x2fccae){const _0x4089ab=a0_0xfbe6b3;try{const _0x443e78=await _0x2fccae[_0x4089ab(0x2be)](SYSTEM_DP_MODE);_0x443e78&&_0x443e78['val']&&Object[_0x4089ab(0x15a)](SYSTEM_MODES)['includes'](_0x443e78[_0x4089ab(0x1fc)])?_0x2fccae['currentSystemMode']=_0x443e78['val']:(_0x2fccae[_0x4089ab(0x131)]=SYSTEM_MODES[_0x4089ab(0x206)],await _0x2fccae[_0x4089ab(0x15d)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x4089ab(0x206)],'ack':!![]}));}catch(_0x3400e6){_0x2fccae[_0x4089ab(0x131)]=SYSTEM_MODES[_0x4089ab(0x206)];}}async function loadRawEventLog(_0x148194){const _0x5f5bd2=a0_0xfbe6b3;try{const _0x3fdf7a=await _0x148194[_0x5f5bd2(0x2be)](LTM_DP_RAW_LOG);if(_0x3fdf7a&&_0x3fdf7a[_0x5f5bd2(0x1fc)])_0x148194[_0x5f5bd2(0x169)]=JSON['parse'](_0x3fdf7a[_0x5f5bd2(0x1fc)]);}catch(_0x3f20bb){_0x148194['rawEventLog']=[];}}async function saveRawEventLog(_0xb75077){const _0x51861d=a0_0xfbe6b3;_0xb75077[_0x51861d(0x169)][_0x51861d(0x334)]>RAW_LOG_MAX_SIZE&&_0xb75077[_0x51861d(0x169)]['splice'](0x0,_0xb75077[_0x51861d(0x169)][_0x51861d(0x334)]-RAW_LOG_MAX_SIZE),await _0xb75077[_0x51861d(0x15d)](LTM_DP_RAW_LOG,{'val':JSON[_0x51861d(0x139)](_0xb75077['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x5971a5){const _0x1333a9=a0_0xfbe6b3;try{const _0x51cdd1=await _0x5971a5[_0x1333a9(0x2be)](LTM_DP_DAILY_DIGESTS);if(_0x51cdd1&&_0x51cdd1['val'])_0x5971a5[_0x1333a9(0x2aa)]=JSON['parse'](_0x51cdd1['val']);}catch(_0x27e3bd){_0x5971a5['dailyDigests']=[];}await updateBaselineStatus(_0x5971a5);}async function saveDailyDigests(_0xecba82,_0x482b9f=!![]){const _0xf5bd29=a0_0xfbe6b3,_0x2a5448=_0xecba82['config'][_0xf5bd29(0x1db)]||0x3c;_0xecba82[_0xf5bd29(0x2aa)]['length']>_0x2a5448&&_0xecba82[_0xf5bd29(0x2aa)][_0xf5bd29(0x1df)](0x0,_0xecba82[_0xf5bd29(0x2aa)][_0xf5bd29(0x334)]-_0x2a5448);await _0xecba82[_0xf5bd29(0x15d)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0xecba82['dailyDigests']),'ack':!![]});if(_0x482b9f)await updateBaselineStatus(_0xecba82);}async function updateAnalysisHistory(_0xfc12c3,_0x45e521){const _0xdbdc79=a0_0xfbe6b3;_0xfc12c3['analysisHistory'][_0xdbdc79(0x168)](_0x45e521);if(_0xfc12c3[_0xdbdc79(0x185)][_0xdbdc79(0x334)]>ANALYSIS_HISTORY_MAX_SIZE)_0xfc12c3[_0xdbdc79(0x185)][_0xdbdc79(0x204)]();await _0xfc12c3[_0xdbdc79(0x15d)](_0xdbdc79(0x256),{'val':JSON[_0xdbdc79(0x139)](_0xfc12c3[_0xdbdc79(0x185)]),'ack':!![]});}async function updateBaselineStatus(_0x14a132){const _0x5235e1=a0_0xfbe6b3;if(!_0x14a132[_0x5235e1(0x149)]){await _0x14a132[_0x5235e1(0x15d)](LTM_DP_BASELINE_STATUS,{'val':_0x5235e1(0x155),'ack':!![]});return;}const _0xaba0f9=_0x14a132[_0x5235e1(0x2aa)][_0x5235e1(0x334)]>=(_0x14a132[_0x5235e1(0x232)]['minDaysForBaseline']||0x7)?'Aktiv\x20('+_0x14a132[_0x5235e1(0x2aa)][_0x5235e1(0x334)]+'\x20Tage)':_0x5235e1(0x14f)+_0x14a132['dailyDigests'][_0x5235e1(0x334)]+'/'+(_0x14a132[_0x5235e1(0x232)][_0x5235e1(0x201)]||0x7)+')';await _0x14a132['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0xaba0f9,'ack':!![]});}async function initSensorSubscriptions(_0x798e54){const _0x45c62f=a0_0xfbe6b3,_0xd571d1=_0x798e54['config']['devices'];if(_0xd571d1&&_0xd571d1['length']>0x0){_0x798e54[_0x45c62f(0x18e)][_0x45c62f(0x2e0)](_0x45c62f(0x21d)+_0xd571d1['length']+'\x20sensors...');for(const _0x2c8cfe of _0xd571d1){if(_0x2c8cfe['id']){await _0x798e54[_0x45c62f(0x32c)](_0x2c8cfe['id']);try{const _0x3af4a3=await _0x798e54[_0x45c62f(0x24a)](_0x2c8cfe['id']);if(_0x3af4a3)_0x798e54[_0x45c62f(0x2b2)][_0x2c8cfe['id']]=_0x3af4a3[_0x45c62f(0x1fc)];}catch(_0x2bed49){}}}}}async function initPresenceSubscriptions(_0x248b0e){const _0x5e616a=a0_0xfbe6b3,_0xfd6dd2=_0x248b0e[_0x5e616a(0x232)][_0x5e616a(0x240)]||[];if(_0xfd6dd2['length']>0x0){_0x248b0e[_0x5e616a(0x18e)][_0x5e616a(0x2e0)]('Subscribing\x20to\x20'+_0xfd6dd2['length']+_0x5e616a(0x1d0));for(const _0x5b613e of _0xfd6dd2){await _0x248b0e[_0x5e616a(0x32c)](_0x5b613e);}try{await checkWifiPresence(_0x248b0e);}catch(_0x107788){}}}async function getWeatherContext(_0x1af746){const _0x15a233=a0_0xfbe6b3;try{if(!_0x1af746[_0x15a233(0x232)][_0x15a233(0x2b4)])return'Wetter:\x20Deaktiviert';let _0x56ea05='';const _0x267333=_0x1af746[_0x15a233(0x232)][_0x15a233(0x23e)];if(_0x267333)try{if(_0x267333[_0x15a233(0x12c)]('accuweather')){const _0x3c40cf=await _0x1af746[_0x15a233(0x24a)](_0x267333+_0x15a233(0x1de));if(_0x3c40cf&&_0x3c40cf[_0x15a233(0x1fc)])_0x56ea05=_0x3c40cf[_0x15a233(0x1fc)];}else{if(_0x267333[_0x15a233(0x12c)](_0x15a233(0x161))){const _0x1d7288=await _0x1af746[_0x15a233(0x24a)](_0x267333+_0x15a233(0x1bc));if(_0x1d7288&&_0x1d7288[_0x15a233(0x1fc)])_0x56ea05=_0x1d7288[_0x15a233(0x1fc)];}else{if(_0x267333['includes'](_0x15a233(0x158))){const _0x1a138d=await _0x1af746['getForeignStateAsync'](_0x267333+'.forecast.current.state');if(_0x1a138d&&_0x1a138d[_0x15a233(0x1fc)])_0x56ea05=_0x1a138d[_0x15a233(0x1fc)];}}}}catch(_0x5203c0){}if(!_0x56ea05){const _0x4e4a7b=['accuweather.0',_0x15a233(0x26f),_0x15a233(0x326),'openweathermap.0'];for(const _0x22343e of _0x4e4a7b){try{const _0xba08dd=await _0x1af746[_0x15a233(0x31d)](_0x22343e);if(_0xba08dd){if(_0x22343e[_0x15a233(0x12c)](_0x15a233(0x27a))){const _0x356584=await _0x1af746['getForeignStateAsync'](_0x22343e+_0x15a233(0x1de));if(_0x356584&&_0x356584[_0x15a233(0x1fc)]){_0x56ea05=_0x356584[_0x15a233(0x1fc)];break;}}}}catch(_0x631f99){}}}return _0x56ea05?_0x15a233(0x19e)+_0x56ea05:'WETTER:\x20Keine\x20Daten\x20gefunden';}catch(_0x27a324){return'WETTER\x20ERROR:\x20'+_0x27a324[_0x15a233(0x30b)];}}async function getCalendarContext(_0x133c71){const _0x2a3b57=a0_0xfbe6b3;try{if(!_0x133c71['config'][_0x2a3b57(0x329)])return _0x2a3b57(0x171);let _0x571b29=_0x133c71['config']['calendarInstance']||_0x2a3b57(0x25c),_0x54b770=_0x133c71[_0x2a3b57(0x232)]['calendarSelection']||[];if(typeof _0x54b770==='string')_0x54b770=_0x54b770['split'](',');try{const _0x487de6=await _0x133c71['getForeignStateAsync'](_0x571b29+'.data.table');if(_0x487de6&&_0x487de6[_0x2a3b57(0x1fc)]){let _0x53bdba=tryParse(_0x487de6[_0x2a3b57(0x1fc)]);if(_0x53bdba&&Array['isArray'](_0x53bdba)){if(_0x54b770[_0x2a3b57(0x334)]>0x0)_0x53bdba=_0x53bdba[_0x2a3b57(0x1dc)](_0x274278=>_0x54b770[_0x2a3b57(0x12c)](_0x274278['_calName']||''));else return _0x2a3b57(0x2e5);if(_0x53bdba['length']>0x0){const _0x3ed520=_0x53bdba[_0x2a3b57(0x1e8)](0x0,0x3)[_0x2a3b57(0x2d6)](_0x42a7a8=>{const _0x555116=_0x2a3b57;let _0x54beae=_0x42a7a8[_0x555116(0x1e2)];if(_0x42a7a8[_0x555116(0x159)])_0x54beae+='\x20'+_0x42a7a8[_0x555116(0x159)];return _0x54beae+':\x20'+_0x42a7a8[_0x555116(0x1f8)]+'\x20('+_0x42a7a8[_0x555116(0x2d5)]+')';});return _0x2a3b57(0x1f5)+_0x3ed520[_0x2a3b57(0x21a)](_0x2a3b57(0x1bd));}else return _0x2a3b57(0x336);}}}catch(_0x4524f7){_0x133c71['log']['warn'](_0x2a3b57(0x217)+_0x4524f7[_0x2a3b57(0x30b)]);}return _0x2a3b57(0x1f4);}catch(_0x3c008b){return _0x2a3b57(0x203)+_0x3c008b['message'];}}async function getCalendarNames(_0x1c5b27,_0x3b16b9){const _0x1ba3f6=a0_0xfbe6b3;try{const _0x54624f=await _0x1c5b27[_0x1ba3f6(0x24a)](_0x3b16b9+_0x1ba3f6(0x1a8));if(_0x54624f&&_0x54624f[_0x1ba3f6(0x1fc)]){const _0x225c8d=tryParse(_0x54624f['val']);if(_0x225c8d&&Array['isArray'](_0x225c8d)){const _0x1d2e7c=[...new Set(_0x225c8d['map'](_0x5ab6dd=>_0x5ab6dd[_0x1ba3f6(0x2d5)])[_0x1ba3f6(0x1dc)](Boolean))];return _0x1d2e7c[_0x1ba3f6(0x22a)]();}}return[];}catch(_0x3f737f){return _0x1c5b27[_0x1ba3f6(0x18e)]['error']('getCalendarNames\x20Error:\x20'+_0x3f737f['message']),[];}}async function checkWifiPresence(_0x540749){const _0x91741e=a0_0xfbe6b3;try{const _0x4aa150=_0x540749['config'][_0x91741e(0x240)]||[];let _0x514776=![];const _0x1e3ef1=[];for(const _0x30d79d of _0x4aa150){try{const _0x3c3c76=await _0x540749[_0x91741e(0x24a)](_0x30d79d);if(_0x3c3c76&&(_0x3c3c76['val']===!![]||_0x3c3c76[_0x91741e(0x1fc)]===_0x91741e(0x2e6)||_0x3c3c76[_0x91741e(0x1fc)]===0x1)){_0x514776=!![];const _0x3c7d6a=await _0x540749['getForeignObjectAsync'](_0x30d79d);let _0x583a35=_0x30d79d;_0x3c7d6a&&_0x3c7d6a[_0x91741e(0x18f)]&&_0x3c7d6a['common'][_0x91741e(0x1f2)]&&(_0x583a35=typeof _0x3c7d6a[_0x91741e(0x18f)]['name']===_0x91741e(0x172)?_0x3c7d6a[_0x91741e(0x18f)]['name']['de']||_0x3c7d6a[_0x91741e(0x18f)][_0x91741e(0x1f2)]['en']:_0x3c7d6a['common'][_0x91741e(0x1f2)]),_0x1e3ef1[_0x91741e(0x178)](_0x583a35);}}catch(_0x229be8){}}return await _0x540749['setStateAsync']('system.presenceWho',{'val':_0x1e3ef1[_0x91741e(0x21a)](',\x20'),'ack':!![]}),_0x514776&&(_0x540749[_0x91741e(0x1be)]&&(_0x540749[_0x91741e(0x18e)][_0x91741e(0x2e0)](_0x91741e(0x30a)),abortExitTimer(_0x540749)),!_0x540749[_0x91741e(0x22c)]&&_0x540749[_0x91741e(0x131)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x540749,!![])),_0x514776;}catch(_0x1515f9){return _0x540749[_0x91741e(0x18e)][_0x91741e(0x12f)]('Error\x20checking\x20WiFi:\x20'+_0x1515f9['message']),![];}}function startExitTimer(_0x44343e){const _0x258169=a0_0xfbe6b3;abortExitTimer(_0x44343e),_0x44343e[_0x258169(0x186)]=!![],_0x44343e['exitGraceTimer']=setTimeout(()=>{const _0x2b5b32=_0x258169;_0x44343e[_0x2b5b32(0x186)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x44343e['exitTimer']=setTimeout(()=>{const _0xe6dcd8=_0x258169;setPresence(_0x44343e,![]),_0x44343e[_0xe6dcd8(0x1be)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x4b45b3){const _0xda1029=a0_0xfbe6b3;if(_0x4b45b3[_0xda1029(0x1be)])clearTimeout(_0x4b45b3[_0xda1029(0x1be)]);if(_0x4b45b3['exitGraceTimer'])clearTimeout(_0x4b45b3[_0xda1029(0x17a)]);_0x4b45b3['exitTimer']=null,_0x4b45b3[_0xda1029(0x17a)]=null,_0x4b45b3[_0xda1029(0x186)]=![];}async function setPresence(_0x4702f3,_0x1feb3f){const _0x51545a=a0_0xfbe6b3;if(_0x4702f3[_0x51545a(0x22c)]===_0x1feb3f)return;_0x4702f3[_0x51545a(0x22c)]=_0x1feb3f,await _0x4702f3[_0x51545a(0x15d)](_0x51545a(0x247),{'val':_0x1feb3f,'ack':!![]});}async function saveFeedback(_0x176156,_0x3ba015){const _0x36abae=a0_0xfbe6b3;_0x176156[_0x36abae(0x18e)][_0x36abae(0x2e0)](_0x36abae(0x2ca)+JSON[_0x36abae(0x139)](_0x3ba015));}async function runBaselineDriftAnalysis(_0x17aba2){const _0x5583fa=a0_0xfbe6b3;if(!_0x17aba2[_0x5583fa(0x149)]||!_0x17aba2[_0x5583fa(0x16b)])return;const _0x51bebb=_0x17aba2['config'][_0x5583fa(0x32d)]||0xe;if(_0x17aba2[_0x5583fa(0x2aa)]['length']<_0x51bebb+(_0x17aba2[_0x5583fa(0x232)][_0x5583fa(0x201)]||0x7)){await _0x17aba2[_0x5583fa(0x15d)](LTM_DP_DRIFT_STATUS,{'val':_0x5583fa(0x2c3),'ack':!![]});return;}const _0xcb9078=_0x17aba2[_0x5583fa(0x2aa)][_0x5583fa(0x1e8)](-_0x51bebb),_0x5ef63c=_0x17aba2[_0x5583fa(0x2aa)][_0x5583fa(0x1e8)](0x0,_0x17aba2[_0x5583fa(0x2aa)][_0x5583fa(0x334)]-_0x51bebb),_0x50a56d=_0x5583fa(0x22b)+JSON['stringify'](_0x5ef63c)+_0x5583fa(0x2a7)+JSON['stringify'](_0xcb9078);try{const _0x489f78=await _0x17aba2['geminiModel'][_0x5583fa(0x285)](_0x50a56d),_0x215bae=JSON[_0x5583fa(0x2e9)](_0x489f78[_0x5583fa(0x268)]['text']()[_0x5583fa(0x19d)](/```json|```/g,'')['trim']());_0x215bae['baselineDrift']&&(await _0x17aba2[_0x5583fa(0x15d)](LTM_DP_DRIFT_STATUS,{'val':_0x215bae[_0x5583fa(0x333)],'ack':!![]}),await _0x17aba2[_0x5583fa(0x15d)](LTM_DP_DRIFT_DETAILS,{'val':_0x215bae[_0x5583fa(0x212)],'ack':!![]}),await _0x17aba2['setStateAsync'](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x5583fa(0x1b5)](),'ack':!![]}));}catch(_0x308c4e){}}function setupLtmScheduler(_0x2aa3b8){const _0x5b1785=a0_0xfbe6b3;try{if(_0x2aa3b8[_0x5b1785(0x22f)])_0x2aa3b8[_0x5b1785(0x22f)][_0x5b1785(0x1fe)]();if(!_0x2aa3b8[_0x5b1785(0x149)]){_0x2aa3b8['setStateAsync'](LTM_DP_STATUS,{'val':'Deaktiviert\x20(Pro-Feature)','ack':!![]});return;}_0x2aa3b8[_0x5b1785(0x22f)]=schedule[_0x5b1785(0x2b1)](LTM_SCHEDULE,()=>createDailyDigest(_0x2aa3b8));}catch(_0x5e16f5){_0x2aa3b8[_0x5b1785(0x18e)][_0x5b1785(0x12f)]('LTM\x20Sched\x20Error:\x20'+_0x5e16f5[_0x5b1785(0x30b)]);}}function setupModeResetScheduler(_0x19e74b){const _0x355ed4=a0_0xfbe6b3;try{if(_0x19e74b[_0x355ed4(0x283)])_0x19e74b[_0x355ed4(0x283)][_0x355ed4(0x1fe)]();_0x19e74b[_0x355ed4(0x283)]=schedule[_0x355ed4(0x2b1)](MODE_RESET_SCHEDULE,async()=>{const _0x266d75=_0x355ed4;await loadSystemMode(_0x19e74b),AUTO_RESET_MODES[_0x266d75(0x12c)](_0x19e74b[_0x266d75(0x131)])&&await _0x19e74b[_0x266d75(0x15d)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x266d75(0x206)],'ack':![]});});}catch(_0x52c010){_0x19e74b[_0x355ed4(0x18e)][_0x355ed4(0x12f)](_0x355ed4(0x245)+_0x52c010['message']);}}function setupDriftAnalysisScheduler(_0x483576){const _0x2f0ab9=a0_0xfbe6b3;try{if(_0x483576['driftAnalysisTimer'])clearInterval(_0x483576[_0x2f0ab9(0x208)]);if(!_0x483576[_0x2f0ab9(0x149)])return;_0x483576[_0x2f0ab9(0x208)]=setInterval(()=>runBaselineDriftAnalysis(_0x483576),(_0x483576[_0x2f0ab9(0x232)][_0x2f0ab9(0x2a2)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x483576),0x1388);}catch(_0x2b0114){_0x483576[_0x2f0ab9(0x18e)][_0x2f0ab9(0x12f)](_0x2f0ab9(0x187)+_0x2b0114[_0x2f0ab9(0x30b)]);}}function setupBriefingScheduler(_0x1151fe){const _0x5f00e3=a0_0xfbe6b3;try{if(_0x1151fe[_0x5f00e3(0x190)])_0x1151fe['briefingJob'][_0x5f00e3(0x1fe)]();if(!_0x1151fe[_0x5f00e3(0x232)][_0x5f00e3(0x28a)])return;const _0x4bc07a=(_0x1151fe['config'][_0x5f00e3(0x1b0)]||_0x5f00e3(0x195))['split'](':'),_0x227837=parseInt(_0x4bc07a[0x0])||0x8,_0x45ec0b=parseInt(_0x4bc07a[0x1])||0x0,_0x43bf78=_0x45ec0b+'\x20'+_0x227837+_0x5f00e3(0x1c0);_0x1151fe[_0x5f00e3(0x18e)][_0x5f00e3(0x2e0)](_0x5f00e3(0x304)+_0x227837+':'+(_0x45ec0b<0xa?'0'+_0x45ec0b:_0x45ec0b)),_0x1151fe[_0x5f00e3(0x190)]=schedule[_0x5f00e3(0x2b1)](_0x43bf78,()=>{sendMorningBriefing(_0x1151fe);});}catch(_0x526ce5){_0x1151fe[_0x5f00e3(0x18e)][_0x5f00e3(0x12f)](_0x5f00e3(0x2f5)+_0x526ce5[_0x5f00e3(0x30b)]);}}async function sendNotification(_0x1124a5,_0x394229,_0x4efc0c=![],_0x46fd17=![]){const _0x1ab63b=a0_0xfbe6b3;_0x1124a5[_0x1ab63b(0x18e)][_0x1ab63b(0x2e0)]((_0x4efc0c?_0x1ab63b(0x13d):'')+_0x1ab63b(0x128)+_0x394229+'\x22');const _0x52da5d=_0x1124a5['config'];let _0x4eae72=0x0;if(_0x52da5d[_0x1ab63b(0x164)]){let _0x4714f1={};(_0x394229[_0x1ab63b(0x12c)](_0x1ab63b(0x25f))||_0x46fd17)&&(_0x4714f1={'reply_markup':{'inline_keyboard':[[{'text':_0x1ab63b(0x17c),'callback_data':'COGNI_CONFIRM_OK'}],[{'text':_0x1ab63b(0x2d9),'callback_data':'COGNI_REQUEST_CALL'}]]}}),await _0x1124a5[_0x1ab63b(0x24e)](_0x52da5d[_0x1ab63b(0x210)],'send',{'text':_0x394229,'user':_0x52da5d[_0x1ab63b(0x1b2)],..._0x4714f1}),_0x4eae72++;}if(_0x52da5d['notifyPushoverEnabled']){let _0x400abc={'message':_0x394229,'title':_0x46fd17?_0x1ab63b(0x18a):'Cogni-Living','priority':_0x46fd17?0x2:0x1,'device':_0x52da5d['notifyPushoverRecipient']};_0x46fd17&&(_0x400abc[_0x1ab63b(0x1cc)]=0x1e,_0x400abc['expire']=0xe10,_0x400abc[_0x1ab63b(0x179)]=_0x1ab63b(0x184)),await _0x1124a5['sendToAsync'](_0x52da5d[_0x1ab63b(0x312)],_0x1ab63b(0x28f),_0x400abc),_0x4eae72++;}return _0x52da5d[_0x1ab63b(0x153)]&&(await _0x1124a5[_0x1ab63b(0x24e)](_0x52da5d[_0x1ab63b(0x1fb)],_0x1ab63b(0x28f),{'text':_0x394229,'to':_0x52da5d[_0x1ab63b(0x1b8)]}),_0x4eae72++),_0x4eae72;}async function setupTelegramListener(_0x44557f){const _0x50d4d5=a0_0xfbe6b3,_0x13d440=_0x44557f[_0x50d4d5(0x232)][_0x50d4d5(0x210)];_0x44557f[_0x50d4d5(0x232)][_0x50d4d5(0x164)]&&_0x13d440&&(_0x44557f[_0x50d4d5(0x18e)][_0x50d4d5(0x2e0)](_0x50d4d5(0x2b9)+_0x13d440+_0x50d4d5(0x173)),await _0x44557f[_0x50d4d5(0x32c)](_0x13d440+_0x50d4d5(0x1f7)));}async function handleTelegramResponse(_0x3ef79d,_0x46a9bc){const _0x17c8d0=a0_0xfbe6b3;let _0x48896c=_0x46a9bc;_0x46a9bc[_0x17c8d0(0x13c)]('[')&&(_0x48896c=_0x46a9bc[_0x17c8d0(0x1a7)](_0x46a9bc[_0x17c8d0(0x18c)](']')+0x1));if(_0x48896c==='COGNI_CONFIRM_OK')_0x3ef79d[_0x17c8d0(0x18e)][_0x17c8d0(0x2e0)]('âœ…\x20User\x20confirmed\x20ALARM\x20via\x20Telegram.\x20Resetting\x20system.'),await _0x3ef79d[_0x17c8d0(0x15d)]('analysis.isAlert',{'val':![],'ack':!![]}),await _0x3ef79d['setStateAsync'](_0x17c8d0(0x20f),{'val':_0x17c8d0(0x1d6),'ack':!![]}),_0x3ef79d['lastAlertState']=![],sendNotification(_0x3ef79d,_0x17c8d0(0x14a),![]);else _0x48896c===_0x17c8d0(0x16e)&&(_0x3ef79d[_0x17c8d0(0x18e)][_0x17c8d0(0x2d7)](_0x17c8d0(0x281)),sendNotification(_0x3ef79d,_0x17c8d0(0x339),![],!![]));}function a0_0x57ed(){const _0xc7875d=['\x0a\x0a\x20\x20\x20\x20AUFGABE:\x0a\x20\x20\x20\x201.\x20Analysiere\x20auf\x20Gesundheitsrisiken\x20(Sturz,\x20InaktivitÃ¤t).\x0a\x20\x20\x20\x202.\x20Analysiere\x20auf\x20Komfort/Automatisierung\x20(\x22Butler\x22).\x20Erkennst\x20du\x20ein\x20Muster?\x20(z.B.\x20\x22Wenn\x20Bewegung\x20Flur,\x20dann\x20Licht\x20an\x22).\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20FORMAT\x20(JSON\x20Only!):\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22isAlert\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22alertReason\x22:\x20\x22string\x20(kurz)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22isEmergency\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x22summary\x22:\x20\x22string\x20(Was\x20passiert\x20gerade?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x22automationProposal\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22detected\x22:\x20boolean,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22string\x20(Was\x20soll\x20automatisiert\x20werden?)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetId\x22:\x20\x22string\x20(ioBroker\x20ID,\x20z.B.\x200_userdata.0.light)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22targetValue\x22:\x20\x22any\x20(Wert,\x20z.B.\x20true\x20oder\x2050)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','uuid','analysis.automation','\x20(Type\x20\x27','Details:\x20','lastIndexOf','value.health','Starting\x20Autopilot\x20(','Skipped\x20(No\x20AI\x20or\x20Data)','Gast','description','blind','systemConfig','prÃ¤senz','Drift\x20Status','analysis.health.notes','Verbindung\x20erfolgreich!\x20Antwort:\x20','Description','ltmDriftCheckIntervalHours','lampe','Started\x20at\x20','Adapter','analysis.isEmergency','\x0aSTB:\x20','.\x0a\x20\x20\x20\x20KONTEXT:\x20','Drift\x20Analysis','dailyDigests','Error\x20in\x20onMessage\x20command\x20','admin.','stdin','system.presenceWho','summary','ANALYZE_TREND','scheduleJob','sensorLastValues','window','useWeather','extendObjectAsync','fenster','dependencyInstallInProgress','0\x203\x20*\x20*\x20*','ðŸ“¡\x20Hooking\x20into\x20','analysis.automation.patternDetected','python3\x20-m\x20pip\x20install\x20-r\x20\x22','analysisTimer','licenseKey','getStateAsync','Guardian:\x20Sending\x20','[RESULT]','.\x20OUTPUT:\x20Nur\x20Text.','testNotification','N/A\x20(Learning)','guest','[PYTHON]\x20Failed\x20to\x20start\x20(is\x20python3\x20installed?):\x20','system','TEST-PRO-KEY','[LICENSE\x20CHECK]\x20Key\x20present:\x20','@iobroker/adapter-core','Feedback\x20saved:\x20','(((.+)+)+)+$','write','\x27\x20not\x20in\x20allowed\x20list)','instance','LTM.triggerDailyDigest','9564444hEMVMB','heizung','.\x0a\x20\x20\x20\x20WETTER:\x20','ðŸ\x20Starting\x20Python\x20Sidecar:\x20','rollladen','_calName','map','warn','currentposition','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','setObjectNotExistsAsync','config_pending','selectedFunctionIds','getForeignObjectsAsync','No\x20module\x20named','Gemini\x20Init\x20Error:\x20','info','temp','Health\x20&\x20Sleep\x20Analysis','communicate.request','7hyJcWc','KALENDER:\x20Keine\x20Kalender\x20ausgewÃ¤hlt\x20(Bitte\x20in\x20Settings\x20konfigurieren)','online','inactivityThresholdHours','analysis.automation.description','parse','application/json','dimmer','simulateButler','ðŸ\x20Python\x20Pong\x20received!\x20Latency\x20check\x20passed.','.\x20Welcome\x20home.','.forecast.current.temp','off','forEach','doors','Morning\x20Briefing\x20sent.','Trend\x20Value\x20(%)','Briefing\x20Sched\x20Error:\x20',')\x20-\x20FUNCTIONS\x20FIRST\x20ARCHITECTURE','weather','analysis.deviationFromBaseline','LTM.driftAnalysis','targetValue','...','ðŸ¤–\x20BUTLER\x20PROPOSAL:\x20','button','trim','\x20(Value:\x20','\x22\x20--break-system-packages','testContext','âŒ\x20AUTO-FIX\x20FAILED.\x20Please\x20run\x20manually:\x20sudo\x20','channel','Scheduling\x20Morning\x20Briefing\x20for\x20','Comfort\x20Summary','âŒ\x20FREE\x20MODE','scanDevices','Restoring\x20sensor\x20cache\x20from\x20history\x20(','boolean','WiFi\x20Presence\x20detected\x20->\x20Aborting\x20Exit\x20Timer.\x20User\x20is\x20present.','message','getEnums','geminiApiKey','.\x0a\x20\x20\x20\x20SYSTEM_MODE:\x20','Trigger\x20Action\x20Now','thermostat','indicator.alarm.fire','notifyPushoverInstance','toLowerCase','city','eventHistory','analysis.triggerBriefing','longitude','apiKey','some','lock','Last\x20Result','version','getForeignObjectAsync','\x20events)...','logDuplicates','outdoorSensorId','automation.triggerAction','analysis.health.sleepScore','setState','TREND_RESULT','catch','weatherunderground.0','genAI','location','useCalendar','sensor','temperature','subscribeForeignStatesAsync','ltmStbWindowDays','stick_unreach','python3','humidity','firmware','stdout','baselineDrift','length','Scanning\x20for\x20devices\x20(V8:\x20Whitelist\x20Priority)...','KALENDER:\x20Keine\x20relevanten\x20Termine','enum.rooms.*','Missing\x20data','ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.','flot.','Sending\x20notification:\x20\x22','ready','aiPersona','custom','includes','.\x0a\x20\x20\x20\x20NOTFALL-KONTEXT:\x20','debug','error','Target\x20ID','currentSystemMode','LTM','Daily\x20Digests','getFullYear','LTM.driftAnalysis.lastCheck','unload','namespace','17130870PEBdAb','stringify','âš ï¸\x20Python\x20missing\x20dependencies.\x20Triggering\x20Auto-Install...','[PYTHON]\x20','startsWith','[TEST]\x20','Logbook','LTM.rawEventLog','0\x204\x20*\x20*\x20*','submitFeedback','valve','occupancy','analysis.automation.autoApply','triggerBriefing','toString','Activity\x20Summary','\x20events','isProVersion','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','sendTo','cover','cogni-living\x20adapter\x20starting\x20(v','\x20(Value\x20is\x20falsy:\x20','Lernphase\x20(','.\x20ZUSATZ:\x20',').\x20Saving\x20to\x20Training\x20Data.','stateChange','notifyEmailEnabled','âœ…\x20AUTO-FIX\x20SUCCESS.\x20Dependencies\x20installed.\x20Restarting\x20Service...','Deaktiviert\x20(Pro-Feature)','analysis.trigger','LTM.trainingData.thermodynamics','openweathermap','time','values','analysis.automation.suggestedAction','ðŸ¤–\x20BUTLER\x20AUTO-APPLY:\x20Executing\x20','setStateAsync','role','):\x20','unreach','daswetter','targetId','inactivityMonitoringEnabled','notifyTelegramEnabled','analysisInterval','Drift\x20Details','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','unshift','rawEventLog','analysis.health.trendValue','geminiModel','activityLevel','switch','COGNI_REQUEST_CALL','command','Gemini\x20AI\x20initialized.','Kalender:\x20Deaktiviert','object','\x20for\x20interactive\x20buttons...','Kein\x20API\x20Key\x20eingegeben.','Raw\x20Log','Activity-Level','motion','push','sound','exitGraceTimer','/100,\x20AktivitÃ¤t\x20seit\x2004:00:\x20','âœ…\x20Alles\x20OK\x20(Reset)','systemUUID','ack','\x20=\x20','indicator','state','from','isExit','siren','analysisHistory','isGracePeriodActive','Drift\x20Sched\x20Error:\x20','details','feedbackHistory','ðŸš¨\x20EMERGENCY','enum','indexOf','direction','log','common','briefingJob','path','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','Restlessness\x20Level','link_quality','08:00','analysis.health.restlessness','devices','split','1978884RVqxCl','generic','text.alarm','Processing\x20Status','replace','WETTER:\x20','pythonProcess','vacation','subscribeStates','enum.functions.*','Correlation\x20between\x20Inside\x20Temp,\x20Outside\x20Temp\x20and\x20Time','maintenance','setHours','value','substring','.data.table','@google/generative-ai','LTM.trainingData.sequences','health','8bGcmGR','356504ZPGUbS','toISOString','KI-Modell\x20nicht\x20initialisiert','briefingTime','klima','notifyTelegramRecipient','getTime','simple-api.','now','LTM.dailyDigests','native','notifyEmailRecipient','vis.','shutter','setForeignStateAsync','.NextHours.Location_1.Day_1.current.symbol_desc','\x20|\x20','exitTimer','_score','\x20*\x20*\x20*','events.history','connection','analysis.history_debug_00','Sleep\x20Score\x20(0-100)','type','Bibliotheken\x20nicht\x20gefunden','getHours','toFixed',').\x20Starting\x20Timer.','models/gemini-flash-latest','stderr','retry','analysis.health','Action','latitude','\x20presence\x20devices...','bind','\x20(Length:\x20','analysis.comfortSuggestion','search','apply','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','.forecast.current.temperature','cogni-living','string','ltmLtbWindowDays','filter','lowbat','.Summary.Current','splice','testApiKey','bewegung','date','Fehler:\x20','detected','âš ï¸\x20ALARM:\x20','shift','power','slice','getDate','Could\x20not\x20kill\x20Python\x20process:\x20','Generating\x20Morning\x20Briefing...','\x20min).','1233280EJUSnJ','node-schedule','callback','.Current.Temperature','LTM.driftAnalysis.driftDetails','name','door','KALENDER:\x20Keine\x20Daten','KALENDER:\x20','Comfort\x20Suggestion','.communicate.request','event','dutycycle','close','notifyEmailInstance','val','licht','cancel','round','material.','minDaysForBaseline','Thermodynamic\x20Data\x20Points','KALENDER\x20ERROR:\x20','pop','analysis.automation.targetValue','NORMAL','Kein\x20API\x20Key!','driftAnalysisTimer','getOverviewData','loc','5826FlPwnj','ðŸŒ…\x20Daily\x20Briefing:\x0a','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','analysis.comfortSummary','analysis.alertReason','notifyTelegramInstance','writable','driftDetails','Error\x20reading\x20outdoor\x20sensor\x20','status','onReady','lastAlertState','Error\x20reading\x20calendar\x20table:\x20','timestamp','[RECORDER\x20DEBUG]\x20Ignored\x20Event\x20','join','analysis.health.trendDiagnosis','ðŸ\x20Stopping\x20Python\x20Sidecar...','Subscribing\x20to\x20','ðŸ\x20Guardian\x20Diagnosis\x20(','events.history_debug_00','Last\x20Check','.NextHours.Location_1.Day_1.current.temp_value','data','fault','N/A','Keine\x20Details.','Trend\x20Diagnosis\x20(Python)','echarts.','Automation\x20Proposals','[PYTHON\x20ERR]\x20','sort','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','isPresent','position','analysis.activitySummary','ltmJob','analysis.automation.targetId','set_temperature','config','298LZJpNK','Fokus\x20auf\x20Familienroutinen.','indicator.alarm','update','light','icons-mfd.','PRIORITÃ„T:\x20Sicherheit.','dismissAutomation','main','analysis.lastResult','VACATION','weatherInstance','text','presenceDevices','analysis.isAlert','No\x20instance','getGenerativeModel','python_service','Reset\x20Sched\x20Error:\x20','Array\x20of\x20completed\x20movement\x20paths\x20for\x20ML\x20training','system.isPresent','Exit\x20Sensor\x20triggered\x20(','isAlert','getForeignStateAsync','setpoint','Pattern\x20Detected','system.meta.uuid','sendToAsync','.\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20INPUT\x20DATEN\x20(Letzte\x20Events):\x0a\x20\x20\x20\x20','Event\x20History','endsWith','Event\x20received:\x20','Guardian:\x20Not\x20enough\x20history\x20data\x20for\x20trend\x20analysis\x20yet.','alertReason','Target\x20Value','analysis.analysisHistory','Last\x20raw\x20event','onUnload','GUEST','rssi','javascript.','ical.0','HARD\x20WATCHDOG:\x20No\x20sensor\x20activity\x20detected\x20for\x20','ðŸ› ï¸\x20AUTO-FIX:\x20Installing\x20Python\x20dependencies\x20from\x20','Alarm','.\x20DATEN:\x20Schlaf\x20','normal','brightness','525339gNUaXz','kill','Recorded\x20Motion\x20Sequences','IGNORING\x20DUPLICATE\x20(Cached):\x20','Unknown','response','automationProposal','PRO-','lastCheck','Alert\x20Reason','LTM.baselineStatus','AI\x20Alert\x20Status','daswetter.0','getLtmData','onMessage','[RECORDER]\x20Discarding\x20short\x20sequence\x20(Length:\x20','Training\x20Data\x20Sets','level','telegram','Feedback\x20Log','fill','PARTY','analysis.automation.triggerAction','accuweather','Keine\x20Analyse.','scriptEnabled','working','presence','number','sleepScore','ðŸ“ž\x20User\x20requested\x20CALL\x20via\x20Telegram!','tÃ¼r','modeResetJob','events.lastEvent','generateContent','json','Urlaub','Say\x20Hello','ROLLE:\x20FÃ¼rsorglicher\x20Assistent.\x20AUFGABE:\x20Schreibe\x20eine\x20kurze,\x20beruhigende\x20\x22Guten\x20Morgen\x22-Nachricht.\x20PERSONA:\x20','briefingEnabled','AI\x20Emergency\x20Status','[LOG]','âœ…\x20PRO\x20ACTIVATED','Briefing\x20Error:\x20','send'];a0_0x57ed=function(){return _0xc7875d;};return a0_0x57ed();}async function runAutopilot(_0x410d29){const _0x4580c7=a0_0xfbe6b3,_0x37c6f6=_0x410d29['config'][_0x4580c7(0x2e7)],_0x26d5b1=_0x410d29[_0x4580c7(0x315)][_0x4580c7(0x334)]>0x0?_0x410d29[_0x4580c7(0x315)][0x0][_0x4580c7(0x218)]:Date[_0x4580c7(0x1b5)](),_0x2e9eae=(Date[_0x4580c7(0x1b5)]()-_0x26d5b1)/(0x3e8*0x3c*0x3c);let _0x744a3d='';_0x410d29[_0x4580c7(0x232)][_0x4580c7(0x163)]&&_0x410d29[_0x4580c7(0x131)]===SYSTEM_MODES[_0x4580c7(0x206)]&&_0x410d29[_0x4580c7(0x22c)]&&(_0x2e9eae>_0x37c6f6&&(_0x744a3d=_0x4580c7(0x25d)+_0x2e9eae[_0x4580c7(0x1c8)](0x1)+'\x20hours.\x20Potential\x20incapacitation.')),runGeminiAnalysis(_0x410d29,_0x744a3d)[_0x4580c7(0x325)](_0x2cf532=>_0x410d29[_0x4580c7(0x18e)][_0x4580c7(0x12f)](_0x2cf532));}function a0_0x9c2a(_0x3d7e8a,_0x5e689a){const _0x188d3a=a0_0x57ed();return a0_0x9c2a=function(_0x400e78,_0x49aad5){_0x400e78=_0x400e78-0x128;let _0x57edb6=_0x188d3a[_0x400e78];return _0x57edb6;},a0_0x9c2a(_0x3d7e8a,_0x5e689a);}async function createDailyDigest(_0x1f0722){const _0xb4fc57=a0_0xfbe6b3;if(!_0x1f0722[_0xb4fc57(0x149)])return;await _0x1f0722[_0xb4fc57(0x15d)](LTM_DP_STATUS,{'val':_0xb4fc57(0x2a4)+new Date()['toLocaleString'](),'ack':!![]});if(!_0x1f0722['geminiModel']||_0x1f0722[_0xb4fc57(0x169)][_0xb4fc57(0x334)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x1f0722[_0xb4fc57(0x15d)](LTM_DP_STATUS,{'val':_0xb4fc57(0x298),'ack':!![]});return;}const _0x212823=JSON[_0xb4fc57(0x2e9)](JSON[_0xb4fc57(0x139)](_0x1f0722[_0xb4fc57(0x169)])),_0x48e551=_0x212823[_0xb4fc57(0x334)],_0x587e9a='ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a'+JSON[_0xb4fc57(0x139)](_0x212823);try{const _0x1014e0=await _0x1f0722[_0xb4fc57(0x16b)][_0xb4fc57(0x285)](_0x587e9a),_0x51b50e=JSON[_0xb4fc57(0x2e9)](_0x1014e0[_0xb4fc57(0x268)][_0xb4fc57(0x23f)]()[_0xb4fc57(0x19d)](/```json|```/g,'')[_0xb4fc57(0x2fe)]());_0x51b50e[_0xb4fc57(0x2af)]&&(_0x1f0722[_0xb4fc57(0x2aa)][_0xb4fc57(0x178)]({'timestamp':new Date()[_0xb4fc57(0x1ae)](),'eventCount':_0x48e551,'summary':_0x51b50e[_0xb4fc57(0x2af)],'activityLevel':_0x51b50e[_0xb4fc57(0x16c)],'systemMode':_0x1f0722[_0xb4fc57(0x131)]}),await saveDailyDigests(_0x1f0722),_0x1f0722['rawEventLog']=[],await saveRawEventLog(_0x1f0722),await _0x1f0722[_0xb4fc57(0x15d)](LTM_DP_STATUS,{'val':'Success:\x20Compressed\x20'+_0x48e551+_0xb4fc57(0x148),'ack':!![]}),runPythonHealthCheck(_0x1f0722));}catch(_0x2388ab){await _0x1f0722[_0xb4fc57(0x15d)](LTM_DP_STATUS,{'val':'Error:\x20'+_0x2388ab[_0xb4fc57(0x30b)],'ack':!![]});}}async function sendMorningBriefing(_0x192521){const _0xb4ff70=a0_0xfbe6b3;if(!_0x192521['geminiModel'])return;_0x192521['log']['info'](_0xb4ff70(0x1eb));const _0xac4730=_0x192521['dailyDigests'][_0xb4ff70(0x334)]>0x0?_0x192521['dailyDigests'][_0x192521['dailyDigests']['length']-0x1]:null,_0x5b2dfc=_0xac4730&&_0xac4730['health']?_0xac4730[_0xb4ff70(0x1ab)][_0xb4ff70(0x280)]:_0xb4ff70(0x224),_0xd4f979=new Date();_0xd4f979[_0xb4ff70(0x1a5)](0x4,0x0,0x0,0x0);const _0x36a0b6=_0x192521[_0xb4ff70(0x315)]['filter'](_0x3a4057=>new Date(_0x3a4057['timestamp'])>_0xd4f979),_0x10d663=PERSONA_MAPPING[_0x192521['config'][_0xb4ff70(0x12a)]||'generic'],_0x353314=_0x192521[_0xb4ff70(0x232)]['livingContext']||'',_0x371041=await getWeatherContext(_0x192521),_0x5cb98b=await getCalendarContext(_0x192521),_0x11afdd=_0xb4ff70(0x289)+_0x10d663+'.\x20KONTEXT:\x20'+_0x353314+_0xb4ff70(0x150)+_0x371041+'\x20'+_0x5cb98b+_0xb4ff70(0x260)+_0x5b2dfc+_0xb4ff70(0x17b)+JSON[_0xb4ff70(0x139)](_0x36a0b6['slice'](0x0,0xa))+_0xb4ff70(0x2c1);try{const _0x80d7e2=await _0x192521['geminiModel'][_0xb4ff70(0x285)](_0x11afdd),_0xe993fc=_0xb4ff70(0x20c)+_0x80d7e2['response']['text']()['trim']();sendNotification(_0x192521,_0xe993fc),_0x192521['log'][_0xb4ff70(0x2e0)](_0xb4ff70(0x2f3));}catch(_0x4bead){_0x192521[_0xb4ff70(0x18e)]['error'](_0xb4ff70(0x28e)+_0x4bead['message']);}}async function scanForDevices(_0x44b450,_0x1e3793){const _0x12b464=a0_0xfbe6b3;_0x44b450[_0x12b464(0x18e)][_0x12b464(0x2e0)](_0x12b464(0x335));const _0x52537f=[],_0x5f5385=await _0x44b450['getForeignObjectsAsync']('*'),_0xe8d0=await _0x44b450[_0x12b464(0x2dd)](_0x12b464(0x1a2),_0x12b464(0x18b)),_0x24fd64=await _0x44b450[_0x12b464(0x2dd)](_0x12b464(0x337),_0x12b464(0x18b)),_0x2937e1={};if(_0xe8d0)for(const _0x37d490 in _0xe8d0){const _0x5e89ca=_0xe8d0[_0x37d490][_0x12b464(0x18f)]['members']||[];_0x5e89ca[_0x12b464(0x2f1)](_0x3d9dd5=>{if(!_0x2937e1[_0x3d9dd5])_0x2937e1[_0x3d9dd5]=[];_0x2937e1[_0x3d9dd5]['push'](_0x37d490);});}const _0x33a215={};if(_0x24fd64)for(const _0x2b92a6 in _0x24fd64){const _0x297dc3=_0x24fd64[_0x2b92a6][_0x12b464(0x18f)]['members']||[],_0x39ad6b=typeof _0x24fd64[_0x2b92a6][_0x12b464(0x18f)][_0x12b464(0x1f2)]===_0x12b464(0x172)?_0x24fd64[_0x2b92a6][_0x12b464(0x18f)][_0x12b464(0x1f2)]['de']:_0x24fd64[_0x2b92a6][_0x12b464(0x18f)]['name'];_0x297dc3[_0x12b464(0x2f1)](_0x487548=>_0x33a215[_0x487548]=_0x39ad6b);}const _0x3bc51a=_0x1e3793[_0x12b464(0x2dc)]||[],_0x3b1c99=_0x1e3793[_0x12b464(0x177)]!==![],_0x56e4be=_0x1e3793[_0x12b464(0x2f2)]!==![],_0x1d63de=_0x1e3793['lights']!==![],_0x4334b3=_0x1e3793[_0x12b464(0x32b)]===!![],_0x2d1bc7=_0x1e3793[_0x12b464(0x2f7)]===!![];for(const _0x5cfde6 in _0x5f5385){const _0x8240f6=_0x5f5385[_0x5cfde6];if(_0x8240f6[_0x12b464(0x1c5)]!==_0x12b464(0x181)||!_0x8240f6[_0x12b464(0x18f)])continue;if(ADAPTER_BLACKLIST[_0x12b464(0x319)](_0x45834e=>_0x5cfde6[_0x12b464(0x13c)](_0x45834e))&&!_0x2d1bc7)continue;const _0x4d3eac=(_0x8240f6[_0x12b464(0x18f)][_0x12b464(0x15e)]||'')[_0x12b464(0x313)]();let _0x52b1d1=(typeof _0x8240f6['common'][_0x12b464(0x1f2)]===_0x12b464(0x172)?_0x8240f6[_0x12b464(0x18f)]['name']['de']:_0x8240f6[_0x12b464(0x18f)][_0x12b464(0x1f2)])||_0x5cfde6;const _0x43249b=_0x52b1d1[_0x12b464(0x313)]();let _0x58374d=![],_0x4f47e0=![];if(_0x3bc51a[_0x12b464(0x334)]>0x0){const _0x12cad8=_0x2937e1[_0x5cfde6]||[],_0x2e7846=_0x5cfde6[_0x12b464(0x198)]('.')[_0x12b464(0x1e8)](0x0,-0x1)['join']('.'),_0x153c7e=_0x2937e1[_0x2e7846]||[];(_0x12cad8[_0x12b464(0x319)](_0x55f24f=>_0x3bc51a[_0x12b464(0x12c)](_0x55f24f))||_0x153c7e[_0x12b464(0x319)](_0x50a3c9=>_0x3bc51a[_0x12b464(0x12c)](_0x50a3c9)))&&(_0x58374d=!![],_0x4f47e0=!![]);}if(!_0x58374d&&!_0x2d1bc7){if(HARD_IGNORE_TERMS[_0x12b464(0x319)](_0x21b2f4=>_0x5cfde6[_0x12b464(0x12c)](_0x21b2f4)||_0x43249b['includes'](_0x21b2f4[_0x12b464(0x313)]())))continue;}if(BAD_NAMES[_0x12b464(0x319)](_0x12c6f8=>_0x43249b===_0x12c6f8||_0x43249b['endsWith']('.'+_0x12c6f8))){const _0x18852f=_0x5cfde6[_0x12b464(0x198)]('.');if(_0x18852f['length']>0x2){const _0x20e536=_0x18852f[_0x12b464(0x1e8)](0x0,-0x1)[_0x12b464(0x21a)]('.'),_0x2878a9=_0x5f5385[_0x20e536];if(_0x2878a9&&_0x2878a9[_0x12b464(0x18f)]&&_0x2878a9[_0x12b464(0x18f)][_0x12b464(0x1f2)]){const _0x43cad3=typeof _0x2878a9[_0x12b464(0x18f)][_0x12b464(0x1f2)]==='object'?_0x2878a9[_0x12b464(0x18f)][_0x12b464(0x1f2)]['de']:_0x2878a9[_0x12b464(0x18f)]['name'];_0x43cad3&&!_0x52b1d1['includes'](_0x43cad3)&&(_0x52b1d1=_0x43cad3+'\x20'+_0x52b1d1);}}}let _0x31b9e1='';if(_0x3b1c99&&(_0x4d3eac['includes'](_0x12b464(0x177))||_0x4d3eac[_0x12b464(0x12c)](_0x12b464(0x143))||_0x43249b[_0x12b464(0x12c)]('bewegung')||_0x43249b[_0x12b464(0x12c)]('prÃ¤senz')))_0x31b9e1='motion';else{if(!_0x31b9e1&&_0x56e4be&&(_0x4d3eac[_0x12b464(0x12c)](_0x12b464(0x1f3))||_0x4d3eac[_0x12b464(0x12c)](_0x12b464(0x2b3))||_0x4d3eac[_0x12b464(0x12c)](_0x12b464(0x31a))||_0x4d3eac[_0x12b464(0x12c)](_0x12b464(0x29b))||_0x4d3eac[_0x12b464(0x12c)](_0x12b464(0x1ba))||_0x43249b[_0x12b464(0x12c)](_0x12b464(0x2b6))||_0x43249b[_0x12b464(0x12c)](_0x12b464(0x282))||_0x43249b[_0x12b464(0x12c)](_0x12b464(0x2d4))))_0x31b9e1=_0x12b464(0x1f3);else{if(!_0x31b9e1&&_0x1d63de&&(_0x4d3eac[_0x12b464(0x12c)](_0x12b464(0x237))||_0x4d3eac[_0x12b464(0x12c)](_0x12b464(0x16d))||_0x4d3eac[_0x12b464(0x12c)]('dimmer')||_0x43249b[_0x12b464(0x12c)](_0x12b464(0x1fd))||_0x43249b['includes'](_0x12b464(0x2a3))||_0x43249b[_0x12b464(0x12c)]('schalter'))){if(_0x8240f6[_0x12b464(0x18f)][_0x12b464(0x2cc)]||_0x4d3eac[_0x12b464(0x12c)](_0x12b464(0x32a)))_0x31b9e1=_0x12b464(0x237);}else{if(!_0x31b9e1&&_0x4334b3&&(_0x4d3eac[_0x12b464(0x12c)](_0x12b464(0x32b))||_0x4d3eac['includes'](_0x12b464(0x330))||_0x4d3eac[_0x12b464(0x12c)](_0x12b464(0x310))||_0x43249b[_0x12b464(0x12c)](_0x12b464(0x2e1))||_0x43249b[_0x12b464(0x12c)](_0x12b464(0x1b1))||_0x43249b[_0x12b464(0x12c)](_0x12b464(0x2d1))))_0x31b9e1='temperature';else{if(!_0x31b9e1&&_0x4f47e0)_0x31b9e1=_0x12b464(0x12b);}}}}if(_0x31b9e1){let _0x3f5ee2=_0x33a215[_0x5cfde6]||'';if(!_0x3f5ee2){let _0x12b234=_0x5cfde6;for(let _0x2bfc51=0x0;_0x2bfc51<0x3;_0x2bfc51++){const _0x11f891=_0x12b234[_0x12b464(0x295)]('.');if(_0x11f891===-0x1)break;_0x12b234=_0x12b234['substring'](0x0,_0x11f891);if(_0x33a215[_0x12b234]){_0x3f5ee2=_0x33a215[_0x12b234];break;}}}_0x52537f[_0x12b464(0x178)]({'id':_0x5cfde6,'name':_0x52b1d1,'location':_0x3f5ee2,'type':_0x31b9e1,'logDuplicates':_0x31b9e1===_0x12b464(0x177),'isExit':![],'_score':_0x3f5ee2?0x50:_0x31b9e1===_0x12b464(0x12b)?0x5a:0x28});}}return _0x52537f[_0x12b464(0x22a)]((_0x482156,_0x5a01e8)=>_0x5a01e8[_0x12b464(0x1bf)]-_0x482156[_0x12b464(0x1bf)]),_0x52537f;}async function executeAutomationAction(_0x1a3912){const _0x1c92ea=a0_0xfbe6b3;try{const _0x4e3761=await _0x1a3912[_0x1c92ea(0x2be)](_0x1c92ea(0x230)),_0x2701c7=await _0x1a3912[_0x1c92ea(0x2be)](_0x1c92ea(0x205));if(_0x4e3761&&_0x4e3761[_0x1c92ea(0x1fc)]&&_0x2701c7){const _0x4207cb=_0x4e3761[_0x1c92ea(0x1fc)];let _0x242df6=_0x2701c7['val'];try{_0x242df6=JSON[_0x1c92ea(0x2e9)](_0x242df6);}catch(_0x113fae){}_0x1a3912[_0x1c92ea(0x18e)][_0x1c92ea(0x2e0)](_0x1c92ea(0x167)+_0x4207cb+_0x1c92ea(0x17f)+_0x242df6),await _0x1a3912[_0x1c92ea(0x1bb)](_0x4207cb,_0x242df6);}else _0x1a3912[_0x1c92ea(0x18e)]['warn'](_0x1c92ea(0x20d));}catch(_0x140184){_0x1a3912[_0x1c92ea(0x18e)][_0x1c92ea(0x12f)]('BUTLER\x20Execution\x20Error:\x20'+_0x140184[_0x1c92ea(0x30b)]);}}function tryParse(_0x26b2fd){const _0x563a34=a0_0xfbe6b3;try{return JSON[_0x563a34(0x2e9)](_0x26b2fd);}catch(_0x324771){return null;}}async function recordSequence(_0x2b602a,_0x3c17bc){const _0x8e61f5=a0_0xfbe6b3,_0x4b269a=(_0x3c17bc[_0x8e61f5(0x1c5)]||'')[_0x8e61f5(0x313)](),_0x10f658=['motion',_0x8e61f5(0x1e1),_0x8e61f5(0x29d),_0x8e61f5(0x27e),'occupancy',_0x8e61f5(0x1f3),'tÃ¼r',_0x8e61f5(0x2b3),_0x8e61f5(0x2b6),'contact','kontakt',_0x8e61f5(0x237),_0x8e61f5(0x1fd),_0x8e61f5(0x16d),'schalter',_0x8e61f5(0x2eb),_0x8e61f5(0x2a3)];if(!_0x10f658[_0x8e61f5(0x319)](_0xc132cf=>_0x4b269a['includes'](_0xc132cf))){_0x2b602a[_0x8e61f5(0x18e)][_0x8e61f5(0x12e)](_0x8e61f5(0x219)+_0x3c17bc['id']+_0x8e61f5(0x293)+_0x3c17bc[_0x8e61f5(0x1c5)]+_0x8e61f5(0x2cd));return;}if(!_0x3c17bc[_0x8e61f5(0x1a6)]){_0x2b602a['log']['debug'](_0x8e61f5(0x219)+_0x3c17bc['id']+_0x8e61f5(0x14e)+_0x3c17bc[_0x8e61f5(0x1a6)]+')');return;}_0x2b602a[_0x8e61f5(0x18e)][_0x8e61f5(0x12e)]('[RECORDER\x20DEBUG]\x20Accepting\x20Event\x20'+_0x3c17bc['id']+'\x20('+_0x3c17bc['location']+')');if(sequenceTimer)clearTimeout(sequenceTimer);const _0xd2bb16={'loc':_0x3c17bc[_0x8e61f5(0x328)]||_0x8e61f5(0x267),'id':_0x3c17bc['id'],'ts':Date[_0x8e61f5(0x1b5)]()};activeSequence[_0x8e61f5(0x178)](_0xd2bb16),_0x2b602a['log'][_0x8e61f5(0x12e)]('[RECORDER]\x20Added\x20step\x20to\x20sequence:\x20'+_0xd2bb16[_0x8e61f5(0x20a)]+_0x8e61f5(0x1d2)+activeSequence['length']+')'),sequenceTimer=setTimeout(async()=>{const _0x9c5c4c=_0x8e61f5;activeSequence[_0x9c5c4c(0x334)]>0x1?await saveCompletedSequence(_0x2b602a):(_0x2b602a['log']['debug'](_0x9c5c4c(0x272)+activeSequence['length']+')'),activeSequence=[]);},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x2c3f09){const _0x5c597b=a0_0xfbe6b3;try{_0x2c3f09['log'][_0x5c597b(0x2e0)]('[RECORDER]\x20Sequence\x20finished\x20(Steps:\x20'+activeSequence['length']+_0x5c597b(0x151));const _0x26f5ec=await _0x2c3f09[_0x5c597b(0x2be)]('LTM.trainingData.sequences');let _0xd2d255=[];if(_0x26f5ec&&_0x26f5ec[_0x5c597b(0x1fc)])try{_0xd2d255=JSON[_0x5c597b(0x2e9)](_0x26f5ec[_0x5c597b(0x1fc)]);}catch(_0x5abb24){}const _0x2de3df=activeSequence[0x0]['ts'],_0x60a6e0=activeSequence[_0x5c597b(0x2d6)](_0x5a36c4=>({'loc':_0x5a36c4['loc'],'t_delta':Math[_0x5c597b(0x1ff)]((_0x5a36c4['ts']-_0x2de3df)/0x3e8)})),_0x4867d9={'timestamp':new Date(_0x2de3df)['toISOString'](),'steps':_0x60a6e0,'duration':Math[_0x5c597b(0x1ff)]((activeSequence[activeSequence[_0x5c597b(0x334)]-0x1]['ts']-_0x2de3df)/0x3e8),'daytime':new Date(_0x2de3df)[_0x5c597b(0x1c7)]()};_0xd2d255[_0x5c597b(0x178)](_0x4867d9),_0xd2d255[_0x5c597b(0x334)]>MAX_TRAINING_SET_SIZE&&_0xd2d255[_0x5c597b(0x1e6)](),await _0x2c3f09['setStateAsync'](_0x5c597b(0x1aa),{'val':JSON[_0x5c597b(0x139)](_0xd2d255),'ack':!![]}),activeSequence=[],sequenceTimer=null;}catch(_0x22dcda){_0x2c3f09[_0x5c597b(0x18e)][_0x5c597b(0x12f)]('[RECORDER]\x20Error\x20saving\x20sequence:\x20'+_0x22dcda[_0x5c597b(0x30b)]);}}async function getOutsideTemperatureNumeric(_0xcce344){const _0x17657b=a0_0xfbe6b3;if(_0xcce344[_0x17657b(0x232)][_0x17657b(0x320)])try{const _0x36013e=await _0xcce344['getForeignStateAsync'](_0xcce344[_0x17657b(0x232)]['outdoorSensorId']);if(_0x36013e&&_0x36013e[_0x17657b(0x1fc)]!==undefined&&_0x36013e[_0x17657b(0x1fc)]!==null){const _0x366035=parseFloat(_0x36013e[_0x17657b(0x1fc)]);if(!isNaN(_0x366035))return _0x366035;}}catch(_0x3fae3a){_0xcce344[_0x17657b(0x18e)][_0x17657b(0x2d7)](_0x17657b(0x213)+_0xcce344[_0x17657b(0x232)][_0x17657b(0x320)]+':\x20'+_0x3fae3a['message']);}const _0x3bf1f2=_0xcce344['config'][_0x17657b(0x23e)];if(!_0xcce344[_0x17657b(0x232)]['useWeather']||!_0x3bf1f2)return null;try{let _0x23676c='';if(_0x3bf1f2[_0x17657b(0x12c)](_0x17657b(0x27a)))_0x23676c=_0x3bf1f2+_0x17657b(0x1f0);else{if(_0x3bf1f2['includes'](_0x17657b(0x161)))_0x23676c=_0x3bf1f2+_0x17657b(0x221);else{if(_0x3bf1f2[_0x17657b(0x12c)](_0x17657b(0x158)))_0x23676c=_0x3bf1f2+_0x17657b(0x1d8);else{if(_0x3bf1f2['includes']('weatherunderground'))_0x23676c=_0x3bf1f2+_0x17657b(0x2ef);}}}if(_0x23676c){const _0x104fd1=await _0xcce344['getForeignStateAsync'](_0x23676c);if(_0x104fd1&&_0x104fd1[_0x17657b(0x1fc)]!==undefined&&_0x104fd1[_0x17657b(0x1fc)]!==null)return parseFloat(_0x104fd1[_0x17657b(0x1fc)]);}}catch(_0x121779){}return null;}async function recordThermodynamics(_0x8144cc,_0x5d957b,_0x1e339c,_0x565822){const _0x115fc0=a0_0xfbe6b3,_0x2a298b=await getOutsideTemperatureNumeric(_0x8144cc),_0x180015=await _0x8144cc[_0x115fc0(0x2be)](_0x115fc0(0x157));let _0x212a01=[];if(_0x180015&&_0x180015[_0x115fc0(0x1fc)])try{_0x212a01=JSON[_0x115fc0(0x2e9)](_0x180015['val']);}catch(_0x363e3d){}_0x212a01[_0x115fc0(0x178)]({'ts':Date[_0x115fc0(0x1b5)](),'room':_0x565822||_0x115fc0(0x267),'t_in':_0x1e339c,'t_out':_0x2a298b});if(_0x212a01[_0x115fc0(0x334)]>THERMO_LOG_SIZE)_0x212a01[_0x115fc0(0x1e6)]();await _0x8144cc['setStateAsync'](_0x115fc0(0x157),{'val':JSON[_0x115fc0(0x139)](_0x212a01),'ack':!![]});}async function processSensorEvent(_0x3edf98,_0x24e902,_0x13185e,_0x1badc2){const _0x3b2694=a0_0xfbe6b3;if(!_0x1badc2)return;const _0x1073e5=_0x13185e[_0x3b2694(0x1fc)],_0x2ae3e8=Date[_0x3b2694(0x1b5)]();_0x3edf98['log'][_0x3b2694(0x12e)](_0x3b2694(0x252)+_0x24e902+_0x3b2694(0x17f)+_0x1073e5);const _0x29e457=_0x3edf98[_0x3b2694(0x2b2)][_0x24e902];_0x3edf98[_0x3b2694(0x2b2)][_0x24e902]=_0x1073e5;if(!_0x1badc2[_0x3b2694(0x31f)]&&_0x29e457!=undefined&&_0x29e457==_0x1073e5){_0x3edf98['log']['debug'](_0x3b2694(0x266)+_0x1badc2[_0x3b2694(0x1f2)]+_0x3b2694(0x2ff)+_0x1073e5+')');return;}_0x3edf98[_0x3b2694(0x149)]&&_0x1badc2['type']===_0x3b2694(0x32b)&&recordThermodynamics(_0x3edf98,_0x24e902,_0x1073e5,_0x1badc2[_0x3b2694(0x328)]);const _0x5f5685={'timestamp':_0x2ae3e8,'id':_0x24e902,'name':_0x1badc2[_0x3b2694(0x1f2)],'type':_0x1badc2[_0x3b2694(0x1c5)],'location':_0x1badc2[_0x3b2694(0x328)],'value':_0x1073e5};_0x3edf98[_0x3b2694(0x315)][_0x3b2694(0x168)](_0x5f5685);if(_0x3edf98[_0x3b2694(0x315)][_0x3b2694(0x334)]>HISTORY_MAX_SIZE)_0x3edf98[_0x3b2694(0x315)][_0x3b2694(0x204)]();await _0x3edf98[_0x3b2694(0x15d)](_0x3b2694(0x284),{'val':JSON['stringify'](_0x5f5685),'ack':!![]}),await _0x3edf98[_0x3b2694(0x15d)](_0x3b2694(0x1c1),{'val':JSON[_0x3b2694(0x139)](_0x3edf98['eventHistory']),'ack':!![]});_0x3edf98['isProVersion']&&(_0x3edf98['rawEventLog'][_0x3b2694(0x178)](_0x5f5685),await saveRawEventLog(_0x3edf98),recordSequence(_0x3edf98,_0x5f5685));if(_0x1badc2[_0x3b2694(0x183)]&&_0x1073e5===!![]){if(_0x3edf98['isPresent']&&!_0x3edf98[_0x3b2694(0x186)])_0x3edf98[_0x3b2694(0x18e)][_0x3b2694(0x2e0)](_0x3b2694(0x248)+_0x1badc2[_0x3b2694(0x1f2)]+_0x3b2694(0x1c9)),startExitTimer(_0x3edf98);else!_0x3edf98[_0x3b2694(0x22c)]&&(_0x3edf98['log'][_0x3b2694(0x2e0)]('Entry\x20detected\x20via\x20'+_0x1badc2['name']+_0x3b2694(0x2ee)),await setPresence(_0x3edf98,!![]));}else _0x1badc2['type']===_0x3b2694(0x177)&&_0x1073e5===!![]&&(_0x3edf98[_0x3b2694(0x1be)]&&(_0x3edf98['log'][_0x3b2694(0x2e0)]('Motion\x20detected\x20inside.\x20Aborting\x20Exit\x20Timer.'),abortExitTimer(_0x3edf98)),!_0x3edf98[_0x3b2694(0x22c)]&&_0x3edf98[_0x3b2694(0x131)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x3edf98,!![]));}async function runGeminiAnalysis(_0x54da3f,_0xa36de8=''){const _0x28e8d3=a0_0xfbe6b3;if(!_0x54da3f['geminiModel'])return;if(_0x54da3f['eventHistory'][_0x28e8d3(0x334)]===0x0)return;const _0x1d92e4=_0x54da3f[_0x28e8d3(0x315)][_0x28e8d3(0x1e8)](0x0,0xf),_0x46427a=await getWeatherContext(_0x54da3f),_0x2e57eb=_0x54da3f[_0x28e8d3(0x131)],_0x54ded1=PERSONA_MAPPING[_0x54da3f[_0x28e8d3(0x232)]['aiPersona']||_0x28e8d3(0x19a)],_0x3297c6=_0x54da3f[_0x28e8d3(0x232)]['livingContext']||_0x28e8d3(0x225);let _0x11e11e=![];try{const _0x4c65a1=await _0x54da3f['getStateAsync'](_0x28e8d3(0x144));if(_0x4c65a1&&_0x4c65a1['val'])_0x11e11e=!![];}catch(_0x5b75b2){}const _0x52d32e='\x0a\x20\x20\x20\x20ROLLE:\x20KI-Hausverwalter\x20&\x20Gesundheits-Assistent.\x0a\x20\x20\x20\x20PERSONA:\x20'+_0x54ded1+_0x28e8d3(0x2a8)+_0x3297c6+_0x28e8d3(0x30e)+_0x2e57eb+_0x28e8d3(0x2d2)+_0x46427a+_0x28e8d3(0x12d)+(_0xa36de8||'Keiner')+_0x28e8d3(0x24f)+JSON[_0x28e8d3(0x139)](_0x1d92e4)+_0x28e8d3(0x290);try{const _0xb3d59f=await _0x54da3f[_0x28e8d3(0x16b)][_0x28e8d3(0x285)](_0x52d32e),_0x25f378=_0xb3d59f['response']['text']()[_0x28e8d3(0x19d)](/```json|```/g,'')['trim'](),_0x299a9f=JSON[_0x28e8d3(0x2e9)](_0x25f378);await _0x54da3f[_0x28e8d3(0x15d)](_0x28e8d3(0x23c),{'val':JSON[_0x28e8d3(0x139)](_0x299a9f),'ack':!![]});_0x299a9f[_0x28e8d3(0x2af)]&&await _0x54da3f['setStateAsync'](_0x28e8d3(0x22e),{'val':_0x299a9f[_0x28e8d3(0x2af)],'ack':!![]});const _0x54e6d4={'timestamp':Date[_0x28e8d3(0x1b5)](),'id':Date[_0x28e8d3(0x1b5)]()[_0x28e8d3(0x146)](),'analysis':{'activity':{'summary':_0x299a9f['summary']||_0x28e8d3(0x27b),'isAlert':_0x299a9f[_0x28e8d3(0x249)]||![],'alertReason':_0x299a9f['alertReason']},'comfort':{'automationProposal':_0x299a9f[_0x28e8d3(0x269)]}}};await updateAnalysisHistory(_0x54da3f,_0x54e6d4);const _0x39b550=_0x299a9f['isAlert']||![];_0x39b550!==_0x54da3f[_0x28e8d3(0x216)]&&(await _0x54da3f[_0x28e8d3(0x15d)](_0x28e8d3(0x241),{'val':_0x39b550,'ack':!![]}),_0x54da3f[_0x28e8d3(0x216)]=_0x39b550,_0x39b550&&(await _0x54da3f[_0x28e8d3(0x15d)](_0x28e8d3(0x20f),{'val':_0x299a9f[_0x28e8d3(0x254)],'ack':!![]}),sendNotification(_0x54da3f,_0x28e8d3(0x1e5)+_0x299a9f[_0x28e8d3(0x254)],![],_0x299a9f['isEmergency']))),_0x299a9f[_0x28e8d3(0x269)]&&_0x299a9f[_0x28e8d3(0x269)][_0x28e8d3(0x1e4)]&&_0x299a9f[_0x28e8d3(0x269)][_0x28e8d3(0x162)]&&(_0x54da3f[_0x28e8d3(0x18e)][_0x28e8d3(0x2e0)](_0x28e8d3(0x2fc)+_0x299a9f['automationProposal']['description']),await _0x54da3f[_0x28e8d3(0x15d)](_0x28e8d3(0x2ba),{'val':!![],'ack':!![]}),await _0x54da3f[_0x28e8d3(0x15d)](_0x28e8d3(0x2e8),{'val':_0x299a9f[_0x28e8d3(0x269)][_0x28e8d3(0x29a)],'ack':!![]}),await _0x54da3f[_0x28e8d3(0x15d)](_0x28e8d3(0x230),{'val':_0x299a9f[_0x28e8d3(0x269)][_0x28e8d3(0x162)],'ack':!![]}),await _0x54da3f['setStateAsync'](_0x28e8d3(0x205),{'val':JSON[_0x28e8d3(0x139)](_0x299a9f[_0x28e8d3(0x269)][_0x28e8d3(0x2fa)]),'ack':!![]}),_0x11e11e&&(_0x54da3f[_0x28e8d3(0x18e)][_0x28e8d3(0x2e0)](_0x28e8d3(0x15c)+_0x299a9f[_0x28e8d3(0x269)][_0x28e8d3(0x162)]+_0x28e8d3(0x2fb)),await executeAutomationAction(_0x54da3f)));}catch(_0xa4d65e){_0x54da3f[_0x28e8d3(0x18e)][_0x28e8d3(0x12f)]('Gemini\x20Analysis\x20Error:\x20'+_0xa4d65e[_0x28e8d3(0x30b)]);}}function installPythonDependencies(_0x3a112a){const _0x319dc7=a0_0xfbe6b3;if(_0x3a112a[_0x319dc7(0x2b7)])return;_0x3a112a[_0x319dc7(0x2b7)]=!![];const _0x32138e=path[_0x319dc7(0x21a)](__dirname,'python_service','requirements.txt');_0x3a112a['log'][_0x319dc7(0x2e0)](_0x319dc7(0x25e)+_0x32138e+_0x319dc7(0x2fb)),stopPythonService(_0x3a112a);const _0x5610c8=_0x319dc7(0x2bb)+_0x32138e+_0x319dc7(0x300);exec(_0x5610c8,(_0x53a4cc,_0x475611,_0x4ef047)=>{const _0x1fa1c0=_0x319dc7;_0x3a112a[_0x1fa1c0(0x2b7)]=![],_0x53a4cc?(_0x3a112a[_0x1fa1c0(0x18e)][_0x1fa1c0(0x12f)](_0x1fa1c0(0x302)+_0x5610c8),_0x3a112a[_0x1fa1c0(0x18e)]['error'](_0x1fa1c0(0x294)+(_0x4ef047||_0x53a4cc[_0x1fa1c0(0x30b)]))):(_0x3a112a[_0x1fa1c0(0x18e)][_0x1fa1c0(0x2e0)](_0x1fa1c0(0x154)),startPythonService(_0x3a112a));});}function sendToPython(_0x2cbcac,_0x11d942,_0x5d9721={}){const _0x5be02c=a0_0xfbe6b3;if(!_0x2cbcac['pythonProcess']||!_0x2cbcac[_0x5be02c(0x19f)][_0x5be02c(0x2ad)][_0x5be02c(0x211)])return;const _0x627926=JSON['stringify']({'command':_0x11d942,..._0x5d9721});try{_0x2cbcac[_0x5be02c(0x19f)][_0x5be02c(0x2ad)]['write'](_0x627926+'\x0a');}catch(_0x2e0c2f){_0x2cbcac[_0x5be02c(0x18e)]['error']('Failed\x20to\x20send\x20to\x20Python:\x20'+_0x2e0c2f[_0x5be02c(0x30b)]);}}function runPythonHealthCheck(_0x145e82){const _0x176c34=a0_0xfbe6b3;if(!_0x145e82[_0x176c34(0x2aa)]||_0x145e82[_0x176c34(0x2aa)][_0x176c34(0x334)]<0x2){_0x145e82[_0x176c34(0x18e)][_0x176c34(0x2e0)](_0x176c34(0x253));return;}const _0x42415f=_0x145e82[_0x176c34(0x2aa)]['map'](_0x3ea3a4=>{const _0x4337c6=_0x176c34,_0x28b11b=(_0x3ea3a4['activityLevel']||'')[_0x4337c6(0x313)]();return ACTIVITY_LEVEL_MAP[_0x28b11b]||0x32;});_0x145e82[_0x176c34(0x18e)][_0x176c34(0x2e0)](_0x176c34(0x2bf)+_0x42415f[_0x176c34(0x334)]+'\x20days\x20of\x20activity\x20data\x20to\x20Python...'),sendToPython(_0x145e82,_0x176c34(0x2b0),{'values':_0x42415f,'tag':_0x176c34(0x176)});}function handlePythonResult(_0x39a7a3,_0x1f5840){const _0x48f2a5=a0_0xfbe6b3;if(_0x1f5840[_0x48f2a5(0x1c5)]==='PONG')_0x39a7a3['log'][_0x48f2a5(0x12e)](_0x48f2a5(0x2ed));else{if(_0x1f5840['type']===_0x48f2a5(0x324)){const {tag:_0x3753f7,diagnosis:_0x2a1951,change_percent:_0x1549ef}=_0x1f5840['payload'];_0x39a7a3[_0x48f2a5(0x18e)][_0x48f2a5(0x2e0)](_0x48f2a5(0x21e)+_0x3753f7+_0x48f2a5(0x15f)+_0x2a1951+'\x20('+_0x1549ef+'%)'),_0x39a7a3[_0x48f2a5(0x15d)](_0x48f2a5(0x21b),{'val':_0x2a1951,'ack':!![]}),_0x39a7a3['setStateAsync'](_0x48f2a5(0x16a),{'val':_0x1549ef,'ack':!![]});}}}function startPythonService(_0x5e43ce){const _0x66a6bb=a0_0xfbe6b3;try{const _0x43fe34=path['join'](__dirname,_0x66a6bb(0x244),'service.py');_0x5e43ce[_0x66a6bb(0x18e)][_0x66a6bb(0x2e0)](_0x66a6bb(0x2d3)+_0x43fe34),_0x5e43ce[_0x66a6bb(0x19f)]=spawn(_0x66a6bb(0x32f),[_0x43fe34]),_0x5e43ce['pythonProcess'][_0x66a6bb(0x332)]['on'](_0x66a6bb(0x222),_0x11b912=>{const _0x45c706=_0x66a6bb,_0x538d48=_0x11b912[_0x45c706(0x146)]()[_0x45c706(0x198)]('\x0a');_0x538d48[_0x45c706(0x2f1)](_0x174c90=>{const _0x223828=_0x45c706,_0x372e97=_0x174c90['trim']();if(!_0x372e97)return;if(_0x372e97[_0x223828(0x13c)](_0x223828(0x28c)))_0x5e43ce[_0x223828(0x18e)][_0x223828(0x12e)](_0x223828(0x13b)+_0x372e97['substring'](0x5)[_0x223828(0x2fe)]());else{if(_0x372e97[_0x223828(0x13c)](_0x223828(0x2c0)))try{const _0x57c7ef=JSON[_0x223828(0x2e9)](_0x372e97[_0x223828(0x1a7)](0x8)[_0x223828(0x2fe)]());handlePythonResult(_0x5e43ce,_0x57c7ef);}catch(_0x1185a4){_0x5e43ce[_0x223828(0x18e)][_0x223828(0x2d7)]('Invalid\x20JSON\x20from\x20Python:\x20'+_0x372e97);}}(_0x372e97[_0x223828(0x12c)](_0x223828(0x2de))||_0x372e97['includes'](_0x223828(0x1c6)))&&(_0x5e43ce[_0x223828(0x18e)][_0x223828(0x2d7)](_0x223828(0x13a)),installPythonDependencies(_0x5e43ce));});}),_0x5e43ce['pythonProcess'][_0x66a6bb(0x1cb)]['on']('data',_0x5a8d02=>{const _0x109613=_0x66a6bb,_0x53f1d2=_0x5a8d02[_0x109613(0x146)]()[_0x109613(0x2fe)]();_0x5e43ce[_0x109613(0x18e)][_0x109613(0x12f)](_0x109613(0x229)+_0x53f1d2);}),_0x5e43ce['pythonProcess']['on'](_0x66a6bb(0x1fa),_0x1940fa=>{const _0x13ccbb=_0x66a6bb;_0x5e43ce[_0x13ccbb(0x18e)]['info']('[PYTHON]\x20Service\x20exited\x20with\x20code\x20'+_0x1940fa),_0x5e43ce[_0x13ccbb(0x19f)]=null;}),_0x5e43ce[_0x66a6bb(0x19f)]['on'](_0x66a6bb(0x12f),_0xe9f15e=>{const _0x4ea63b=_0x66a6bb;_0x5e43ce[_0x4ea63b(0x18e)][_0x4ea63b(0x2d7)](_0x4ea63b(0x2c5)+_0xe9f15e[_0x4ea63b(0x30b)]);});}catch(_0x567b11){_0x5e43ce['log'][_0x66a6bb(0x12f)]('Error\x20launching\x20Python\x20service:\x20'+_0x567b11['message']);}}function stopPythonService(_0x460a21){const _0x3db3dd=a0_0xfbe6b3;if(_0x460a21['pythonProcess']){_0x460a21[_0x3db3dd(0x18e)]['info'](_0x3db3dd(0x21c));try{_0x460a21['pythonProcess'][_0x3db3dd(0x264)]();}catch(_0x1b865a){_0x460a21[_0x3db3dd(0x18e)][_0x3db3dd(0x2d7)](_0x3db3dd(0x1ea)+_0x1b865a[_0x3db3dd(0x30b)]);}_0x460a21[_0x3db3dd(0x19f)]=null;}}class CogniLiving extends utils[a0_0xfbe6b3(0x2a5)]{constructor(_0x38a07e){const _0x54c540=a0_0xfbe6b3;super({..._0x38a07e,'name':_0x54c540(0x1d9)}),this[_0x54c540(0x315)]=[],this[_0x54c540(0x185)]=[],this[_0x54c540(0x189)]=[],this[_0x54c540(0x169)]=[],this[_0x54c540(0x2aa)]=[],this[_0x54c540(0x2b2)]={},this[_0x54c540(0x29c)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x54c540(0x22c)]=!![],this[_0x54c540(0x1be)]=null,this[_0x54c540(0x17a)]=null,this[_0x54c540(0x186)]=![],this[_0x54c540(0x327)]=null,this[_0x54c540(0x16b)]=null,this[_0x54c540(0x131)]=SYSTEM_MODES[_0x54c540(0x206)],this[_0x54c540(0x149)]=![],this[_0x54c540(0x216)]=![],this[_0x54c540(0x17d)]='unknown',this['analysisTimer']=null,this[_0x54c540(0x22f)]=null,this[_0x54c540(0x283)]=null,this[_0x54c540(0x208)]=null,this[_0x54c540(0x190)]=null,this[_0x54c540(0x19f)]=null,this[_0x54c540(0x2b7)]=![],this['on'](_0x54c540(0x129),this['onReady']['bind'](this)),this['on'](_0x54c540(0x152),this['onStateChange'][_0x54c540(0x1d1)](this)),this['on'](_0x54c540(0x136),this[_0x54c540(0x258)]['bind'](this)),this['on'](_0x54c540(0x30b),this[_0x54c540(0x271)]['bind'](this));}async[a0_0xfbe6b3(0x215)](){const _0x4e943a=a0_0xfbe6b3;this[_0x4e943a(0x18e)][_0x4e943a(0x2e0)](_0x4e943a(0x14d)+this[_0x4e943a(0x31c)]+_0x4e943a(0x2f6)),await initZombies(this),this['config'][_0x4e943a(0x2bd)]=this[_0x4e943a(0x232)]['licenseKey']||'';try{this['isProVersion']=await checkLicense(this,this[_0x4e943a(0x232)][_0x4e943a(0x2bd)]);}catch(_0x436b80){}this[_0x4e943a(0x18e)][_0x4e943a(0x2e0)](_0x4e943a(0x2c8)+!!this[_0x4e943a(0x232)][_0x4e943a(0x2bd)]+'\x20|\x20Status:\x20'+(this['isProVersion']?_0x4e943a(0x28d):_0x4e943a(0x306)));if(!this[_0x4e943a(0x232)]['inactivityThresholdHours']||this[_0x4e943a(0x232)][_0x4e943a(0x2e7)]<0.1)this['config']['inactivityThresholdHours']=0xc;await initHistory(this),await initSystemConfig(this);if(this[_0x4e943a(0x232)]['geminiApiKey'])try{this[_0x4e943a(0x327)]=new GoogleGenerativeAI(this[_0x4e943a(0x232)][_0x4e943a(0x30d)]),this[_0x4e943a(0x16b)]=this[_0x4e943a(0x327)][_0x4e943a(0x243)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x4e943a(0x2ea)}}),this[_0x4e943a(0x18e)][_0x4e943a(0x2e0)](_0x4e943a(0x170));}catch(_0x5d5f56){this[_0x4e943a(0x18e)][_0x4e943a(0x12f)](_0x4e943a(0x2df)+_0x5d5f56[_0x4e943a(0x30b)]);}await createAllObjects(this),await loadSystemMode(this),await loadRawEventLog(this),await loadDailyDigests(this),this[_0x4e943a(0x1a1)](_0x4e943a(0x156)),this['subscribeStates'](LTM_DP_TRIGGER_DIGEST),this[_0x4e943a(0x1a1)]('system.mode'),this[_0x4e943a(0x1a1)](_0x4e943a(0x316)),this['subscribeStates'](_0x4e943a(0x279)),this[_0x4e943a(0x1a1)](_0x4e943a(0x144)),await initSensorSubscriptions(this),await initPresenceSubscriptions(this),await setupTelegramListener(this),setTimeout(()=>checkWifiPresence(this),0x1388);if(this[_0x4e943a(0x2bc)])clearInterval(this[_0x4e943a(0x2bc)]);const _0xc4407c=this[_0x4e943a(0x232)][_0x4e943a(0x165)]||0xf;_0xc4407c>0x0&&(this[_0x4e943a(0x18e)][_0x4e943a(0x2e0)](_0x4e943a(0x297)+_0xc4407c+_0x4e943a(0x1ec)),this[_0x4e943a(0x2bc)]=setInterval(()=>{runAutopilot(this);},_0xc4407c*0x3c*0x3e8)),setupLtmScheduler(this),setupModeResetScheduler(this),setupDriftAnalysisScheduler(this),setupBriefingScheduler(this),startPythonService(this),setTimeout(()=>{const _0x593cd4=_0x4e943a;this[_0x593cd4(0x19f)]&&runPythonHealthCheck(this);},0x1388);}['onUnload'](_0xb1c0af){const _0x706b9d=a0_0xfbe6b3;if(this[_0x706b9d(0x2bc)])clearInterval(this[_0x706b9d(0x2bc)]);if(this['driftAnalysisTimer'])clearInterval(this[_0x706b9d(0x208)]);if(this[_0x706b9d(0x22f)])this[_0x706b9d(0x22f)][_0x706b9d(0x1fe)]();if(this[_0x706b9d(0x283)])this[_0x706b9d(0x283)]['cancel']();if(this[_0x706b9d(0x190)])this[_0x706b9d(0x190)][_0x706b9d(0x1fe)]();if(this[_0x706b9d(0x1be)])clearTimeout(this['exitTimer']);if(this[_0x706b9d(0x17a)])clearTimeout(this[_0x706b9d(0x17a)]);stopPythonService(this),_0xb1c0af();}async['onStateChange'](_0x52d4ce,_0x5ca185){const _0x56866d=a0_0xfbe6b3;if(!_0x5ca185)return;if(_0x52d4ce[_0x56866d(0x12c)](_0x56866d(0x275))&&_0x52d4ce[_0x56866d(0x251)](_0x56866d(0x2e3))&&_0x5ca185[_0x56866d(0x1fc)]){await handleTelegramResponse(this,_0x5ca185[_0x56866d(0x1fc)]);return;}if(_0x52d4ce===this[_0x56866d(0x137)]+'.'+SYSTEM_DP_MODE){_0x5ca185[_0x56866d(0x1fc)]&&Object[_0x56866d(0x15a)](SYSTEM_MODES)[_0x56866d(0x12c)](_0x5ca185[_0x56866d(0x1fc)])&&(this[_0x56866d(0x131)]=_0x5ca185[_0x56866d(0x1fc)],_0x5ca185[_0x56866d(0x1fc)]===SYSTEM_MODES[_0x56866d(0x23d)]?await setPresence(this,![]):await setPresence(this,!![]));if(!_0x5ca185[_0x56866d(0x17e)])this['setState'](_0x52d4ce,{'val':this['currentSystemMode'],'ack':!![]});return;}if(!_0x5ca185[_0x56866d(0x17e)]){_0x52d4ce[_0x56866d(0x12c)](_0x56866d(0x156))&&_0x5ca185[_0x56866d(0x1fc)]&&(this[_0x56866d(0x323)](_0x52d4ce,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x52d4ce[_0x56866d(0x12c)]('triggerDailyDigest')&&_0x5ca185['val']){this[_0x56866d(0x323)](_0x52d4ce,{'val':![],'ack':!![]});if(this[_0x56866d(0x149)])createDailyDigest(this);}_0x52d4ce[_0x56866d(0x12c)](_0x56866d(0x145))&&_0x5ca185[_0x56866d(0x1fc)]&&(this[_0x56866d(0x323)](_0x52d4ce,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x52d4ce['includes'](_0x56866d(0x321))&&_0x5ca185[_0x56866d(0x1fc)]&&(this[_0x56866d(0x323)](_0x52d4ce,{'val':![],'ack':!![]}),executeAutomationAction(this));return;}if(this[_0x56866d(0x232)][_0x56866d(0x240)]&&this[_0x56866d(0x232)]['presenceDevices'][_0x56866d(0x12c)](_0x52d4ce)){await checkWifiPresence(this);return;}const _0x1c83b6=(this[_0x56866d(0x232)][_0x56866d(0x197)]||[])['find'](_0x9f446b=>_0x9f446b['id']===_0x52d4ce);if(_0x1c83b6)processSensorEvent(this,_0x52d4ce,_0x5ca185,_0x1c83b6);}async[a0_0xfbe6b3(0x271)](_0x5a94ea){const _0x90baba=a0_0xfbe6b3;if(typeof _0x5a94ea===_0x90baba(0x172)&&_0x5a94ea[_0x90baba(0x30b)])try{if(_0x5a94ea[_0x90baba(0x16f)]===_0x90baba(0x1e0)){const _0x3a89a5=_0x5a94ea[_0x90baba(0x30b)][_0x90baba(0x318)]||this[_0x90baba(0x232)][_0x90baba(0x30d)];if(!_0x3a89a5)return this[_0x90baba(0x14b)](_0x5a94ea['from'],_0x5a94ea['command'],{'success':![],'message':_0x90baba(0x174)},_0x5a94ea[_0x90baba(0x1ef)]);try{const _0x1fc810=new GoogleGenerativeAI(_0x3a89a5),_0x42db64=_0x1fc810[_0x90baba(0x243)]({'model':GEMINI_MODEL}),_0x466d6b=await _0x42db64[_0x90baba(0x285)](_0x90baba(0x288)),_0x1af457=await _0x466d6b['response'],_0x2d89a6=_0x1af457[_0x90baba(0x23f)]();this[_0x90baba(0x14b)](_0x5a94ea['from'],_0x5a94ea[_0x90baba(0x16f)],{'success':!![],'message':_0x90baba(0x2a0)+_0x2d89a6['substring'](0x0,0x14)+_0x90baba(0x2fb)},_0x5a94ea[_0x90baba(0x1ef)]);}catch(_0x3ba78a){this[_0x90baba(0x14b)](_0x5a94ea[_0x90baba(0x182)],_0x5a94ea['command'],{'success':![],'message':_0x90baba(0x1e3)+_0x3ba78a[_0x90baba(0x30b)]},_0x5a94ea[_0x90baba(0x1ef)]);}}else{if(_0x5a94ea['command']===_0x90baba(0x301)){const _0x45fb46=await getWeatherContext(this),_0x31db42=await getCalendarContext(this);this[_0x90baba(0x14b)](_0x5a94ea[_0x90baba(0x182)],_0x5a94ea['command'],{'success':!![],'weather':_0x45fb46,'calendar':_0x31db42},_0x5a94ea[_0x90baba(0x1ef)]);}else{if(_0x5a94ea[_0x90baba(0x16f)]===_0x90baba(0x2c2)){}else{if(_0x5a94ea[_0x90baba(0x16f)]===_0x90baba(0x270)){if(!this['isProVersion'])return this[_0x90baba(0x14b)](_0x5a94ea[_0x90baba(0x182)],_0x5a94ea[_0x90baba(0x16f)],{'success':![],'isPro':![]},_0x5a94ea['callback']);let _0x513fdc={'status':_0x90baba(0x224),'details':'','lastCheck':0x0};try{_0x513fdc['status']=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))['val'],_0x513fdc[_0x90baba(0x188)]=(await this[_0x90baba(0x2be)](LTM_DP_DRIFT_DETAILS))[_0x90baba(0x1fc)],_0x513fdc[_0x90baba(0x26b)]=(await this[_0x90baba(0x2be)](LTM_DP_DRIFT_LAST_CHECK))[_0x90baba(0x1fc)];}catch(_0x2778b9){}const _0x323d3f=this[_0x90baba(0x185)]||[];this[_0x90baba(0x14b)](_0x5a94ea['from'],_0x5a94ea[_0x90baba(0x16f)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x90baba(0x2aa)],'driftAnalysis':_0x513fdc,'analysisHistory':_0x323d3f},_0x5a94ea[_0x90baba(0x1ef)]);}else{if(_0x5a94ea[_0x90baba(0x16f)]===_0x90baba(0x209)){const _0x44ca19=this[_0x90baba(0x2aa)][_0x90baba(0x334)],_0x499652=new Date(),_0x3d4252=new Date(_0x499652[_0x90baba(0x134)](),_0x499652['getMonth'](),_0x499652[_0x90baba(0x1e9)]())[_0x90baba(0x1b3)](),_0x5b3bfe=this[_0x90baba(0x169)]['filter'](_0x750f61=>new Date(_0x750f61['timestamp'])[_0x90baba(0x1b3)]()>_0x3d4252)['length'],_0x478890=new Array(0x18)[_0x90baba(0x277)](0x0);this['rawEventLog'][_0x90baba(0x2f1)](_0x32e826=>{const _0x13b584=_0x90baba,_0x331a02=new Date(_0x32e826['timestamp']);if(_0x331a02[_0x13b584(0x1b3)]()>_0x3d4252)_0x478890[_0x331a02[_0x13b584(0x1c7)]()]++;});let _0x63fd14={'status':_0x90baba(0x224)};try{_0x63fd14[_0x90baba(0x214)]=(await this[_0x90baba(0x2be)](LTM_DP_DRIFT_STATUS))[_0x90baba(0x1fc)];}catch(_0x272145){}let _0x6b585a='';try{const _0x2b916f=await this['getStateAsync'](_0x90baba(0x2ae));_0x6b585a=_0x2b916f?_0x2b916f['val']:'';}catch(_0x1124a8){}let _0x4636b6=null;!this[_0x90baba(0x16b)]&&(_0x4636b6=this[_0x90baba(0x232)][_0x90baba(0x30d)]?_0x90baba(0x1af):_0x90baba(0x207));let _0x37a787={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x2b426a=await this['getStateAsync'](_0x90baba(0x2ba)),_0xf11d47=await this[_0x90baba(0x2be)](_0x90baba(0x2e8)),_0x5073c3=await this[_0x90baba(0x2be)](_0x90baba(0x230)),_0x2e2d92=await this[_0x90baba(0x2be)]('analysis.automation.targetValue'),_0x4e1bc8=await this[_0x90baba(0x2be)](_0x90baba(0x144));_0x2b426a&&_0x2b426a[_0x90baba(0x1fc)]&&(_0x37a787[_0x90baba(0x1e4)]=!![],_0x37a787['description']=_0xf11d47?_0xf11d47[_0x90baba(0x1fc)]:'',_0x37a787[_0x90baba(0x162)]=_0x5073c3?_0x5073c3[_0x90baba(0x1fc)]:'',_0x37a787[_0x90baba(0x2fa)]=_0x2e2d92?_0x2e2d92[_0x90baba(0x1fc)]:''),_0x37a787['autoApply']=_0x4e1bc8?!!_0x4e1bc8[_0x90baba(0x1fc)]:![];}catch(_0x4dd271){}this[_0x90baba(0x14b)](_0x5a94ea[_0x90baba(0x182)],_0x5a94ea[_0x90baba(0x16f)],{'success':!![],'eventHistory':this[_0x90baba(0x315)]['slice'](0x0,0xf),'stats':{'digestCount':_0x44ca19,'eventCountToday':_0x5b3bfe,'hourlyActivity':_0x478890,'driftStatus':_0x63fd14[_0x90baba(0x214)],'isPresent':this[_0x90baba(0x22c)],'presenceWho':_0x6b585a,'minDays':this['config'][_0x90baba(0x201)]||0x7,'stbDays':this[_0x90baba(0x232)][_0x90baba(0x32d)]||0xe,'ltbDays':this[_0x90baba(0x232)]['ltmLtbWindowDays']||0x3c,'systemError':_0x4636b6},'automation':_0x37a787},_0x5a94ea['callback']);}else{if(_0x5a94ea[_0x90baba(0x16f)]===_0x90baba(0x30c)){const _0x13b857=await this[_0x90baba(0x2dd)](_0x90baba(0x1a2),_0x90baba(0x18b)),_0x47a86d=[];if(_0x13b857)for(const _0x231190 in _0x13b857){const _0x5eafa6=_0x13b857[_0x231190],_0x36577a=(_0x5eafa6[_0x90baba(0x18f)]&&typeof _0x5eafa6['common']['name']==='object'?_0x5eafa6[_0x90baba(0x18f)]['name']['de']:_0x5eafa6['common']['name'])||_0x5eafa6[_0x90baba(0x18f)][_0x90baba(0x1f2)];_0x47a86d[_0x90baba(0x178)]({'id':_0x231190,'name':_0x36577a});}this[_0x90baba(0x14b)](_0x5a94ea[_0x90baba(0x182)],_0x5a94ea[_0x90baba(0x16f)],{'success':!![],'enums':_0x47a86d},_0x5a94ea[_0x90baba(0x1ef)]);}else{if(_0x5a94ea[_0x90baba(0x16f)]===_0x90baba(0x307))try{const _0x187a9c=await scanForDevices(this,_0x5a94ea[_0x90baba(0x30b)]||{});this[_0x90baba(0x14b)](_0x5a94ea['from'],_0x5a94ea[_0x90baba(0x16f)],{'success':!![],'devices':_0x187a9c},_0x5a94ea[_0x90baba(0x1ef)]);}catch(_0xd246f9){this[_0x90baba(0x14b)](_0x5a94ea['from'],_0x5a94ea[_0x90baba(0x16f)],{'success':![],'error':_0xd246f9[_0x90baba(0x30b)]},_0x5a94ea['callback']);}else{if(_0x5a94ea[_0x90baba(0x16f)]==='getCalendarNames'){const _0x10d212=_0x5a94ea[_0x90baba(0x30b)][_0x90baba(0x2ce)];if(!_0x10d212)return this['sendTo'](_0x5a94ea['from'],_0x5a94ea[_0x90baba(0x16f)],{'success':![],'error':_0x90baba(0x242)},_0x5a94ea['callback']);const _0x434086=await getCalendarNames(this,_0x10d212);this['sendTo'](_0x5a94ea[_0x90baba(0x182)],_0x5a94ea[_0x90baba(0x16f)],{'success':!![],'names':_0x434086},_0x5a94ea['callback']);}else{if(_0x5a94ea[_0x90baba(0x16f)]===_0x90baba(0x2ec)){const {targetId:_0x12d430,targetValue:_0x2a4aaf}=_0x5a94ea['message'];this[_0x90baba(0x18e)][_0x90baba(0x2e0)](_0x90baba(0x1d7)+_0x12d430+_0x90baba(0x17f)+_0x2a4aaf),await this[_0x90baba(0x15d)](_0x90baba(0x2ba),{'val':!![],'ack':!![]}),await this[_0x90baba(0x15d)](_0x90baba(0x2e8),{'val':_0x90baba(0x192)+_0x12d430,'ack':!![]}),await this[_0x90baba(0x15d)]('analysis.automation.targetId',{'val':_0x12d430,'ack':!![]}),await this[_0x90baba(0x15d)](_0x90baba(0x205),{'val':_0x2a4aaf,'ack':!![]}),this[_0x90baba(0x14b)](_0x5a94ea['from'],_0x5a94ea['command'],{'success':!![]},_0x5a94ea['callback']);}else{if(_0x5a94ea[_0x90baba(0x16f)]===_0x90baba(0x141)){const {historyId:_0x4c5345,rating:_0x48e02a,comment:_0x4c7fa1,alertReason:_0x5863f2}=_0x5a94ea[_0x90baba(0x30b)];_0x4c5345&&_0x48e02a?(await saveFeedback(this,{'timestamp':Date[_0x90baba(0x1b5)](),'historyId':_0x4c5345,'rating':_0x48e02a,'comment':_0x4c7fa1,'alertReason':_0x5863f2}),this['sendTo'](_0x5a94ea[_0x90baba(0x182)],_0x5a94ea[_0x90baba(0x16f)],{'success':!![]},_0x5a94ea['callback'])):this['sendTo'](_0x5a94ea[_0x90baba(0x182)],_0x5a94ea['command'],{'success':![],'error':_0x90baba(0x338)},_0x5a94ea['callback']);}else _0x5a94ea['command']===_0x90baba(0x23a)&&(this[_0x90baba(0x18e)][_0x90baba(0x2e0)]('User\x20dismissed\x20automation\x20proposal.'),await this[_0x90baba(0x15d)]('analysis.automation.patternDetected',{'val':![],'ack':!![]}),await this[_0x90baba(0x15d)](_0x90baba(0x2e8),{'val':'','ack':!![]}),this[_0x90baba(0x14b)](_0x5a94ea[_0x90baba(0x182)],_0x5a94ea[_0x90baba(0x16f)],{'success':!![]},_0x5a94ea[_0x90baba(0x1ef)]));}}}}}}}}}}catch(_0x24883a){this['log'][_0x90baba(0x12f)](_0x90baba(0x2ab)+_0x5a94ea['command']+':\x20'+_0x24883a['message']);if(_0x5a94ea[_0x90baba(0x1ef)])this[_0x90baba(0x14b)](_0x5a94ea[_0x90baba(0x182)],_0x5a94ea[_0x90baba(0x16f)],{'success':![],'error':_0x24883a[_0x90baba(0x30b)]},_0x5a94ea[_0x90baba(0x1ef)]);}}}if(require[a0_0xfbe6b3(0x23b)]!==module)module['exports']=_0x54eb8f=>new CogniLiving(_0x54eb8f);else new CogniLiving();