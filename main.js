const a0_0x6dfaba=a0_0x3d7e;(function(_0x17e7d3,_0x373ae1){const _0x20ffb5=a0_0x3d7e,_0x2bfdf8=_0x17e7d3();while(!![]){try{const _0x1c9280=parseInt(_0x20ffb5(0x2b7))/0x1+parseInt(_0x20ffb5(0x186))/0x2+parseInt(_0x20ffb5(0x21f))/0x3*(-parseInt(_0x20ffb5(0x298))/0x4)+-parseInt(_0x20ffb5(0x22b))/0x5+parseInt(_0x20ffb5(0x18d))/0x6*(-parseInt(_0x20ffb5(0x17a))/0x7)+-parseInt(_0x20ffb5(0x284))/0x8+parseInt(_0x20ffb5(0x209))/0x9*(parseInt(_0x20ffb5(0x208))/0xa);if(_0x1c9280===_0x373ae1)break;else _0x2bfdf8['push'](_0x2bfdf8['shift']());}catch(_0x50de6b){_0x2bfdf8['push'](_0x2bfdf8['shift']());}}}(a0_0x3d99,0xe53b3));const a0_0x12b66e=(function(){let _0x1cd092=!![];return function(_0x5260d5,_0x4899e8){const _0x5881fe=_0x1cd092?function(){if(_0x4899e8){const _0x70fdf6=_0x4899e8['apply'](_0x5260d5,arguments);return _0x4899e8=null,_0x70fdf6;}}:function(){};return _0x1cd092=![],_0x5881fe;};}()),a0_0x3d8bab=a0_0x12b66e(this,function(){const _0x29432e=a0_0x3d7e;return a0_0x3d8bab['toString']()[_0x29432e(0x249)](_0x29432e(0x288))[_0x29432e(0x16d)]()['constructor'](a0_0x3d8bab)[_0x29432e(0x249)](_0x29432e(0x288));});a0_0x3d8bab();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x6dfaba(0x1b2)),path=require(a0_0x6dfaba(0x20d)),fs=require('fs'),installer=require(a0_0x6dfaba(0x1f5)),scanner=require('./lib/scanner'),schedulers=require(a0_0x6dfaba(0x274)),topology=require(a0_0x6dfaba(0x252)),setup=require(a0_0x6dfaba(0x28c)),recorder=require(a0_0x6dfaba(0x2c3)),pythonBridge=require(a0_0x6dfaba(0x297)),aiAgent=require(a0_0x6dfaba(0x1db)),deadMan=require(a0_0x6dfaba(0x1ed)),automation=require('./lib/automation'),GEMINI_MODEL=a0_0x6dfaba(0x254);function a0_0x3d7e(_0x53ec58,_0x36e08e){const _0x447fe4=a0_0x3d99();return a0_0x3d7e=function(_0x3d8bab,_0x12b66e){_0x3d8bab=_0x3d8bab-0x167;let _0x3d9938=_0x447fe4[_0x3d8bab];return _0x3d9938;},a0_0x3d7e(_0x53ec58,_0x36e08e);}function a0_0x3d99(){const _0x15b505=['inactivityThresholdHours','push','endsWith','SET_LEARNING_MODE','sensorLastValues','getAbsoluteDefaultDataDir','.last_seen','system.adapter.ical.','\x20Tage)','times','11875856wsVAtB','setState','Sec-Training\x20started...','initZombies','(((.+)+)+)+$','triggerGaitAnalysis','namespace','moduleComfort','./lib/setup','cogni-living\x20adapter\x20starting\x20(v','pulse','\x20(Threshold)','utf8','sonn','unshift','getDate','üì¶\x20Restored\x20','reduce','security','./lib/python_bridge','4GAlWBt','cancel','round','date','thermostat','toFixed','‚Ü∫\x20Replaying\x20','analysis.automation.description','¬∞C,\x20Au√üen:\x20','info','send','door','sendTo','‚ö†\x20Replay\x20skipped:\x20No\x20events\x20in\x20memory.','from','appendToLog','min',')\x20-\x20Phase\x20E\x20(Scheduler\x20Fix)','weatherTempId','custom','.uptime','weatherunderground.0','subscribeForeignStatesAsync','accuweather.0','presenceDevices','parse','TRAIN_COMFORT','calendarCheckTimer','analysis.health.todayVector','analysisTimer','Aktiv\x20(','205096OqFSva','checkThermostats','setPresence','Adapter','Gemini\x20Report\x20Night','üíæ\x20Saving\x20Daily\x20History\x20for\x20','python','stringify','updateLocation','message','analysis.energy.warmupTargets','party','./lib/recorder','checkLicense','timestamp','Warte\x20auf\x20Analyse...','isArray','lastTrackerEventTime','onStateChange','üîÆ\x20Energy\x20Prediction\x20triggered\x20(','analysis.security.learningStatus','protectAiMemory','rawEventLog','outdoorSensorId','pop','analysis.automation.targetId','some','main','window','\x22history\x22:{}','ack','isPresent','üîä\x20FORENSIC:\x20Infraschall\x20bei\x20Abwesenheit!\x20Pressure:\x20','name','No\x20topology\x20data\x20found','activeModules','enum.rooms.*','toString','filter','onUnload','59\x2023\x20*\x20*\x20*','runPythonHealthCheck','setStateAsync','checkSolarCondition','existsSync','General\x20Activity\x20Trend','max','analysis.energy.warmupSources','text','analysis.trigger','28kFEykt','log','getForeignStateAsync','map','triggerBriefing','analysis.training.triggerComfort','createDailyDigest','toLowerCase','TRAIN_HEALTH','split','then','üï∏Ô∏è\x20Topology\x20Matrix\x20manually\x20updated\x20by\x20user.','2050428QkuOAj','enum.functions.*','checkWifiPresence','runGeminiAnalysis','analysis.training.triggerSecurity','Unbekannt','getTime','1470012IDNfEK','dependencyInstallInProgress','forEach','analysis.training.triggerHealth','sendMorningBriefing','terrasse','Gemini\x20Init\x20Error:\x20','callback','find','Keine\x20Daten','getStateAsync','enum','LTM.trainingData.sequences','forecast.current.weather','warn','memoryCache','now','Lernphase\x20(','analysis.prediction.trackerConfidence','üîä\x20Infraschall-Alarm:\x20','\x20>\x20','open','value','devices','sources','bind','todayVector','moduleSecurity','L√ºften\x20empfohlen','.data.table','triggerDailyDigest','klar','replayTodayEvents','licenseKey','Event','Scan\x20Error:\x20','cogni-living','@google/generative-ai','keys','isSolar','startService','manual','processSensorEvent','initHistory','getObjectViewAsync','modeResetJob','getHours','moduleEnergy',':\x20Temp-Differenz\x20','presenceCheckTimer','stateChange',',\x20Temp:\x20','testContext','automation.triggerAction','NIGHT','bootTime','integrateRoomTime','system','all','scanDevices','sunny','infrasoundLocked','scanThermostats','\x20rooms)','response','genAI','Failed\x20to\x20trigger\x20Python\x20Health\x20Check','temperature','Party\x20Mode','updateTopology','system.presenceWho','isProVersion','haust√ºr','moduleHealth','Room\x20Dwell\x20Time\x20Stats','saveDailyHistory','shift','currentSystemMode','./lib/ai_agent','Invalid\x20matrix\x20data','geminiModel','json','analysisHistory','length','‚úÖ\x20Dashboard\x20Data\x20(Rooms\x20&\x20Timeline\x20&\x20Details)\x20restored.','comfort','getForeignObjectsAsync','systemConfig','string','exitGraceTimer','threshold_exceeded','analysis.health.activityTrend','LTM.dailyDigests','version','getOverviewData','Live\x20Event\x20Pulse','./lib/dead_man','üö∂\x20Gait\x20Analysis\x20triggered\x20with\x20','analysis.health.todayRoomDetails','unload','eventHistory','LTM.rawEventLog','rows','analysis.topology.structure','./lib/installer','calendarName','DAY','Guest\x20Mode','getHistoryData','startSystem','triggerGaitAnalysis\x20parse\x20error:\x20','analysis.prediction.trackerTopRoom','onReady','pythonBridge','analysis.training.triggerEnergy','slice','createAllObjects','error','modules','.json','events.history','history','infrasoundSensorId','10uAuzfA','34406325gAhKxO','add','location','analysis.ventilation.lastWindow','path','val','handleInfrasound','updateHealthVector','stopService','matrix','\x20events\x20from\x20today...','analysis.health.geminiNight','de-DE','type','trackerHeartbeat','infrasoundEnabled','floor','toLocaleTimeString','number','onMessage','pressureBuffer','setDate','2613288HmytaS','triggerInfrasoundCorrelation','Standard','...','Say\x20Hello','includes','setObjectNotExistsAsync','isRelevantActivity','\x20Kalender-Adapter\x20gefunden.','bin','SYSTEM_MODES','scheduleJob','3893590TeCixS','system.adapter.ical.È¶ô','object','ERROR','energy','toLocaleDateString','{\x22history\x22:{}}','infrasoundArmingId','lastAlertState','Corrupt','generateHealthReport','updated','fill','application/json','NORMAL','historyJob','heiter','debug','SYSTEM_DP_MODE','\x20(Bewohner\x20anwesend\x20-\x20normal)','analysis.visualization.pulse','analysis.energy.warmupTimes','values','readFileSync','clear','üö®\x20INFRASCHALL-ALARM:\x20Anomalie\x20bei\x20Abwesenheit\x20(scharf)!','¬∞C)','updateSchedulePreview','roomIntegratorTimer','config','search','.isOnline','setHours','sendNotification','infrasoundThreshold','‚òÄÔ∏è\x20Solar\x20Condition:\x20SUNNY\x20detected\x20via\x20','instance','analysis.activity.roomStats','motion','./lib/topology','testApiKey','models/gemini-flash-latest','No\x20data','state','command','analysis.activity.roomHistory','online','checkCalendarTriggers','triggerGaitAnalysis\x20error:\x20','¬∞C\x20(Innen:\x20','geminiApiKey','loadSystemMode','health','subscribeForeignStates','abortExitTimer','abs','triggerEnergyPrediction','join','analyzeWindowOpening','healthTrendInterval','Gemini\x20Report\x20Day','analysis.training.status','substring','üêç\x20Triggering\x20Python\x20Health\x20Check\x20(Activity\x20Trend)...','getGenerativeModel','.system.mode','2-digit','üîä\x20Infraschall:\x20','isGracePeriodActive','subscribeStates','Unknown','replace','Kein\x20API\x20Key\x20√ºbergeben.','./lib/scheduler','dailyDigests','LTM.baselineStatus','\x20sequences','CALCULATE_HEALTH_TREND','getMinutes'];a0_0x3d99=function(){return _0x15b505;};return a0_0x3d99();}class CogniLiving extends utils[a0_0x6dfaba(0x2ba)]{constructor(_0x33c7f1){const _0x3e1467=a0_0x6dfaba;super({..._0x33c7f1,'name':_0x3e1467(0x1b1)}),this[_0x3e1467(0x1f1)]=[],this[_0x3e1467(0x1df)]=[],this[_0x3e1467(0x2cd)]=[],this['dailyDigests']=[],this['sensorLastValues']={},this[_0x3e1467(0x1e4)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x3e1467(0x167)]=!![],this['exitTimer']=null,this[_0x3e1467(0x1e6)]=null,this[_0x3e1467(0x26f)]=![],this['genAI']=null,this[_0x3e1467(0x1dd)]=null,this[_0x3e1467(0x1da)]=setup[_0x3e1467(0x229)][_0x3e1467(0x239)],this[_0x3e1467(0x1d4)]=![],this[_0x3e1467(0x233)]=![],this[_0x3e1467(0x2b5)]=null,this[_0x3e1467(0x2b3)]=null,this[_0x3e1467(0x1be)]=null,this['ltmJob']=null,this[_0x3e1467(0x1ba)]=null,this['driftAnalysisTimer']=null,this['briefingJob']=null,this[_0x3e1467(0x23a)]=null,this[_0x3e1467(0x217)]=null,this[_0x3e1467(0x266)]=null,this['roomIntegratorTimer']=null,this[_0x3e1467(0x18e)]=![],this[_0x3e1467(0x2c8)]=Date[_0x3e1467(0x19d)](),this[_0x3e1467(0x19c)]=null,this[_0x3e1467(0x1c4)]=Date['now'](),this['infrasoundLocked']=![],this['pressureBuffer']=[],this['activeModules']={'health':!![],'security':!![],'energy':!![],'comfort':!![]},this['on']('ready',this[_0x3e1467(0x1fd)]['bind'](this)),this['on'](_0x3e1467(0x1bf),this[_0x3e1467(0x2c9)]['bind'](this)),this['on'](_0x3e1467(0x1f0),this[_0x3e1467(0x16f)][_0x3e1467(0x1a6)](this)),this['on'](_0x3e1467(0x2c0),this[_0x3e1467(0x21c)]['bind'](this));}async[a0_0x6dfaba(0x1fd)](){const _0x473692=a0_0x6dfaba;this['log'][_0x473692(0x2a1)](_0x473692(0x28d)+this[_0x473692(0x1ea)]+_0x473692(0x2a9));if(this[_0x473692(0x248)][_0x473692(0x1d6)]!==undefined)this[_0x473692(0x16b)]['health']=this[_0x473692(0x248)]['moduleHealth'];if(this[_0x473692(0x248)][_0x473692(0x1a8)]!==undefined)this[_0x473692(0x16b)][_0x473692(0x296)]=this['config'][_0x473692(0x1a8)];if(this[_0x473692(0x248)][_0x473692(0x1bc)]!==undefined)this[_0x473692(0x16b)]['energy']=this['config'][_0x473692(0x1bc)];if(this[_0x473692(0x248)][_0x473692(0x28b)]!==undefined)this[_0x473692(0x16b)][_0x473692(0x1e2)]=this[_0x473692(0x248)][_0x473692(0x28b)];if(this['config'][_0x473692(0x203)])this[_0x473692(0x16b)]={...this[_0x473692(0x16b)],...this[_0x473692(0x248)][_0x473692(0x203)]};this['startSystem']();}async[a0_0x6dfaba(0x1fa)](){const _0x3ec588=a0_0x6dfaba;await setup[_0x3ec588(0x287)](this);try{this[_0x3ec588(0x1d4)]=await setup[_0x3ec588(0x2c4)](this[_0x3ec588(0x248)][_0x3ec588(0x1ae)]);}catch(_0x59d2a1){}if(!this['config'][_0x3ec588(0x27a)]||this[_0x3ec588(0x248)][_0x3ec588(0x27a)]<0.1)this[_0x3ec588(0x248)]['inactivityThresholdHours']=0xc;await setup[_0x3ec588(0x1b8)](this),await setup['initSystemConfig'](this),topology[_0x3ec588(0x1d2)](this);try{const _0x57d1e1=await this[_0x3ec588(0x197)](_0x3ec588(0x240)),_0xe028a=await this[_0x3ec588(0x197)]('analysis.energy.warmupSources');_0x57d1e1&&_0x57d1e1[_0x3ec588(0x20e)]&&_0xe028a&&_0xe028a['val']&&(Date[_0x3ec588(0x19d)]()-_0x57d1e1['ts']<0x4*0xe10*0x3e8&&(this[_0x3ec588(0x19c)]={'times':JSON[_0x3ec588(0x2b1)](_0x57d1e1['val']),'sources':JSON[_0x3ec588(0x2b1)](_0xe028a[_0x3ec588(0x20e)])}));}catch(_0x3f0e0f){}if(this[_0x3ec588(0x248)][_0x3ec588(0x25d)])try{this[_0x3ec588(0x1ce)]=new GoogleGenerativeAI(this['config']['geminiApiKey']),this[_0x3ec588(0x1dd)]=this[_0x3ec588(0x1ce)][_0x3ec588(0x26b)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x3ec588(0x238)}});}catch(_0x3f22c7){this[_0x3ec588(0x17b)][_0x3ec588(0x202)](_0x3ec588(0x193)+_0x3f22c7['message']);}await setup[_0x3ec588(0x201)](this),await this[_0x3ec588(0x25e)](),schedulers['initSchedules'](this),await this[_0x3ec588(0x225)](_0x3ec588(0x23f),{'type':'state','common':{'name':_0x3ec588(0x1ec),'type':_0x3ec588(0x21b),'role':_0x3ec588(0x1a3),'read':!![],'write':![]},'native':{}}),await this[_0x3ec588(0x225)](_0x3ec588(0x250),{'type':_0x3ec588(0x256),'common':{'name':_0x3ec588(0x1d7),'type':_0x3ec588(0x1e5),'role':_0x3ec588(0x1de),'read':!![],'write':![],'def':'{\x22today\x22:{},\x20\x22yesterday\x22:{},\x20\x22date\x22:\x22\x22}'},'native':{}}),await this['setObjectNotExistsAsync'](_0x3ec588(0x258),{'type':_0x3ec588(0x256),'common':{'name':'Room\x20History\x20(24h\x20Buckets)','type':'string','role':_0x3ec588(0x1de),'read':!![],'write':![],'def':_0x3ec588(0x231)},'native':{}}),await this[_0x3ec588(0x225)](_0x3ec588(0x214),{'type':_0x3ec588(0x256),'common':{'name':_0x3ec588(0x2bb),'type':_0x3ec588(0x1e5),'role':_0x3ec588(0x178),'read':!![],'write':![],'def':_0x3ec588(0x2c6)},'native':{}}),await this[_0x3ec588(0x225)]('analysis.health.geminiDay',{'type':_0x3ec588(0x256),'common':{'name':_0x3ec588(0x267),'type':_0x3ec588(0x1e5),'role':_0x3ec588(0x178),'read':!![],'write':![],'def':'Warte\x20auf\x20Analyse...'},'native':{}}),await this['setObjectNotExistsAsync'](_0x3ec588(0x2b4),{'type':'state','common':{'name':'Daily\x20Activity\x20Vector\x20(48x30min)','type':_0x3ec588(0x1e5),'role':_0x3ec588(0x1de),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['setObjectNotExistsAsync'](_0x3ec588(0x1ef),{'type':_0x3ec588(0x256),'common':{'name':'Daily\x20Room\x20Details\x20(48x30min)','type':_0x3ec588(0x1e5),'role':_0x3ec588(0x1de),'read':!![],'write':![],'def':'[]'},'native':{}}),await this['setObjectNotExistsAsync'](_0x3ec588(0x1e8),{'type':'state','common':{'name':_0x3ec588(0x175),'type':'number','role':_0x3ec588(0x1a3),'unit':'%','read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x3ec588(0x240),{'type':'state','common':{'name':'Warm-Up\x20Time','type':_0x3ec588(0x1e5),'role':_0x3ec588(0x1de),'read':!![],'write':![]},'native':{}});try{const _0x21a773=await this['getStateAsync'](_0x3ec588(0x205));if(_0x21a773&&_0x21a773[_0x3ec588(0x20e)]){this[_0x3ec588(0x1f1)]=JSON[_0x3ec588(0x2b1)](_0x21a773['val']);if(this[_0x3ec588(0x1d4)]){const _0x5c90c5=await this['getStateAsync']('LTM.rawEventLog');if(_0x5c90c5&&_0x5c90c5['val'])this['rawEventLog']=JSON[_0x3ec588(0x2b1)](_0x5c90c5[_0x3ec588(0x20e)]);}this[_0x3ec588(0x17b)]['info'](_0x3ec588(0x294)+this[_0x3ec588(0x1f1)][_0x3ec588(0x1e0)]+'\x20events\x20from\x20standard\x20storage.');}}catch(_0x21df84){this[_0x3ec588(0x1f1)]=[];}try{const _0x1fa03e=await this['getStateAsync'](_0x3ec588(0x1e9));if(_0x1fa03e&&_0x1fa03e[_0x3ec588(0x20e)])this[_0x3ec588(0x275)]=JSON[_0x3ec588(0x2b1)](_0x1fa03e[_0x3ec588(0x20e)]);}catch(_0x1cd251){this[_0x3ec588(0x275)]=[];}const _0x40b0ac=this['dailyDigests'][_0x3ec588(0x1e0)]>=(this[_0x3ec588(0x248)]['minDaysForBaseline']||0x7)?_0x3ec588(0x2b6)+this[_0x3ec588(0x275)][_0x3ec588(0x1e0)]+_0x3ec588(0x282):_0x3ec588(0x19e)+this[_0x3ec588(0x275)][_0x3ec588(0x1e0)]+'/'+(this[_0x3ec588(0x248)]['minDaysForBaseline']||0x7)+')';await this[_0x3ec588(0x172)](_0x3ec588(0x276),{'val':_0x40b0ac,'ack':!![]}),this['subscribeStates'](_0x3ec588(0x179)),this[_0x3ec588(0x270)]('LTM.triggerDailyDigest'),this[_0x3ec588(0x270)](_0x3ec588(0x190));this['config'][_0x3ec588(0x218)]&&this[_0x3ec588(0x248)][_0x3ec588(0x207)]&&this[_0x3ec588(0x16b)]['security']&&this[_0x3ec588(0x260)](this[_0x3ec588(0x248)][_0x3ec588(0x207)]);const _0x4c4c30=this[_0x3ec588(0x248)][_0x3ec588(0x1a4)];if(_0x4c4c30)for(const _0x150621 of _0x4c4c30){await this[_0x3ec588(0x2ae)](_0x150621['id']);}const _0x509ba8=this[_0x3ec588(0x248)][_0x3ec588(0x2b0)];if(_0x509ba8)for(const _0x5d70b5 of _0x509ba8){await this[_0x3ec588(0x2ae)](_0x5d70b5);}const _0x1be527=require('node-schedule');if(this[_0x3ec588(0x23a)])this[_0x3ec588(0x23a)][_0x3ec588(0x299)]();this[_0x3ec588(0x23a)]=_0x1be527[_0x3ec588(0x22a)](_0x3ec588(0x170),()=>{const _0x5b68c3=_0x3ec588;this[_0x5b68c3(0x1d8)]();}),setTimeout(()=>this[_0x3ec588(0x1ad)](),0x1388);if(this['roomIntegratorTimer'])clearInterval(this['roomIntegratorTimer']);this['integrateRoomTime'](),this['roomIntegratorTimer']=setInterval(async()=>{await this['integrateRoomTime']();},0x3c*0x3e8);if(this['healthTrendInterval'])clearInterval(this[_0x3ec588(0x266)]);this[_0x3ec588(0x266)]=setInterval(()=>{const _0x150e65=_0x3ec588;this[_0x150e65(0x1d4)]&&this['activeModules'][_0x150e65(0x25f)]&&this[_0x150e65(0x171)]();},0x4*0x3c*0x3c*0x3e8);if(this[_0x3ec588(0x2b5)])clearInterval(this['analysisTimer']);this[_0x3ec588(0x16b)][_0x3ec588(0x22f)]&&(this[_0x3ec588(0x2b5)]=setInterval(()=>{this['triggerEnergyPrediction']();},0xf*0x3c*0x3e8),setTimeout(()=>this[_0x3ec588(0x263)](),0x2710));if(this[_0x3ec588(0x2b3)])clearInterval(this[_0x3ec588(0x2b3)]);this[_0x3ec588(0x248)]['useCalendar']&&this['activeModules'][_0x3ec588(0x22f)]&&(this[_0x3ec588(0x2b3)]=setInterval(()=>{const _0x10ebbb=_0x3ec588;automation[_0x10ebbb(0x25a)](this);},0x2*0x3c*0x3e8),setTimeout(()=>automation[_0x3ec588(0x25a)](this),0x3a98));if(this[_0x3ec588(0x1be)])clearInterval(this[_0x3ec588(0x1be)]);this[_0x3ec588(0x248)][_0x3ec588(0x2b0)]&&this[_0x3ec588(0x248)][_0x3ec588(0x2b0)][_0x3ec588(0x1e0)]>0x0&&(this[_0x3ec588(0x1be)]=setInterval(async()=>{const _0x510302=_0x3ec588;await this[_0x510302(0x188)]();},0x3c*0x3e8),setTimeout(async()=>await this[_0x3ec588(0x188)](),0x1388));const _0x50b885=path[_0x3ec588(0x264)](__dirname,'.venv',_0x3ec588(0x228),_0x3ec588(0x2bd));pythonBridge[_0x3ec588(0x1b5)](this,_0x50b885);}[a0_0x6dfaba(0x16f)](_0x56c8f0){const _0x272a19=a0_0x6dfaba;if(this[_0x272a19(0x23a)])this[_0x272a19(0x23a)][_0x272a19(0x299)]();this['saveDailyHistory']()[_0x272a19(0x184)](()=>{const _0x4245b9=_0x272a19;if(this[_0x4245b9(0x2b5)])clearInterval(this[_0x4245b9(0x2b5)]);if(this[_0x4245b9(0x2b3)])clearInterval(this[_0x4245b9(0x2b3)]);if(this[_0x4245b9(0x1be)])clearInterval(this[_0x4245b9(0x1be)]);if(this[_0x4245b9(0x247)])clearInterval(this['roomIntegratorTimer']);recorder[_0x4245b9(0x261)](this),pythonBridge[_0x4245b9(0x211)](this),_0x56c8f0();});}async[a0_0x6dfaba(0x1ad)](){const _0x212fc7=a0_0x6dfaba;if(!this[_0x212fc7(0x1f1)]||this['eventHistory']['length']===0x0){this['log'][_0x212fc7(0x19b)](_0x212fc7(0x2a5));return;}this[_0x212fc7(0x17b)][_0x212fc7(0x2a1)](_0x212fc7(0x29e)+this[_0x212fc7(0x1f1)][_0x212fc7(0x1e0)]+_0x212fc7(0x213));const _0x4ce1c7=new Date()[_0x212fc7(0x24b)](0x0,0x0,0x0,0x0),_0x41c67c=_0x212fc7(0x258);let _0x42fa26={'history':{},'date':new Date()[_0x212fc7(0x230)]()};const _0x30b785=_0x212fc7(0x2b4),_0x5235a2=_0x212fc7(0x1ef);let _0x1ee699=new Array(0x30)['fill'](0x0),_0x286ef9=Array[_0x212fc7(0x2a6)]({'length':0x30},()=>[]);this[_0x212fc7(0x1f1)][_0x212fc7(0x18f)](_0x45296c=>{const _0x254b01=_0x212fc7;if(_0x45296c['timestamp']>=_0x4ce1c7){if(recorder[_0x254b01(0x226)](_0x45296c['type'],_0x45296c[_0x254b01(0x1a3)])){const _0xd98b6d=new Date(_0x45296c[_0x254b01(0x2c5)]),_0x332013=_0xd98b6d[_0x254b01(0x1bb)]()*0x2+(_0xd98b6d[_0x254b01(0x279)]()>=0x1e?0x1:0x0);if(_0x332013<0x30){_0x1ee699[_0x332013]++;const _0x4e21ed=_0x45296c['location']||_0x45296c['name']||'?';let _0x3e4b19=_0x286ef9[_0x332013];!_0x3e4b19['includes'](_0x4e21ed)&&_0x3e4b19['push'](_0x4e21ed);}const _0x157fb9=_0xd98b6d[_0x254b01(0x1bb)]();let _0x3e3797=_0x45296c[_0x254b01(0x20b)]||'Unknown';const _0x28c66e=(this[_0x254b01(0x248)]['devices']||[])[_0x254b01(0x195)](_0xfa6b9b=>_0xfa6b9b[_0x254b01(0x20b)]===_0x3e3797);if(_0x28c66e)_0x3e3797=_0x28c66e['location'];if(!_0x42fa26['history'][_0x3e3797])_0x42fa26['history'][_0x3e3797]=new Array(0x18)[_0x254b01(0x237)](0x0);if(_0x42fa26[_0x254b01(0x206)][_0x3e3797][_0x157fb9]<0x3c)_0x42fa26[_0x254b01(0x206)][_0x3e3797][_0x157fb9]++;}}});const _0x48bbe2=await this['getStateAsync'](_0x41c67c);(!_0x48bbe2||!_0x48bbe2[_0x212fc7(0x20e)]||_0x48bbe2['val']==='{}'||_0x48bbe2[_0x212fc7(0x20e)][_0x212fc7(0x224)](_0x212fc7(0x2d4)))&&await this[_0x212fc7(0x172)](_0x41c67c,{'val':JSON[_0x212fc7(0x2be)](_0x42fa26),'ack':!![]}),await this['setStateAsync'](_0x30b785,{'val':JSON[_0x212fc7(0x2be)](_0x1ee699),'ack':!![]}),await this[_0x212fc7(0x172)](_0x5235a2,{'val':JSON[_0x212fc7(0x2be)](_0x286ef9),'ack':!![]}),this[_0x212fc7(0x17b)]['info'](_0x212fc7(0x1e1));}async[a0_0x6dfaba(0x1d8)](){const _0x361d85=a0_0x6dfaba;if(!this['activeModules'][_0x361d85(0x25f)])return;const _0x220a14=new Date()['toISOString']()['split']('T')[0x0];this[_0x361d85(0x17b)][_0x361d85(0x23c)](_0x361d85(0x2bc)+_0x220a14+_0x361d85(0x222));try{const [_0x2442cb,_0x4cd850,_0x2945b3,_0x45009b,_0x12976c,_0x20581e,_0x2383b2]=await Promise[_0x361d85(0x1c7)]([this[_0x361d85(0x197)](_0x361d85(0x258)),this['getStateAsync'](_0x361d85(0x214)),this['getStateAsync']('analysis.health.geminiDay'),this[_0x361d85(0x197)]('analysis.security.lastScore'),this[_0x361d85(0x197)](_0x361d85(0x2b4)),this[_0x361d85(0x197)]('analysis.health.activityTrend'),this['getStateAsync']('analysis.health.gaitSpeed')]),_0x3389f4=new Date()[_0x361d85(0x24b)](0x0,0x0,0x0,0x0),_0x48c530=this[_0x361d85(0x1f1)][_0x361d85(0x16e)](_0x30270e=>_0x30270e[_0x361d85(0x2c5)]>=_0x3389f4&&(_0x30270e[_0x361d85(0x169)][_0x361d85(0x181)]()['includes'](_0x361d85(0x1d5))||_0x30270e[_0x361d85(0x169)][_0x361d85(0x181)]()[_0x361d85(0x224)](_0x361d85(0x192)))&&(_0x30270e[_0x361d85(0x1a3)]===!![]||_0x30270e[_0x361d85(0x1a3)]==='open'))[_0x361d85(0x1e0)];let _0x245b72=0x55;if(_0x20581e&&_0x20581e['val']!==undefined)_0x245b72=Math[_0x361d85(0x2a8)](0x64,Math['max'](0x14,Math[_0x361d85(0x29a)](0x50+Number(_0x20581e[_0x361d85(0x20e)])*0x5)));const _0x4edb53=this[_0x361d85(0x1f1)]['filter'](_0x2c0d1f=>_0x2c0d1f[_0x361d85(0x2c5)]>=_0x3389f4),_0x257941={'date':_0x220a14,'timestamp':Date[_0x361d85(0x19d)](),'roomHistory':_0x2442cb?.['val']?JSON[_0x361d85(0x2b1)](_0x2442cb[_0x361d85(0x20e)]):{},'geminiNight':_0x4cd850?.['val']||_0x361d85(0x196),'geminiDay':_0x2945b3?.[_0x361d85(0x20e)]||'Keine\x20Daten','anomalyScore':_0x45009b?.[_0x361d85(0x20e)]||0.1,'todayVector':_0x12976c?.[_0x361d85(0x20e)]?JSON[_0x361d85(0x2b1)](_0x12976c[_0x361d85(0x20e)]):new Array(0x30)[_0x361d85(0x237)](0x0),'batteryLevel':_0x245b72,'freshAirCount':_0x48c530,'gaitSpeed':_0x2383b2?.[_0x361d85(0x20e)]!==undefined&&_0x2383b2?.[_0x361d85(0x20e)]!==null?Number(_0x2383b2[_0x361d85(0x20e)]):null,'eventHistory':_0x4edb53},_0x56f0e5=utils[_0x361d85(0x27f)](),_0x38e539=path[_0x361d85(0x264)](_0x56f0e5,_0x361d85(0x1b1),'history');if(!fs[_0x361d85(0x174)](_0x38e539))fs['mkdirSync'](_0x38e539,{'recursive':!![]});const _0x359b9e=path[_0x361d85(0x264)](_0x38e539,_0x220a14+_0x361d85(0x204));fs['writeFileSync'](_0x359b9e,JSON[_0x361d85(0x2be)](_0x257941)),this[_0x361d85(0x17b)][_0x361d85(0x2a1)]('‚úÖ\x20History\x20saved:\x20'+_0x359b9e);}catch(_0x21c1e0){this[_0x361d85(0x17b)][_0x361d85(0x202)]('History\x20Save\x20Error:\x20'+_0x21c1e0['message']);}}async[a0_0x6dfaba(0x1c5)](){const _0x88b35e=a0_0x6dfaba;if(!this['isPresent'])return;try{let _0x2c3855=null;try{const _0x22e2e3=await this['getStateAsync'](_0x88b35e(0x1fc)),_0x4a65aa=await this[_0x88b35e(0x197)](_0x88b35e(0x19f));if(_0x22e2e3&&_0x22e2e3['val']&&_0x4a65aa&&_0x4a65aa[_0x88b35e(0x20e)]&&_0x4a65aa[_0x88b35e(0x20e)]>0.3){if(_0x22e2e3['val']!=='Unknown'&&_0x22e2e3[_0x88b35e(0x20e)]!=='Init...')_0x2c3855=_0x22e2e3[_0x88b35e(0x20e)];}}catch(_0x85581b){}if(!_0x2c3855){const _0x550d12=this[_0x88b35e(0x248)][_0x88b35e(0x1a4)]||[];for(const _0x35ecfb of _0x550d12){if(_0x35ecfb['type']===_0x88b35e(0x251)&&_0x35ecfb[_0x88b35e(0x20b)])try{const _0x3d9a61=await this[_0x88b35e(0x17c)](_0x35ecfb['id']);if(_0x3d9a61&&(_0x3d9a61['val']===!![]||_0x3d9a61['val']==='on'||_0x3d9a61[_0x88b35e(0x20e)]===0x1)){_0x2c3855=_0x35ecfb[_0x88b35e(0x20b)];break;}}catch(_0x275bbf){}}}if(!_0x2c3855)return;const _0x487bed=this[_0x88b35e(0x248)][_0x88b35e(0x1a4)]||[];let _0x3e5884=_0x2c3855;const _0x428320=_0x487bed[_0x88b35e(0x195)](_0x3318d2=>_0x3318d2[_0x88b35e(0x20b)]&&_0x3318d2[_0x88b35e(0x20b)][_0x88b35e(0x181)]()===_0x2c3855[_0x88b35e(0x181)]());if(_0x428320)_0x3e5884=_0x428320['location'];const _0x30a57a=_0x88b35e(0x258),_0x405119=await this[_0x88b35e(0x197)](_0x30a57a),_0x52a996=new Date()[_0x88b35e(0x230)]();let _0x485abc={'history':{},'date':_0x52a996};if(_0x405119&&_0x405119[_0x88b35e(0x20e)])try{_0x485abc=JSON[_0x88b35e(0x2b1)](_0x405119[_0x88b35e(0x20e)]);}catch(_0x261aac){}_0x485abc[_0x88b35e(0x29b)]!==_0x52a996&&(_0x485abc[_0x88b35e(0x206)]={},_0x485abc[_0x88b35e(0x29b)]=_0x52a996);if(!_0x485abc[_0x88b35e(0x206)][_0x3e5884])_0x485abc[_0x88b35e(0x206)][_0x3e5884]=new Array(0x18)[_0x88b35e(0x237)](0x0);const _0x598551=new Date()['getHours']();if(_0x485abc[_0x88b35e(0x206)][_0x3e5884][_0x598551]<0x3c)_0x485abc[_0x88b35e(0x206)][_0x3e5884][_0x598551]++;await this[_0x88b35e(0x172)](_0x30a57a,{'val':JSON['stringify'](_0x485abc),'ack':!![]});}catch(_0x1b18f2){this[_0x88b35e(0x17b)][_0x88b35e(0x19b)]('[Integrator]\x20Error:\x20'+_0x1b18f2[_0x88b35e(0x2c0)]);}}async[a0_0x6dfaba(0x21c)](_0x2d490b){const _0x478b55=a0_0x6dfaba;if(typeof _0x2d490b===_0x478b55(0x22d)&&_0x2d490b[_0x478b55(0x2c0)]){if(_0x2d490b[_0x478b55(0x257)]===_0x478b55(0x1f9)){const _0x4e7571=_0x2d490b[_0x478b55(0x2c0)]['date'],_0x4a54da=utils['getAbsoluteDefaultDataDir'](),_0x1f2386=path[_0x478b55(0x264)](_0x4a54da,_0x478b55(0x1b1),_0x478b55(0x206),_0x4e7571+_0x478b55(0x204));if(fs[_0x478b55(0x174)](_0x1f2386))try{const _0x4e6de4=JSON['parse'](fs['readFileSync'](_0x1f2386,_0x478b55(0x290)));this['sendTo'](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'success':!![],'data':_0x4e6de4},_0x2d490b[_0x478b55(0x194)]);}catch(_0x49e444){this['sendTo'](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'success':![],'error':_0x478b55(0x234)},_0x2d490b['callback']);}else this[_0x478b55(0x2a4)](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'success':![],'error':_0x478b55(0x255)},_0x2d490b['callback']);}else{if(_0x2d490b[_0x478b55(0x257)]===_0x478b55(0x1eb)){const _0x12597f=this['dailyDigests'][_0x478b55(0x1e0)];let _0x3f76a4=new Array(0x30)['fill'](0x0),_0x49fab8=Array['from']({'length':0x30},()=>[]);try{const _0x37b223=await this['getStateAsync']('analysis.health.todayVector');if(_0x37b223&&_0x37b223[_0x478b55(0x20e)])_0x3f76a4=JSON[_0x478b55(0x2b1)](_0x37b223[_0x478b55(0x20e)]);const _0x8fde86=await this[_0x478b55(0x197)]('analysis.health.todayRoomDetails');if(_0x8fde86&&_0x8fde86['val'])_0x49fab8=JSON['parse'](_0x8fde86[_0x478b55(0x20e)]);}catch(_0x5566af){}let _0x14f4fd=new Array(0x30)['fill'](0x0);try{const _0x37b4d4=new Date();_0x37b4d4[_0x478b55(0x21e)](_0x37b4d4[_0x478b55(0x293)]()-0x1);const _0xda43e8=_0x37b4d4['toISOString']()[_0x478b55(0x183)]('T')[0x0],_0x206df9=utils[_0x478b55(0x27f)](),_0x3fcb05=path['join'](_0x206df9,_0x478b55(0x1b1),_0x478b55(0x206),_0xda43e8+'.json');if(fs[_0x478b55(0x174)](_0x3fcb05)){const _0x412ee5=JSON[_0x478b55(0x2b1)](fs[_0x478b55(0x242)](_0x3fcb05,_0x478b55(0x290)));if(_0x412ee5&&_0x412ee5[_0x478b55(0x1a7)])_0x14f4fd=_0x412ee5[_0x478b55(0x1a7)];}}catch(_0xf5a33d){}let _0x3e7382={'today':{},'yesterday':{}};try{const _0x53035b=await this['getStateAsync'](_0x478b55(0x250));if(_0x53035b&&_0x53035b[_0x478b55(0x20e)])_0x3e7382=JSON[_0x478b55(0x2b1)](_0x53035b[_0x478b55(0x20e)]);}catch(_0x28830b){}let _0x47a771=null;try{const _0x21f872=await this[_0x478b55(0x197)]('analysis.health.activityTrend');if(_0x21f872)_0x47a771=_0x21f872[_0x478b55(0x20e)];}catch(_0xeccb8f){}if(_0x47a771===undefined||_0x47a771===null){const _0x4758e0=_0x3f76a4[_0x478b55(0x295)]((_0x1040b7,_0x3fe625)=>_0x1040b7+_0x3fe625,0x0),_0x238179=Math[_0x478b55(0x2a8)](0x2,Math[_0x478b55(0x176)](-0x2,(0x64-_0x4758e0)/0x32));_0x47a771=_0x238179;}let _0x206440=![],_0xb721a7='',_0x1a04fd='',_0x118807='';try{const _0x32f895=await this[_0x478b55(0x197)]('analysis.automation.patternDetected');if(_0x32f895&&_0x32f895[_0x478b55(0x20e)]){_0x206440=!![];const _0x4e4754=await this[_0x478b55(0x197)](_0x478b55(0x29f));_0xb721a7=_0x4e4754?_0x4e4754['val']:'';const _0x55b3ef=await this['getStateAsync'](_0x478b55(0x2d0));_0x1a04fd=_0x55b3ef?_0x55b3ef[_0x478b55(0x20e)]:'';const _0x298e84=await this[_0x478b55(0x197)]('analysis.automation.targetValue');_0x118807=_0x298e84?_0x298e84[_0x478b55(0x20e)]:'';}}catch(_0x2e1775){}const _0x4c6d69=await this[_0x478b55(0x173)](),_0x485610=(this['config'][_0x478b55(0x1a4)]||[])[_0x478b55(0x2d1)](_0x327a1c=>_0x327a1c[_0x478b55(0x1b4)]),_0x52ebf2=_0x4c6d69&&_0x485610;let _0x4426f9='';try{const _0x1ebb53=await this[_0x478b55(0x197)](_0x478b55(0x1d3));if(_0x1ebb53&&_0x1ebb53[_0x478b55(0x20e)])_0x4426f9=_0x1ebb53['val'];}catch(_0x346acd){}this[_0x478b55(0x2a4)](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'success':!![],'eventHistory':this[_0x478b55(0x1f1)][_0x478b55(0x200)](0x0,0x7d0),'stats':{'digestCount':_0x12597f,'isPresent':this[_0x478b55(0x167)],'hourlyActivity':_0x3f76a4,'hourlyDetails':_0x49fab8,'yesterdayActivity':_0x14f4fd,'solarActive':_0x52ebf2,'presenceWho':_0x4426f9,'roomStats':_0x3e7382,'activityTrend':_0x47a771,'modules':this[_0x478b55(0x16b)]},'automation':{'detected':_0x206440,'description':_0xb721a7,'targetId':_0x1a04fd,'targetValue':_0x118807}},_0x2d490b[_0x478b55(0x194)]);}else{if(_0x2d490b[_0x478b55(0x257)]===_0x478b55(0x2b8))try{const _0x44e06b=await automation[_0x478b55(0x1cb)](this);this[_0x478b55(0x2a4)](_0x2d490b['from'],_0x2d490b['command'],{'success':!![],'results':_0x44e06b},_0x2d490b[_0x478b55(0x194)]);}catch(_0x265087){this[_0x478b55(0x2a4)](_0x2d490b['from'],_0x2d490b[_0x478b55(0x257)],{'success':![],'error':_0x265087['message']},_0x2d490b[_0x478b55(0x194)]);}else{if(_0x2d490b[_0x478b55(0x257)]===_0x478b55(0x1c8))try{const _0x1bc0a0=await scanner['scanForDevices'](this,_0x2d490b[_0x478b55(0x2c0)]||{});this['sendTo'](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'success':!![],'devices':_0x1bc0a0},_0x2d490b['callback']);}catch(_0x58442e){}else{if(_0x2d490b[_0x478b55(0x257)]==='getEnums'){const _0x24eafb=await this['getForeignObjectsAsync'](_0x478b55(0x187),_0x478b55(0x198)),_0x26eed3=[];if(_0x24eafb)for(const _0x3fb5a1 in _0x24eafb){let _0x396ee2=_0x24eafb[_0x3fb5a1]['common'][_0x478b55(0x169)];if(_0x396ee2&&typeof _0x396ee2==='object')_0x396ee2=_0x396ee2['de']||_0x396ee2['en']||Object[_0x478b55(0x241)](_0x396ee2)[0x0]||JSON[_0x478b55(0x2be)](_0x396ee2);_0x26eed3['push']({'id':_0x3fb5a1,'name':String(_0x396ee2||_0x3fb5a1)});}const _0x2512c7=await this[_0x478b55(0x1e3)](_0x478b55(0x16c),_0x478b55(0x198)),_0x170fb8=[];if(_0x2512c7)for(const _0x9ee8ab in _0x2512c7){let _0x337858=_0x2512c7[_0x9ee8ab]['common'][_0x478b55(0x169)];if(_0x337858&&typeof _0x337858==='object')_0x337858=_0x337858['de']||_0x337858['en']||Object[_0x478b55(0x241)](_0x337858)[0x0]||JSON['stringify'](_0x337858);_0x170fb8[_0x478b55(0x27b)](String(_0x337858||_0x9ee8ab[_0x478b55(0x183)]('.')['pop']()));}this[_0x478b55(0x2a4)](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'success':!![],'enums':_0x26eed3,'rooms':_0x170fb8},_0x2d490b[_0x478b55(0x194)]);}else{if(_0x2d490b[_0x478b55(0x257)]==='getCalendarNames')try{const _0x4ef1b1=await this[_0x478b55(0x1b9)]('system',_0x478b55(0x24f),{'startkey':_0x478b55(0x281),'endkey':_0x478b55(0x22c)}),_0x5e527f=new Set();if(_0x4ef1b1&&_0x4ef1b1[_0x478b55(0x1f3)])for(const _0x37edc7 of _0x4ef1b1[_0x478b55(0x1f3)]){const _0x2eb1c3=_0x37edc7['id'][_0x478b55(0x272)]('system.adapter.',''),_0x13ae40=await this[_0x478b55(0x17c)](_0x2eb1c3+_0x478b55(0x1aa));let _0x175e1f=![];if(_0x13ae40&&_0x13ae40[_0x478b55(0x20e)]){const _0x2d137e=typeof _0x13ae40['val']===_0x478b55(0x1e5)?JSON[_0x478b55(0x2b1)](_0x13ae40['val']):_0x13ae40[_0x478b55(0x20e)];Array[_0x478b55(0x2c7)](_0x2d137e)&&_0x2d137e[_0x478b55(0x18f)](_0x12ab90=>{const _0x15a546=_0x478b55;_0x12ab90['calendarName']&&(_0x5e527f[_0x15a546(0x20a)](_0x12ab90[_0x15a546(0x1f6)]),_0x175e1f=!![]);});}!_0x175e1f&&_0x5e527f['add'](_0x2eb1c3);}const _0x3793a1=Array[_0x478b55(0x2a6)](_0x5e527f);if(_0x3793a1['length']===0x0)_0x3793a1[_0x478b55(0x27b)](_0x478b55(0x221));this[_0x478b55(0x2a4)](_0x2d490b['from'],_0x2d490b[_0x478b55(0x257)],{'success':!![],'names':_0x3793a1},_0x2d490b[_0x478b55(0x194)]);}catch(_0x1ed4b9){this['sendTo'](_0x2d490b['from'],_0x2d490b[_0x478b55(0x257)],{'success':![],'error':_0x478b55(0x1b0)+_0x1ed4b9[_0x478b55(0x2c0)]},_0x2d490b[_0x478b55(0x194)]);}else{if(_0x2d490b[_0x478b55(0x257)]==='refreshCalendar')try{await automation[_0x478b55(0x246)](this),this[_0x478b55(0x2a4)](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'success':!![]},_0x2d490b[_0x478b55(0x194)]);}catch(_0x1e9bcd){this[_0x478b55(0x17b)]['warn']('refreshCalendar\x20failed:\x20'+_0x1e9bcd[_0x478b55(0x2c0)]),this[_0x478b55(0x2a4)](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'success':![],'error':_0x1e9bcd[_0x478b55(0x2c0)]},_0x2d490b[_0x478b55(0x194)]);}else{if(_0x2d490b[_0x478b55(0x257)]==='updateTopologyMatrix')try{const _0x4e278c=_0x2d490b[_0x478b55(0x2c0)]['matrix'];if(!_0x4e278c||!Array[_0x478b55(0x2c7)](_0x4e278c))throw new Error(_0x478b55(0x1dc));const _0x2a8854=await this[_0x478b55(0x197)]('analysis.topology.structure');if(_0x2a8854&&_0x2a8854[_0x478b55(0x20e)]){const _0xeb6bb2=JSON[_0x478b55(0x2b1)](_0x2a8854[_0x478b55(0x20e)]);_0xeb6bb2[_0x478b55(0x212)]=_0x4e278c,_0xeb6bb2[_0x478b55(0x236)]=Date[_0x478b55(0x19d)](),await this[_0x478b55(0x172)](_0x478b55(0x1f4),{'val':JSON[_0x478b55(0x2be)](_0xeb6bb2),'ack':!![]}),this[_0x478b55(0x17b)]['debug'](_0x478b55(0x185)),this[_0x478b55(0x2a4)](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'success':!![]},_0x2d490b[_0x478b55(0x194)]);}else throw new Error(_0x478b55(0x16a));}catch(_0xfea3a){this['log'][_0x478b55(0x19b)]('updateTopologyMatrix\x20failed:\x20'+_0xfea3a[_0x478b55(0x2c0)]),this['sendTo'](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'success':![],'error':_0xfea3a[_0x478b55(0x2c0)]},_0x2d490b['callback']);}else{if(_0x2d490b['command']===_0x478b55(0x1fe))try{const _0x36f910=_0x2d490b[_0x478b55(0x2c0)][_0x478b55(0x257)],_0x543372=_0x2d490b['message'];this[_0x478b55(0x17b)][_0x478b55(0x23c)]('[PythonBridge]\x20Forwarding\x20command:\x20'+_0x36f910),pythonBridge[_0x478b55(0x2a2)](this,_0x36f910,_0x543372,_0x25896c=>{const _0x47dc8d=_0x478b55;this['sendTo'](_0x2d490b[_0x47dc8d(0x2a6)],_0x2d490b['command'],_0x25896c,_0x2d490b[_0x47dc8d(0x194)]);});}catch(_0x1e72f0){this['log'][_0x478b55(0x19b)]('pythonBridge\x20command\x20failed:\x20'+_0x1e72f0[_0x478b55(0x2c0)]),this['sendTo'](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'type':_0x478b55(0x22e),'payload':_0x1e72f0['message']},_0x2d490b['callback']);}else{if(_0x2d490b['command']===_0x478b55(0x253))try{const _0xda4038=_0x2d490b[_0x478b55(0x2c0)]?_0x2d490b['message']['apiKey']:'';if(!_0xda4038)throw new Error(_0x478b55(0x273));const _0x27f0f1=new GoogleGenerativeAI(_0xda4038),_0x1b4299=_0x27f0f1[_0x478b55(0x26b)]({'model':GEMINI_MODEL}),_0x4ffb72=await _0x1b4299['generateContent'](_0x478b55(0x223)),_0x38e728=await _0x4ffb72[_0x478b55(0x1cd)],_0x324947=_0x38e728['text']();this[_0x478b55(0x2a4)](_0x2d490b['from'],_0x2d490b[_0x478b55(0x257)],{'success':!![],'message':'Verbindung\x20erfolgreich:\x20'+_0x324947[_0x478b55(0x269)](0x0,0x14)+_0x478b55(0x222)},_0x2d490b[_0x478b55(0x194)]);}catch(_0x1d3173){this[_0x478b55(0x2a4)](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'success':![],'message':_0x1d3173[_0x478b55(0x2c0)]},_0x2d490b[_0x478b55(0x194)]);}else{if(_0x2d490b['command']===_0x478b55(0x1c1))try{const _0x59a555=await this[_0x478b55(0x173)](),_0x2e3336=await this[_0x478b55(0x1b9)](_0x478b55(0x1c6),_0x478b55(0x24f),{'startkey':_0x478b55(0x281),'endkey':'system.adapter.ical.È¶ô'}),_0x575b88=_0x2e3336&&_0x2e3336['rows']?_0x2e3336[_0x478b55(0x1f3)][_0x478b55(0x1e0)]:0x0;this[_0x478b55(0x2a4)](_0x2d490b[_0x478b55(0x2a6)],_0x2d490b[_0x478b55(0x257)],{'success':!![],'weather':'Sonne:\x20'+_0x59a555+_0x478b55(0x1c0)+(this[_0x478b55(0x27e)][this[_0x478b55(0x248)][_0x478b55(0x2ce)]]||'?')+'¬∞C','calendar':_0x575b88+_0x478b55(0x227)},_0x2d490b['callback']);}catch(_0x2c4fed){this['sendTo'](_0x2d490b['from'],_0x2d490b[_0x478b55(0x257)],{'success':![]},_0x2d490b[_0x478b55(0x194)]);}}}}}}}}}}}}}['runPythonHealthCheck'](){const _0x546693=a0_0x6dfaba;if(!this[_0x546693(0x16b)][_0x546693(0x25f)])return;this['log'][_0x546693(0x23c)](_0x546693(0x26a));try{const _0x30c75c=this[_0x546693(0x2cd)]||[];pythonBridge[_0x546693(0x2a2)](this,_0x546693(0x278),{'events':_0x30c75c});}catch(_0x41a755){this[_0x546693(0x17b)][_0x546693(0x19b)](_0x546693(0x1cf));}}async[a0_0x6dfaba(0x2c9)](_0x3260c9,_0x339d4a){const _0x5a687d=a0_0x6dfaba;if(!_0x339d4a||this[_0x5a687d(0x18e)])return;if(_0x3260c9['includes']('telegram')&&_0x3260c9[_0x5a687d(0x27c)]('communicate.request')&&_0x339d4a[_0x5a687d(0x20e)])return;if(this[_0x5a687d(0x248)]['infrasoundEnabled']&&_0x3260c9===this[_0x5a687d(0x248)][_0x5a687d(0x207)]&&this[_0x5a687d(0x16b)][_0x5a687d(0x296)]){this[_0x5a687d(0x20f)](_0x339d4a[_0x5a687d(0x20e)]);return;}if(_0x339d4a[_0x5a687d(0x2d5)]&&_0x3260c9[_0x5a687d(0x27c)](_0x5a687d(0x28e)))return;if(_0x3260c9===this[_0x5a687d(0x28a)]+_0x5a687d(0x26c)){if(_0x339d4a[_0x5a687d(0x20e)]&&Object['values'](setup['SYSTEM_MODES'])['includes'](_0x339d4a[_0x5a687d(0x20e)])){this['currentSystemMode']=_0x339d4a[_0x5a687d(0x20e)];if(_0x339d4a['val']===setup[_0x5a687d(0x229)]['VACATION'])await recorder[_0x5a687d(0x2b9)](this,![]);else await recorder[_0x5a687d(0x2b9)](this,!![]);if(this[_0x5a687d(0x1d4)]){let _0x2d6fe5=![],_0x33e997=0x0,_0x516b60=_0x5a687d(0x1b6);if(this['currentSystemMode']===_0x5a687d(0x2c2))_0x2d6fe5=!![],_0x33e997=0x168,_0x516b60=_0x5a687d(0x1d1);else this['currentSystemMode']==='guest'&&(_0x2d6fe5=!![],_0x33e997=0x5a0,_0x516b60=_0x5a687d(0x1f8));pythonBridge[_0x5a687d(0x2a2)](this,_0x5a687d(0x27d),{'active':_0x2d6fe5,'duration':_0x33e997,'label':_0x516b60}),await this[_0x5a687d(0x172)](_0x5a687d(0x2cb),{'val':JSON['stringify']({'active':_0x2d6fe5,'label':_0x516b60,'timestamp':Date[_0x5a687d(0x19d)]()}),'ack':!![]});}}if(!_0x339d4a[_0x5a687d(0x2d5)])this[_0x5a687d(0x285)](_0x3260c9,{'val':this[_0x5a687d(0x1da)],'ack':!![]});return;}if(_0x3260c9[_0x5a687d(0x27c)](_0x5a687d(0x177))&&_0x339d4a[_0x5a687d(0x2d5)])this[_0x5a687d(0x2cc)](_0x339d4a[_0x5a687d(0x20e)]);if(_0x3260c9[_0x5a687d(0x27c)]('analysis.energy.warmupTimes')&&_0x339d4a[_0x5a687d(0x2d5)]&&this[_0x5a687d(0x16b)][_0x5a687d(0x22f)])automation[_0x5a687d(0x25a)](this);if(!_0x339d4a[_0x5a687d(0x2d5)]){if(_0x3260c9['includes'](_0x5a687d(0x179))&&_0x339d4a[_0x5a687d(0x20e)]){this['setState'](_0x3260c9,{'val':![],'ack':!![]}),aiAgent[_0x5a687d(0x189)](this);return;}if(_0x3260c9[_0x5a687d(0x224)](_0x5a687d(0x1ab))&&_0x339d4a[_0x5a687d(0x20e)]){this[_0x5a687d(0x285)](_0x3260c9,{'val':![],'ack':!![]});if(this[_0x5a687d(0x1d4)])aiAgent[_0x5a687d(0x180)](this,pythonBridge);return;}if(_0x3260c9[_0x5a687d(0x224)](_0x5a687d(0x17e))&&_0x339d4a[_0x5a687d(0x20e)]){this[_0x5a687d(0x285)](_0x3260c9,{'val':![],'ack':!![]}),aiAgent[_0x5a687d(0x191)](this);return;}if(_0x3260c9['includes'](_0x5a687d(0x1c2))&&_0x339d4a[_0x5a687d(0x20e)]){this[_0x5a687d(0x285)](_0x3260c9,{'val':![],'ack':!![]}),aiAgent['executeAutomationAction'](this);return;}if(_0x3260c9[_0x5a687d(0x224)](_0x5a687d(0x18a))&&_0x339d4a[_0x5a687d(0x20e)]){this[_0x5a687d(0x285)](_0x3260c9,{'val':![],'ack':!![]});if(this[_0x5a687d(0x1d4)])try{const _0x2f65e3=await this[_0x5a687d(0x197)](_0x5a687d(0x199));if(_0x2f65e3&&_0x2f65e3[_0x5a687d(0x20e)]){const _0x354956=JSON[_0x5a687d(0x2b1)](_0x2f65e3['val']);this[_0x5a687d(0x172)](_0x5a687d(0x268),{'val':_0x5a687d(0x286),'ack':!![]}),pythonBridge[_0x5a687d(0x2a2)](this,'TRAIN_SECURITY',{'sequences':_0x354956});}}catch(_0xcd1bb){}return;}if(_0x3260c9[_0x5a687d(0x224)]('analysis.training.triggerHealth')&&_0x339d4a[_0x5a687d(0x20e)]){this[_0x5a687d(0x285)](_0x3260c9,{'val':![],'ack':!![]});try{aiAgent[_0x5a687d(0x235)](this,_0x5a687d(0x1c3)),setTimeout(()=>aiAgent[_0x5a687d(0x235)](this,_0x5a687d(0x1f7)),0x2ee0);if(this[_0x5a687d(0x1d4)]){this['runPythonHealthCheck']();const _0x39b76b=await this[_0x5a687d(0x197)]('LTM.dailyDigests');if(_0x39b76b&&_0x39b76b[_0x5a687d(0x20e)])pythonBridge[_0x5a687d(0x2a2)](this,_0x5a687d(0x182),{'digests':JSON[_0x5a687d(0x2b1)](_0x39b76b[_0x5a687d(0x20e)])});}}catch(_0x9954a8){this[_0x5a687d(0x17b)][_0x5a687d(0x19b)]('triggerHealth\x20error:\x20'+_0x9954a8[_0x5a687d(0x2c0)]);}return;}if(_0x3260c9['includes'](_0x5a687d(0x1ff))&&_0x339d4a[_0x5a687d(0x20e)]){this[_0x5a687d(0x285)](_0x3260c9,{'val':![],'ack':!![]}),await this[_0x5a687d(0x263)]();return;}if(_0x3260c9[_0x5a687d(0x224)](_0x5a687d(0x17f))&&_0x339d4a['val']){this[_0x5a687d(0x285)](_0x3260c9,{'val':![],'ack':!![]});if(this[_0x5a687d(0x1d4)])try{const _0x3bc984=await this[_0x5a687d(0x197)](_0x5a687d(0x1f2));if(_0x3bc984&&_0x3bc984['val']){const _0x44e9c9={};if(this[_0x5a687d(0x248)][_0x5a687d(0x1a4)])this[_0x5a687d(0x248)][_0x5a687d(0x1a4)]['forEach'](_0x1428a7=>{if(_0x1428a7['id']&&_0x1428a7['type'])_0x44e9c9[_0x1428a7['id']]=_0x1428a7['type'];});pythonBridge[_0x5a687d(0x2a2)](this,_0x5a687d(0x2b2),{'events':JSON[_0x5a687d(0x2b1)](_0x3bc984[_0x5a687d(0x20e)]),'deviceMap':_0x44e9c9});}}catch(_0x4a66ec){}return;}if(_0x3260c9[_0x5a687d(0x224)]('analysis.training.triggerTopology')&&_0x339d4a[_0x5a687d(0x20e)]){this['setState'](_0x3260c9,{'val':![],'ack':!![]}),topology[_0x5a687d(0x1d2)](this);if(this[_0x5a687d(0x1d4)])try{const _0x1b3574=await this[_0x5a687d(0x197)]('LTM.trainingData.sequences');if(_0x1b3574&&_0x1b3574[_0x5a687d(0x20e)])pythonBridge[_0x5a687d(0x2a2)](this,'TRAIN_TOPOLOGY',{'sequences':JSON[_0x5a687d(0x2b1)](_0x1b3574[_0x5a687d(0x20e)])});}catch(_0xb11360){}return;}}const _0x51c6e0=(this[_0x5a687d(0x248)][_0x5a687d(0x1a4)]||[])[_0x5a687d(0x195)](_0x4c44d3=>_0x4c44d3['id']===_0x3260c9);if(_0x51c6e0){const _0x2e2f14=await recorder[_0x5a687d(0x1b7)](this,_0x3260c9,_0x339d4a,_0x51c6e0);_0x2e2f14&&this[_0x5a687d(0x285)](_0x5a687d(0x23f),{'val':Date['now'](),'ack':!![]});_0x2e2f14&&_0x2e2f14['type']===_0x5a687d(0x251)&&_0x2e2f14[_0x5a687d(0x20b)]&&this[_0x5a687d(0x1d4)]&&deadMan[_0x5a687d(0x2bf)](this,_0x2e2f14[_0x5a687d(0x20b)]);_0x339d4a[_0x5a687d(0x20e)]&&(_0x339d4a[_0x5a687d(0x20e)]===!![]||_0x339d4a[_0x5a687d(0x20e)]===0x1||String(_0x339d4a[_0x5a687d(0x20e)])['toLowerCase']()===_0x5a687d(0x1a2))&&(_0x51c6e0[_0x5a687d(0x216)]&&(_0x51c6e0[_0x5a687d(0x216)][_0x5a687d(0x224)](_0x5a687d(0x2d3))||_0x51c6e0['type'][_0x5a687d(0x224)](_0x5a687d(0x2a3)))&&this[_0x5a687d(0x265)](_0x51c6e0));if(_0x51c6e0[_0x5a687d(0x216)]===_0x5a687d(0x1d0)||_0x51c6e0[_0x5a687d(0x216)]==='thermostat'){if(this['activeModules'][_0x5a687d(0x22f)])automation['cleanupGhostInterventions'](this);}}}async[a0_0x6dfaba(0x2cc)](_0x4f8e7c){const _0x39e92c=a0_0x6dfaba;if(!this[_0x39e92c(0x19c)]||Date[_0x39e92c(0x19d)]()-this[_0x39e92c(0x1c4)]>0x493e0)return;try{const _0x474670=JSON[_0x39e92c(0x2b1)](_0x4f8e7c),_0x3802f4=this[_0x39e92c(0x19c)]['sources'];let _0x64e69=![];for(const _0x16153c in _0x3802f4){if(_0x3802f4[_0x16153c][_0x39e92c(0x224)]('AI')&&_0x474670[_0x16153c]&&!_0x474670[_0x16153c]['includes']('AI')){_0x64e69=!![];break;}}_0x64e69&&(await this[_0x39e92c(0x172)](_0x39e92c(0x240),{'val':JSON[_0x39e92c(0x2be)](this[_0x39e92c(0x19c)][_0x39e92c(0x283)]),'ack':!![]}),await this[_0x39e92c(0x172)]('analysis.energy.warmupSources',{'val':JSON['stringify'](this['memoryCache'][_0x39e92c(0x1a5)]),'ack':!![]}));}catch(_0x30d740){}}async[a0_0x6dfaba(0x25e)](){const _0x26271b=a0_0x6dfaba;try{const _0x3dcb3d=await this['getStateAsync'](setup[_0x26271b(0x23d)]);if(_0x3dcb3d&&_0x3dcb3d['val'])this['currentSystemMode']=_0x3dcb3d[_0x26271b(0x20e)];}catch(_0x4f2dc8){this[_0x26271b(0x1da)]=setup[_0x26271b(0x229)][_0x26271b(0x239)];}}async[a0_0x6dfaba(0x188)](){const _0x5a9220=a0_0x6dfaba,_0x5e3b42=this['config'][_0x5a9220(0x2b0)]||[];if(_0x5e3b42[_0x5a9220(0x1e0)]===0x0)return![];const _0x1e1c23=[],_0x14ea7f=Date[_0x5a9220(0x19d)](),_0x1ee983=0x5*0x3c*0x3e8;for(const _0x9bdab2 of _0x5e3b42){try{let _0x453a12=![];try{const _0x107b5b=await this[_0x5a9220(0x17c)](_0x9bdab2+_0x5a9220(0x24a));if(_0x107b5b&&_0x107b5b['val']===!![])_0x453a12=!![];}catch(_0x56fe38){}if(!_0x453a12)try{const _0x44e9c0=await this[_0x5a9220(0x17c)](_0x9bdab2+_0x5a9220(0x280));if(_0x44e9c0&&_0x44e9c0['ts']){const _0x284362=_0x14ea7f-_0x44e9c0['ts'];if(_0x284362<_0x1ee983)_0x453a12=!![];}}catch(_0x4d224f){}if(!_0x453a12)try{const _0x6478c4=await this['getForeignStateAsync'](_0x9bdab2+_0x5a9220(0x2ac));if(_0x6478c4&&typeof _0x6478c4[_0x5a9220(0x20e)]===_0x5a9220(0x21b)&&_0x6478c4[_0x5a9220(0x20e)]>0x0)_0x453a12=!![];}catch(_0x5af5c1){}if(!_0x453a12)try{const _0x51b365=await this['getForeignStateAsync'](_0x9bdab2);if(_0x51b365){const _0x239eb3=_0x14ea7f-(_0x51b365['ts']||0x0);_0x239eb3<_0x1ee983&&(_0x51b365[_0x5a9220(0x20e)]===!![]||_0x51b365[_0x5a9220(0x20e)]===_0x5a9220(0x259)||_0x51b365['val']===0x1)&&(_0x453a12=!![]);}}catch(_0x53efec){}if(_0x453a12){const _0x456f00=_0x9bdab2['split']('.'),_0xa796e7=_0x456f00[_0x456f00[_0x5a9220(0x1e0)]-0x1]||_0x9bdab2;_0x1e1c23[_0x5a9220(0x27b)](_0xa796e7);}}catch(_0x52cdfd){this['log'][_0x5a9220(0x19b)]('checkWifiPresence:\x20Error\x20checking\x20'+_0x9bdab2+':\x20'+_0x52cdfd['message']);}}const _0x22d4eb=_0x1e1c23['length']>0x0?_0x1e1c23[_0x5a9220(0x264)](',\x20'):'Niemand';return await this[_0x5a9220(0x172)](_0x5a9220(0x1d3),{'val':_0x22d4eb,'ack':!![]}),_0x1e1c23[_0x5a9220(0x1e0)]>0x0;}async['runAutopilot'](){const _0xe667b8=a0_0x6dfaba;await aiAgent[_0xe667b8(0x189)](this);this[_0xe667b8(0x16b)][_0xe667b8(0x25f)]&&(this[_0xe667b8(0x210)](),this[_0xe667b8(0x289)]());if(this[_0xe667b8(0x16b)][_0xe667b8(0x22f)])this[_0xe667b8(0x263)]();}async[a0_0x6dfaba(0x173)](){const _0x59c06b=a0_0x6dfaba,_0x55df0c=[_0x59c06b(0x2ad),_0x59c06b(0x2af),'daswetter.0'],_0x5c8a78=[_0x59c06b(0x19a),'Current.WeatherText','NextHours.Location_1.Day_1.current.symbol_desc'];for(const _0x500a92 of _0x55df0c){for(const _0x8667fb of _0x5c8a78){try{const _0xd387c7=_0x500a92+'.'+_0x8667fb,_0x2af058=await this[_0x59c06b(0x17c)](_0xd387c7);if(_0x2af058&&_0x2af058[_0x59c06b(0x20e)]){const _0x1cf279=String(_0x2af058[_0x59c06b(0x20e)])[_0x59c06b(0x181)]();if(_0x1cf279['includes'](_0x59c06b(0x1c9))||_0x1cf279[_0x59c06b(0x224)](_0x59c06b(0x23b))||_0x1cf279['includes'](_0x59c06b(0x1ac))||_0x1cf279[_0x59c06b(0x224)](_0x59c06b(0x291))||_0x1cf279[_0x59c06b(0x224)](_0x59c06b(0x243)))return this['log'][_0x59c06b(0x23c)](_0x59c06b(0x24e)+_0xd387c7),!![];}}catch(_0x217dd3){}}}return![];}[a0_0x6dfaba(0x289)](){const _0x58d704=a0_0x6dfaba;if(!this[_0x58d704(0x1d4)])return;try{this['getStateAsync'](_0x58d704(0x199),(_0x113ccf,_0xb474f3)=>{const _0x1bbff0=_0x58d704;if(_0x113ccf||!_0xb474f3||!_0xb474f3[_0x1bbff0(0x20e)])return;try{const _0x506653=JSON[_0x1bbff0(0x2b1)](_0xb474f3[_0x1bbff0(0x20e)]);if(!_0x506653||_0x506653['length']===0x0)return;pythonBridge['send'](this,'ANALYZE_GAIT',{'sequences':_0x506653}),this[_0x1bbff0(0x17b)][_0x1bbff0(0x23c)](_0x1bbff0(0x1ee)+_0x506653[_0x1bbff0(0x1e0)]+_0x1bbff0(0x277));}catch(_0x264899){this[_0x1bbff0(0x17b)][_0x1bbff0(0x19b)](_0x1bbff0(0x1fb)+_0x264899[_0x1bbff0(0x2c0)]);}});}catch(_0x2f00a6){this[_0x58d704(0x17b)][_0x58d704(0x19b)](_0x58d704(0x25b)+_0x2f00a6[_0x58d704(0x2c0)]);}}async[a0_0x6dfaba(0x263)](){const _0x2dd175=a0_0x6dfaba;if(!this[_0x2dd175(0x1d4)]||!this[_0x2dd175(0x16b)][_0x2dd175(0x22f)])return;try{const _0x23d793={},_0x5dc969={},_0x473a83=this[_0x2dd175(0x248)][_0x2dd175(0x1a4)]||[];for(const _0x3395ea of _0x473a83){if((_0x3395ea[_0x2dd175(0x216)]===_0x2dd175(0x1d0)||_0x3395ea[_0x2dd175(0x216)]===_0x2dd175(0x29c))&&_0x3395ea[_0x2dd175(0x20b)])try{const _0x492bb6=await this['getForeignStateAsync'](_0x3395ea['id']);_0x492bb6&&typeof _0x492bb6[_0x2dd175(0x20e)]===_0x2dd175(0x21b)&&(_0x23d793[_0x3395ea[_0x2dd175(0x20b)]]=_0x492bb6[_0x2dd175(0x20e)],_0x5dc969[_0x3395ea[_0x2dd175(0x20b)]]=_0x3395ea[_0x2dd175(0x1b4)]||![]);}catch(_0x29cbe3){}}let _0x5ae599=0xa;if(this[_0x2dd175(0x248)][_0x2dd175(0x2aa)])try{const _0x3b654f=await this[_0x2dd175(0x17c)](this[_0x2dd175(0x248)][_0x2dd175(0x2aa)]);if(_0x3b654f&&typeof _0x3b654f[_0x2dd175(0x20e)]==='number')_0x5ae599=_0x3b654f[_0x2dd175(0x20e)];}catch(_0x6fca92){}const _0x263227=await this[_0x2dd175(0x173)]();let _0x30076c={};try{const _0x52d0c6=await this[_0x2dd175(0x197)](_0x2dd175(0x2c1));if(_0x52d0c6&&_0x52d0c6['val'])_0x30076c=JSON[_0x2dd175(0x2b1)](_0x52d0c6[_0x2dd175(0x20e)]);}catch(_0x22a2fc){}pythonBridge[_0x2dd175(0x2a2)](this,'PREDICT_ENERGY',{'current_temps':_0x23d793,'t_out':_0x5ae599,'is_sunny':_0x263227,'solar_flags':_0x5dc969,'warmup_targets':_0x30076c}),this['log'][_0x2dd175(0x2a1)](_0x2dd175(0x2ca)+Object[_0x2dd175(0x1b3)](_0x23d793)[_0x2dd175(0x1e0)]+_0x2dd175(0x1cc));}catch(_0x28abf2){this['log']['warn']('triggerEnergyPrediction\x20Error:\x20'+_0x28abf2[_0x2dd175(0x2c0)]);}}[a0_0x6dfaba(0x210)](){const _0x541b40=a0_0x6dfaba;if(!this[_0x541b40(0x2cd)]||this[_0x541b40(0x2cd)][_0x541b40(0x1e0)]===0x0)return;const _0x33cd60=new Array(0x30)['fill'](0x0),_0x59be70=Array['from']({'length':0x30},()=>[]),_0x1bc94f=new Date()[_0x541b40(0x24b)](0x0,0x0,0x0,0x0);this[_0x541b40(0x2cd)][_0x541b40(0x18f)](_0x4f25f3=>{const _0x2fb47e=_0x541b40,_0x3bbe3e=new Date(_0x4f25f3[_0x2fb47e(0x2c5)]);if(_0x3bbe3e[_0x2fb47e(0x18c)]()>=_0x1bc94f){const _0x34de19=_0x3bbe3e[_0x2fb47e(0x1bb)](),_0x23b0b7=_0x3bbe3e[_0x2fb47e(0x279)](),_0x3c1047=_0x34de19*0x2+Math[_0x2fb47e(0x219)](_0x23b0b7/0x1e);_0x3c1047>=0x0&&_0x3c1047<0x30&&(_0x33cd60[_0x3c1047]++,_0x59be70[_0x3c1047][_0x2fb47e(0x27b)]({'time':_0x3bbe3e[_0x2fb47e(0x21a)]('de-DE',{'hour':_0x2fb47e(0x26d),'minute':_0x2fb47e(0x26d)}),'location':_0x4f25f3[_0x2fb47e(0x20b)]||_0x2fb47e(0x18b),'type':_0x4f25f3[_0x2fb47e(0x216)]||_0x2fb47e(0x1af)}));}}),this[_0x541b40(0x172)]('analysis.health.todayVector',{'val':JSON[_0x541b40(0x2be)](_0x33cd60),'ack':!![]}),this[_0x541b40(0x172)](_0x541b40(0x1ef),{'val':JSON[_0x541b40(0x2be)](_0x59be70),'ack':!![]});}async['handleInfrasound'](_0x594127){const _0xfb083a=a0_0x6dfaba;if(!this[_0xfb083a(0x248)][_0xfb083a(0x218)]||typeof _0x594127!==_0xfb083a(0x21b))return;const _0x49d459=this[_0xfb083a(0x248)][_0xfb083a(0x24d)]||0.04;this[_0xfb083a(0x21d)][_0xfb083a(0x27b)]({'timestamp':Date[_0xfb083a(0x19d)](),'value':_0x594127}),this[_0xfb083a(0x21d)]['length']>0x64&&this['pressureBuffer'][_0xfb083a(0x1d9)](),_0x594127>_0x49d459&&!this[_0xfb083a(0x1ca)]&&(this[_0xfb083a(0x1ca)]=!![],this[_0xfb083a(0x17b)]['warn'](_0xfb083a(0x1a0)+_0x594127[_0xfb083a(0x29d)](0x4)+_0xfb083a(0x1a1)+_0x49d459+_0xfb083a(0x28f)),await this[_0xfb083a(0x220)](_0x594127,_0xfb083a(0x1e7)),setTimeout(()=>{this['infrasoundLocked']=![];},0x5*0x3c*0x3e8));}async[a0_0x6dfaba(0x220)](_0x1d0573,_0x315dcd){const _0x25c720=a0_0x6dfaba;if(!this[_0x25c720(0x167)]){const _0x31eacb=this[_0x25c720(0x1f1)][_0x25c720(0x200)](0x0,0xa),_0x1c5d8c=_0x31eacb[_0x25c720(0x17d)](_0x956267=>new Date(_0x956267[_0x25c720(0x2c5)])[_0x25c720(0x21a)](_0x25c720(0x215))+'\x20-\x20'+(_0x956267[_0x25c720(0x20b)]||_0x25c720(0x271))+':\x20'+_0x956267['name'])[_0x25c720(0x264)]('\x0a');this[_0x25c720(0x17b)][_0x25c720(0x19b)](_0x25c720(0x168)+_0x1d0573['toFixed'](0x4)+',\x20Events:\x0a'+_0x1c5d8c);if(this['config']['infrasoundArmingId'])try{const _0xe5a9b8=await this[_0x25c720(0x17c)](this[_0x25c720(0x248)][_0x25c720(0x232)]);_0xe5a9b8&&_0xe5a9b8[_0x25c720(0x20e)]===!![]&&(await this[_0x25c720(0x172)]('analysis.safety.infrasoundAlert',{'val':JSON[_0x25c720(0x2be)]({'timestamp':Date[_0x25c720(0x19d)](),'pressure':_0x1d0573[_0x25c720(0x29d)](0x4),'eventType':_0x315dcd,'recentEvents':_0x31eacb[_0x25c720(0x200)](0x0,0x3)}),'ack':!![]}),this['log'][_0x25c720(0x202)](_0x25c720(0x244)));}catch(_0x103e08){}}else this[_0x25c720(0x17b)]['debug'](_0x25c720(0x26e)+_0x1d0573['toFixed'](0x4)+_0x25c720(0x23e));}async[a0_0x6dfaba(0x265)](_0x128e7f){const _0x39b2fc=a0_0x6dfaba;if(!_0x128e7f||!_0x128e7f[_0x39b2fc(0x20b)])return;try{const _0x177bf0=(this[_0x39b2fc(0x248)]['devices']||[])[_0x39b2fc(0x16e)](_0x5ce379=>_0x5ce379[_0x39b2fc(0x20b)]===_0x128e7f[_0x39b2fc(0x20b)]&&(_0x5ce379['type']===_0x39b2fc(0x1d0)||_0x5ce379[_0x39b2fc(0x216)]==='thermostat'));if(_0x177bf0[_0x39b2fc(0x1e0)]===0x0)return;const _0x26008d=await this['getForeignStateAsync'](_0x177bf0[0x0]['id']);if(!_0x26008d||typeof _0x26008d[_0x39b2fc(0x20e)]!==_0x39b2fc(0x21b))return;const _0x36abb8=_0x26008d['val'];let _0x2853a8=null;if(this[_0x39b2fc(0x248)][_0x39b2fc(0x2aa)]){const _0x7952b8=await this[_0x39b2fc(0x17c)](this[_0x39b2fc(0x248)]['weatherTempId']);_0x7952b8&&typeof _0x7952b8[_0x39b2fc(0x20e)]===_0x39b2fc(0x21b)&&(_0x2853a8=_0x7952b8['val']);}if(_0x2853a8!==null){const _0x2aa548=Math[_0x39b2fc(0x262)](_0x36abb8-_0x2853a8);_0x2aa548>0x3&&(this[_0x39b2fc(0x17b)][_0x39b2fc(0x23c)]('üí®\x20L√ºftung\x20in\x20'+_0x128e7f[_0x39b2fc(0x20b)]+_0x39b2fc(0x1bd)+_0x2aa548[_0x39b2fc(0x29d)](0x1)+_0x39b2fc(0x25c)+_0x36abb8+_0x39b2fc(0x2a0)+_0x2853a8+_0x39b2fc(0x245)),await this['setStateAsync'](_0x39b2fc(0x20c),{'val':JSON[_0x39b2fc(0x2be)]({'room':_0x128e7f[_0x39b2fc(0x20b)],'timestamp':Date[_0x39b2fc(0x19d)](),'tempDiff':_0x2aa548[_0x39b2fc(0x29d)](0x1),'recommendation':_0x2aa548>0x5?'Gute\x20L√ºftungsm√∂glichkeit!':_0x39b2fc(0x1a9)}),'ack':!![]}));}}catch(_0x127034){this[_0x39b2fc(0x17b)]['warn']('analyzeWindowOpening\x20error:\x20'+_0x127034[_0x39b2fc(0x2c0)]);}}async[a0_0x6dfaba(0x2a7)](_0x120948){const _0x1acc29=a0_0x6dfaba;if(!_0x120948||typeof _0x120948!==_0x1acc29(0x22d))return;const _0x772251={'timestamp':_0x120948[_0x1acc29(0x2c5)]||Date[_0x1acc29(0x19d)](),'id':_0x120948['id']||Date['now']()['toString'](),'name':_0x120948['name']||'Manual\x20Event','type':_0x120948['type']||_0x1acc29(0x2ab),'location':_0x120948['location']||'Unknown','value':_0x120948[_0x1acc29(0x1a3)]||null};this[_0x1acc29(0x1f1)][_0x1acc29(0x292)](_0x772251);if(this[_0x1acc29(0x1f1)][_0x1acc29(0x1e0)]>0x1388)this[_0x1acc29(0x1f1)][_0x1acc29(0x2cf)]();await this[_0x1acc29(0x172)](_0x1acc29(0x205),{'val':JSON['stringify'](this['eventHistory']),'ack':!![]}),this['log'][_0x1acc29(0x23c)]('üìù\x20Manual\x20event\x20logged:\x20'+_0x772251['name']+'\x20('+_0x772251[_0x1acc29(0x20b)]+')');}[a0_0x6dfaba(0x24c)](_0x2f07f5){}}if(require[a0_0x6dfaba(0x2d2)]!==module)module['exports']=_0x268954=>new CogniLiving(_0x268954);else new CogniLiving();