function a0_0x36e5(_0x2adeb8,_0x2f30a4){const _0x21e3a1=a0_0x1acd();return a0_0x36e5=function(_0x1c70ab,_0x31d459){_0x1c70ab=_0x1c70ab-0x1bc;let _0x1acdc9=_0x21e3a1[_0x1c70ab];return _0x1acdc9;},a0_0x36e5(_0x2adeb8,_0x2f30a4);}function a0_0x1acd(){const _0x68ab58=['exitTimer','analysis.automation.patternDetected','Raw\x20Log','Deviation','abortExitTimer','common','name','uuid-not-found','licenseKey','namespace','731468YruJTf','Last\x20raw\x20event','runAutopilot','189tdWbTv','setStateAsync','substring','Daily\x20Digests','events.history_debug_03','application/json','vacation','Haust√ºr\x20Event:\x20Starte\x20Exit-Logik\x20(','updateBaselineStatus','warn','analysis.automation','splice','normal','saveRawEventLog','analysis.lastResult','LTM.rawEventLog','getForeignObjectsAsync','party','createAllObjects','scanDevices','Logbook','checkLtmObjects','indicator','response','log','activityLevel','object','constructor','runGeminiAnalysis','driftDetails','\x20sent','212272UQNKsp','message','isProVersion','Missing\x20data','analysis.history_debug_03','System\x20Status\x20&\x20Control','text.alarm','TEST-PRO-KEY','testNotification','loadRawEventLog','Automation\x20Proposals','Event\x20History','[TEST]\x20','analysis.automation.description','Drift\x20Analysis','catch','System\x20Mode','ROLLE:\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20KONTEXT:\x20','sendNotification','Activity\x20Summary','stringify','info','unknown','PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20ungew√∂hnliche\x20n√§chtliche\x20Aktivit√§t.','generic','LTM.processingStatus','enum','config','system.meta.uuid','events.history','createDailyDigest','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','Comfort\x20Suggestion','longitude','system.mode','getStateAsync','ABWESEND\x20‚úàÔ∏è','native','setupDriftAnalysisScheduler','notifySignalEnabled','city','dailyDigests','find','trim','N/A\x20(Learning)','cogni-living\x20adapter\x20starting\x20(v','setupLtmScheduler','LTM.driftAnalysis.lastCheck','resetAnalysisStates','channel','geminiModel','events.history_debug_00','Loaded\x20','loadDailyDigests','Starting\x20Autopilot\x20(','haust√ºr','Party','analysis.history_debug_00','\x20min).\x20Watchdog\x20Limit:\x20','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20}\x20}','onMessage','ü§ñ\x20Starting\x20Gemini\x20Analysis...','string','search','284830OjjgMT','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','\x0aFEEDBACK:\x0a','analysis.history_debug_02','ready','Success:\x20Compressed\x20','version','baselineDrift','2-digit','onStateChange','indicator.alarm','alertReason','location','Konnte\x20System-Standort\x20nicht\x20laden.','notifyTelegramRecipient','from','startsWith','notifyEmailInstance','Error:\x20','json','checkSystemObjects','bind','analysis.feedbackHistory','Sending\x20Prompt\x20(Length:\x20','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','notifyPushoverRecipient','models/gemini-flash-latest','extendObjectAsync','type','isAlert','inactivityThresholdHours','Last\x20Result','text','callback','Success','sendToAsync','Exit-Timer\x20abgelaufen:\x20Keine\x20Bewegung\x20innen\x20erkannt\x20->\x20ABWESEND.','latitude','events.lastEvent','exports','sendTo','debug','subscribeForeignStatesAsync','notifySignalRecipient','Description','saveDailyDigests','analysis.isEmergency','indicator.alarm.fire','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','toISOString','\x20sensors...','events.history_debug_01','rawEventLog','0\x204\x20*\x20*\x20*','ANWESEND\x20üè†','onUnload','Subscribing\x20to\x20','10nCMhUr','systemUUID','send','LTM.driftAnalysis.driftDetails','LTM.driftAnalysis','apiKey','1468338iLttVt','notifyPushoverInstance','checkLicense','val','sensorLastValues','[Test]\x20Notification','system','Nein','ltmDriftCheckIntervalHours','onReady','analysis.deviationFromBaseline','toLowerCase','loadHistoryFromState','PRO-','includes','notifyWhatsappRecipient','\x20Tage)','analysisInterval','getForeignObjectAsync','Gemini\x20Init\x20Error:\x20','getGenerativeModel','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20','GUEST','Sending\x20notification:\x20\x22','button','toLocaleString','Deaktiviert\x20(Pro-Feature)','inactivityMonitoringEnabled','Urlaub','setObjectNotExistsAsync','No\x20Key','analysisHistory','Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','push','error','devices','18ldcRjU','slice','notifyWhatsappEnabled','Normal','ltmJob','length','toString','analysis.analysisHistory','No\x20recent\x20activity.','aiPersona','isGracePeriodActive','runBaselineDriftAnalysis','events.history_debug_02','isPresent','ltmStbWindowDays','replace','AI\x20Alert\x20Status','Pattern\x20Detected','feedbackHistory','analysis.isAlert','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','generateContent','updateAnalysisHistory','events.history_debug_04','setState','eventHistory','Manual\x20Analysis\x20Trigger\x20detected!','siren','activity','summary','\x20(EMERGENCY)','PARTY','genAI','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','boolean','parse','logDuplicates','analysis.comfortSummary','ack','NORMAL','LTM.driftAnalysis.baselineDrift','LTM','systemConfig','livingContext','values',')...','lastAlertState','unshift','details','now','.\x20PR√ÑSENZ:\x20','getSystemUUID','analysisTimer','üö®\x20Dead\x20Man\x27s\x20Switch:\x20Keine\x20Aktivit√§t\x20seit\x20','sound','ltmLtbWindowDays','Received\x20scanDevices\x20request\x20from\x20Admin\x20UI.','system.isPresent','1166280ynFEVK','Drift\x20Status','Exit\x20Grace\x20Period\x20beendet.\x20√úberwache\x20nun\x20Innenraum...','analysis.history_debug_01','setPresence','driftAnalysisTimer','Trigger\x20Digest','startExitTimer','test','modeResetJob','flur','N/A','2111613AlGzXJ','Cogni-Living\x20Alert','\x0a!!!\x20END\x20WARNING\x20!!!\x0a','No\x20recorded\x20events\x20yet.','isEmergency','Comfort\x20Summary','196504NproHd','s\x20Grace).','Analysis\x20Error:\x20','eingang','.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','scheduleJob','Skipped\x20(No\x20AI\x20or\x20Data)','\x20events','currentSystemMode','üö®üö®\x20NOTFALL','Pr√§senz-Status\x20ge√§ndert:\x20','loadSystemMode','command','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','pop','üìç\x20Standort\x20geladen:\x20','notifyWhatsappInstance','date','setupModeResetScheduler','uuid','long','Started\x20at\x20','analysis.alertReason','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','state','subscribeStates','exitGraceTimer','unload','getLtmData','LTM.triggerDailyDigest','analysis.trigger','Gemini\x20AI\x20initialized.','checkLtmDriftObjects','processSensorEvent','toFixed','cogni-living','0\x203\x20*\x20*\x20*','getEnums','‚úÖ\x20Gemini\x20Response\x20received.',')\x20-\x20DEBUG\x20MODE\x20ENABLED','notifySignalInstance','cancel','min\x20Timer,\x20','system.config','lastCheck','Processing\x20Status','minDaysForBaseline','Adapter','LTM.baselineStatus','Presence\x20Status','map','getObjectAsync','saveFeedback'];a0_0x1acd=function(){return _0x68ab58;};return a0_0x1acd();}const a0_0x23471d=a0_0x36e5;(function(_0x119827,_0x354e45){const _0xc6410f=a0_0x36e5,_0x55f5bb=_0x119827();while(!![]){try{const _0xc01742=parseInt(_0xc6410f(0x1c4))/0x1+-parseInt(_0xc6410f(0x1e6))/0x2*(-parseInt(_0xc6410f(0x289))/0x3)+-parseInt(_0xc6410f(0x2d6))/0x4+parseInt(_0xc6410f(0x25f))/0x5*(-parseInt(_0xc6410f(0x265))/0x6)+parseInt(_0xc6410f(0x2d0))/0x7+parseInt(_0xc6410f(0x2c4))/0x8+parseInt(_0xc6410f(0x1c7))/0x9*(-parseInt(_0xc6410f(0x226))/0xa);if(_0xc01742===_0x354e45)break;else _0x55f5bb['push'](_0x55f5bb['shift']());}catch(_0x3a5862){_0x55f5bb['push'](_0x55f5bb['shift']());}}}(a0_0x1acd,0xa5c65));const a0_0x31d459=(function(){let _0x34f03a=!![];return function(_0x46b34d,_0x55f2ec){const _0x559f40=_0x34f03a?function(){if(_0x55f2ec){const _0x452540=_0x55f2ec['apply'](_0x46b34d,arguments);return _0x55f2ec=null,_0x452540;}}:function(){};return _0x34f03a=![],_0x559f40;};}()),a0_0x1c70ab=a0_0x31d459(this,function(){const _0x342648=a0_0x36e5;return a0_0x1c70ab[_0x342648(0x28f)]()['search']('(((.+)+)+)+$')[_0x342648(0x28f)]()[_0x342648(0x1e2)](a0_0x1c70ab)[_0x342648(0x225)]('(((.+)+)+)+$');});a0_0x1c70ab();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require('node-schedule'),HISTORY_MAX_SIZE=0x32,FEEDBACK_MAX_SIZE=0x14,GEMINI_MODEL=a0_0x23471d(0x240),ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,DAILY_DIGEST_MAX_SIZE_LIMIT=0xb4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,LTM_SCHEDULE=a0_0x23471d(0x2fa),LTM_DP_RAW_LOG=a0_0x23471d(0x1d6),LTM_DP_DAILY_DIGESTS='LTM.dailyDigests',LTM_DP_STATUS=a0_0x23471d(0x1ff),LTM_DP_TRIGGER_DIGEST=a0_0x23471d(0x2f3),LTM_DP_BASELINE_STATUS=a0_0x23471d(0x306),LTM_DP_DRIFT_CHANNEL=a0_0x23471d(0x263),LTM_DP_DRIFT_STATUS=a0_0x23471d(0x2b2),LTM_DP_DRIFT_DETAILS=a0_0x23471d(0x262),LTM_DP_DRIFT_LAST_CHECK=a0_0x23471d(0x215),SYSTEM_DP_MODE='system.mode',MODE_RESET_SCHEDULE=a0_0x23471d(0x25b),SYSTEM_MODES={'NORMAL':a0_0x23471d(0x1d3),'VACATION':a0_0x23471d(0x1cd),'PARTY':a0_0x23471d(0x1d8),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x23471d(0x2a8)],SYSTEM_MODES[a0_0x23471d(0x27b)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':a0_0x23471d(0x285),'senior_aal':a0_0x23471d(0x1fd),'family':a0_0x23471d(0x2ed),'single_comfort':'Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','security':a0_0x23471d(0x23e)};class CogniLiving extends utils[a0_0x23471d(0x305)]{constructor(_0x3c1a1d){const _0x153e5b=a0_0x23471d;super({..._0x3c1a1d,'name':_0x153e5b(0x2f9)}),this[_0x153e5b(0x2a2)]=[],this[_0x153e5b(0x284)]=[],this[_0x153e5b(0x29b)]=[],this[_0x153e5b(0x25a)]=[],this[_0x153e5b(0x20f)]=[],this['sensorLastValues']={},this[_0x153e5b(0x2b4)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x153e5b(0x296)]=!![],this['exitTimer']=null,this[_0x153e5b(0x2f0)]=null,this[_0x153e5b(0x293)]=![],this['genAI']=null,this['geminiModel']=null,this[_0x153e5b(0x2de)]=SYSTEM_MODES['NORMAL'],this[_0x153e5b(0x1e8)]=![],this[_0x153e5b(0x2b8)]=![],this[_0x153e5b(0x260)]=_0x153e5b(0x1fc),this[_0x153e5b(0x2be)]=null,this[_0x153e5b(0x28d)]=null,this['modeResetJob']=null,this['driftAnalysisTimer']=null,this['on'](_0x153e5b(0x22a),this[_0x153e5b(0x26e)][_0x153e5b(0x23b)](this)),this['on']('stateChange',this[_0x153e5b(0x22f)][_0x153e5b(0x23b)](this)),this['on'](_0x153e5b(0x2f1),this[_0x153e5b(0x25d)][_0x153e5b(0x23b)](this)),this['on']('message',this[_0x153e5b(0x222)]['bind'](this));}async[a0_0x23471d(0x26e)](){const _0x43e1d8=a0_0x23471d;this[_0x43e1d8(0x1df)][_0x43e1d8(0x1fb)](_0x43e1d8(0x213)+this[_0x43e1d8(0x22c)]+_0x43e1d8(0x2fd)),await this['cleanUpZombies'](),this[_0x43e1d8(0x201)][_0x43e1d8(0x1c2)]=this['config'][_0x43e1d8(0x1c2)]||'',this[_0x43e1d8(0x1e8)]=await this[_0x43e1d8(0x267)](this['config']['licenseKey']);if(!this[_0x43e1d8(0x201)]['inactivityThresholdHours']||this['config']['inactivityThresholdHours']<0.1)this[_0x43e1d8(0x201)]['inactivityThresholdHours']=0xc;await this['loadHistoryFromState']();try{const _0x1a94e4=await this[_0x43e1d8(0x277)](_0x43e1d8(0x301));_0x1a94e4&&_0x1a94e4[_0x43e1d8(0x1bf)]&&(this[_0x43e1d8(0x2b4)]={'latitude':_0x1a94e4[_0x43e1d8(0x1bf)][_0x43e1d8(0x24b)]||0x0,'longitude':_0x1a94e4[_0x43e1d8(0x1bf)][_0x43e1d8(0x207)]||0x0,'city':_0x1a94e4[_0x43e1d8(0x1bf)][_0x43e1d8(0x20e)]||''},this[_0x43e1d8(0x1df)][_0x43e1d8(0x1fb)](_0x43e1d8(0x2e5)+this[_0x43e1d8(0x2b4)][_0x43e1d8(0x20e)]));}catch(_0x56c45c){this['log']['warn'](_0x43e1d8(0x233));}if(this[_0x43e1d8(0x201)]['geminiApiKey'])try{this[_0x43e1d8(0x2a9)]=new GoogleGenerativeAI(this[_0x43e1d8(0x201)]['geminiApiKey']),this[_0x43e1d8(0x218)]=this[_0x43e1d8(0x2a9)][_0x43e1d8(0x279)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x43e1d8(0x1cc)}}),this['log'][_0x43e1d8(0x1fb)](_0x43e1d8(0x2f5));}catch(_0x51990f){this[_0x43e1d8(0x1df)]['error'](_0x43e1d8(0x278)+_0x51990f[_0x43e1d8(0x1e7)]);}else this[_0x43e1d8(0x1df)]['warn']('Gemini\x20API\x20Key\x20missing.\x20AI\x20features\x20disabled.');await this[_0x43e1d8(0x1d9)](),await this[_0x43e1d8(0x2e1)](),await this[_0x43e1d8(0x1ef)](),await this[_0x43e1d8(0x21b)](),this[_0x43e1d8(0x2ef)](_0x43e1d8(0x2f4)),this[_0x43e1d8(0x2ef)](LTM_DP_TRIGGER_DIGEST),this[_0x43e1d8(0x2ef)](_0x43e1d8(0x208));const _0x563365=this[_0x43e1d8(0x201)][_0x43e1d8(0x288)];if(_0x563365&&_0x563365['length']>0x0){this['log'][_0x43e1d8(0x1fb)](_0x43e1d8(0x25e)+_0x563365[_0x43e1d8(0x28e)]+_0x43e1d8(0x258));for(const _0x381ba9 of _0x563365){if(_0x381ba9['id']){await this[_0x43e1d8(0x250)](_0x381ba9['id']);try{const _0x5805e3=await this['getForeignStateAsync'](_0x381ba9['id']);if(_0x5805e3)this[_0x43e1d8(0x269)][_0x381ba9['id']]=_0x5805e3[_0x43e1d8(0x268)];}catch(_0x38b64b){}}}}if(this['analysisTimer'])clearInterval(this[_0x43e1d8(0x2be)]);const _0x1bae94=this[_0x43e1d8(0x201)][_0x43e1d8(0x276)]||0xf;_0x1bae94>0x0&&(this['log'][_0x43e1d8(0x1fb)](_0x43e1d8(0x21c)+_0x1bae94+_0x43e1d8(0x220)+this[_0x43e1d8(0x201)][_0x43e1d8(0x244)]+'h.'),this[_0x43e1d8(0x2be)]=setInterval(()=>this[_0x43e1d8(0x1c6)](),_0x1bae94*0x3c*0x3e8)),this[_0x43e1d8(0x214)](),this[_0x43e1d8(0x2e8)](),this[_0x43e1d8(0x20c)]();}async['cleanUpZombies'](){const _0xd829c8=a0_0x23471d,_0x49c8ab=[_0xd829c8(0x21f),_0xd829c8(0x2c7),_0xd829c8(0x229),_0xd829c8(0x1ea),'analysis.history_debug_04',_0xd829c8(0x219),_0xd829c8(0x259),_0xd829c8(0x295),_0xd829c8(0x1cb),_0xd829c8(0x2a0)];for(const _0x4985c1 of _0x49c8ab){try{const _0x190f62=await this[_0xd829c8(0x309)](_0x4985c1);_0x190f62&&await this['delObjectAsync'](_0x4985c1);}catch(_0x590745){}}}async[a0_0x23471d(0x271)](){const _0x46ab45=a0_0x23471d;try{const _0x24ed33=await this[_0x46ab45(0x209)](_0x46ab45(0x203));_0x24ed33&&_0x24ed33[_0x46ab45(0x268)]&&(this['eventHistory']=JSON[_0x46ab45(0x2ad)](_0x24ed33[_0x46ab45(0x268)]['toString']()),this[_0x46ab45(0x1df)]['info'](_0x46ab45(0x21a)+this[_0x46ab45(0x2a2)][_0x46ab45(0x28e)]+'\x20events\x20from\x20history.'));}catch(_0xefa630){this[_0x46ab45(0x2a2)]=[];}try{const _0x33f6aa=await this[_0x46ab45(0x209)](_0x46ab45(0x290));if(_0x33f6aa&&_0x33f6aa[_0x46ab45(0x268)])this[_0x46ab45(0x284)]=JSON[_0x46ab45(0x2ad)](_0x33f6aa['val'][_0x46ab45(0x28f)]());}catch(_0x44234a){this[_0x46ab45(0x284)]=[];}}['onStateChange'](_0x1adbf0,_0x58a8f4){const _0x113174=a0_0x23471d;if(!_0x58a8f4)return;if(_0x1adbf0===this[_0x113174(0x1c3)]+'.'+SYSTEM_DP_MODE){_0x58a8f4[_0x113174(0x268)]&&Object[_0x113174(0x2b6)](SYSTEM_MODES)['includes'](_0x58a8f4[_0x113174(0x268)])&&(this[_0x113174(0x2de)]=_0x58a8f4[_0x113174(0x268)],_0x58a8f4['val']===SYSTEM_MODES['VACATION']?this[_0x113174(0x2c8)](![]):this[_0x113174(0x2c8)](!![]));if(!_0x58a8f4[_0x113174(0x2b0)])this[_0x113174(0x2a1)](_0x1adbf0,{'val':this[_0x113174(0x2de)],'ack':!![]});return;}if(!_0x58a8f4[_0x113174(0x2b0)]){_0x1adbf0[_0x113174(0x273)]('analysis.trigger')&&_0x58a8f4[_0x113174(0x268)]&&(this['log'][_0x113174(0x1fb)](_0x113174(0x2a3)),this[_0x113174(0x2a1)](_0x1adbf0,{'val':![],'ack':!![]}),this[_0x113174(0x1e3)]());if(_0x1adbf0[_0x113174(0x273)]('triggerDailyDigest')&&_0x58a8f4[_0x113174(0x268)]){this['setState'](_0x1adbf0,{'val':![],'ack':!![]});if(this[_0x113174(0x1e8)])this[_0x113174(0x204)]();}return;}const _0x3ad3f0=(this[_0x113174(0x201)][_0x113174(0x288)]||[])[_0x113174(0x210)](_0x4d1b6b=>_0x4d1b6b['id']===_0x1adbf0);if(_0x3ad3f0)this['processSensorEvent'](_0x1adbf0,_0x58a8f4,_0x3ad3f0);}async[a0_0x23471d(0x2f7)](_0x2bc955,_0x50c973,_0x3b2e4b){const _0x5a18a2=a0_0x23471d;if(!_0x3b2e4b[_0x5a18a2(0x2ae)]&&this[_0x5a18a2(0x269)][_0x2bc955]===_0x50c973[_0x5a18a2(0x268)])return;this['sensorLastValues'][_0x2bc955]=_0x50c973[_0x5a18a2(0x268)];if(this[_0x5a18a2(0x293)]){this[_0x5a18a2(0x1df)]['debug']('Ignoring\x20event\x20during\x20Exit\x20Grace\x20Period:\x20'+_0x3b2e4b['name']);return;}const _0x54ab14=_0x3b2e4b[_0x5a18a2(0x242)]==='Fenster/T√ºr'&&(_0x3b2e4b[_0x5a18a2(0x1c0)]['toLowerCase']()['includes'](_0x5a18a2(0x21d))||_0x3b2e4b[_0x5a18a2(0x1c0)]['toLowerCase']()[_0x5a18a2(0x273)](_0x5a18a2(0x2d9))||_0x3b2e4b[_0x5a18a2(0x232)][_0x5a18a2(0x270)]()[_0x5a18a2(0x273)](_0x5a18a2(0x2ce)));_0x54ab14&&!_0x50c973['val']?this['startExitTimer']():(this[_0x5a18a2(0x30b)]&&(this[_0x5a18a2(0x1df)][_0x5a18a2(0x1fb)](_0x5a18a2(0x2aa)),this[_0x5a18a2(0x1be)]()),!this['isPresent']&&this[_0x5a18a2(0x2de)]===SYSTEM_MODES[_0x5a18a2(0x2b1)]&&this[_0x5a18a2(0x2c8)](!![]));const _0x38229e={'timestamp':_0x50c973['ts'],'id':_0x2bc955,'name':_0x3b2e4b['name'],'value':_0x50c973[_0x5a18a2(0x268)],'location':_0x3b2e4b['location'],'type':_0x3b2e4b[_0x5a18a2(0x242)]};this[_0x5a18a2(0x2a2)][_0x5a18a2(0x2b9)](_0x38229e);if(this[_0x5a18a2(0x2a2)][_0x5a18a2(0x28e)]>HISTORY_MAX_SIZE)this[_0x5a18a2(0x2a2)][_0x5a18a2(0x2e4)]();await this[_0x5a18a2(0x1c8)](_0x5a18a2(0x24c),{'val':JSON['stringify'](_0x38229e),'ack':!![]}),await this[_0x5a18a2(0x1c8)](_0x5a18a2(0x203),{'val':JSON[_0x5a18a2(0x1fa)](this[_0x5a18a2(0x2a2)]),'ack':!![]}),this[_0x5a18a2(0x25a)][_0x5a18a2(0x286)]({'timestamp':new Date(_0x50c973['ts'])[_0x5a18a2(0x257)](),'sensorName':_0x3b2e4b[_0x5a18a2(0x1c0)],'location':_0x3b2e4b[_0x5a18a2(0x232)],'value':_0x50c973[_0x5a18a2(0x268)]}),await this[_0x5a18a2(0x1d4)]();}[a0_0x23471d(0x2cb)](){const _0x357cbf=a0_0x23471d;this['log'][_0x357cbf(0x1fb)](_0x357cbf(0x1ce)+EXIT_TIMER_MINUTES+_0x357cbf(0x300)+EXIT_GRACE_PERIOD_SECONDS+_0x357cbf(0x2d7)),this[_0x357cbf(0x1be)](),this['isGracePeriodActive']=!![],this[_0x357cbf(0x2f0)]=setTimeout(()=>{const _0x36c27d=_0x357cbf;this['isGracePeriodActive']=![],this[_0x36c27d(0x1df)][_0x36c27d(0x24f)](_0x36c27d(0x2c6));},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x357cbf(0x30b)]=setTimeout(()=>{const _0x38a304=_0x357cbf;this[_0x38a304(0x1df)][_0x38a304(0x1fb)](_0x38a304(0x24a)),this[_0x38a304(0x2c8)](![]),this['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x23471d(0x1be)](){const _0x3fa7bc=a0_0x23471d;if(this[_0x3fa7bc(0x30b)])clearTimeout(this[_0x3fa7bc(0x30b)]);if(this[_0x3fa7bc(0x2f0)])clearTimeout(this[_0x3fa7bc(0x2f0)]);this[_0x3fa7bc(0x30b)]=null,this[_0x3fa7bc(0x2f0)]=null,this[_0x3fa7bc(0x293)]=![];}async[a0_0x23471d(0x2c8)](_0x29a588){const _0xf17376=a0_0x23471d;if(this[_0xf17376(0x296)]===_0x29a588)return;this[_0xf17376(0x296)]=_0x29a588,await this[_0xf17376(0x1c8)](_0xf17376(0x2c3),{'val':_0x29a588,'ack':!![]}),this[_0xf17376(0x1df)][_0xf17376(0x1fb)](_0xf17376(0x2e0)+(_0x29a588?_0xf17376(0x25c):_0xf17376(0x20a)));}['runAutopilot'](){const _0x54eb9d=a0_0x23471d,_0x5b4534=this[_0x54eb9d(0x201)][_0x54eb9d(0x244)],_0x208b8c=this[_0x54eb9d(0x201)][_0x54eb9d(0x280)],_0x3fb56c=this[_0x54eb9d(0x2a2)][_0x54eb9d(0x28e)]>0x0?this['eventHistory'][0x0]['timestamp']:Date['now'](),_0x26ca8e=(Date[_0x54eb9d(0x2bb)]()-_0x3fb56c)/(0x3e8*0x3c*0x3c);let _0x2f8d2b='';_0x208b8c&&this['currentSystemMode']===SYSTEM_MODES[_0x54eb9d(0x2b1)]&&this[_0x54eb9d(0x296)]&&(_0x26ca8e>_0x5b4534&&(this[_0x54eb9d(0x1df)][_0x54eb9d(0x1d0)](_0x54eb9d(0x2bf)+_0x26ca8e[_0x54eb9d(0x2f8)](0x1)+'\x20Stunden!'),_0x2f8d2b=_0x54eb9d(0x2ab)+_0x26ca8e[_0x54eb9d(0x2f8)](0x1)+_0x54eb9d(0x227)));if(_0x2f8d2b){this['runGeminiAnalysis'](_0x2f8d2b)[_0x54eb9d(0x1f5)](_0x38bbc9=>this['log']['error'](_0x38bbc9));return;}const _0x2b3d39=Date[_0x54eb9d(0x2bb)](),_0x92ddf1=_0x2b3d39-_0x3fb56c,_0x112290=(this[_0x54eb9d(0x201)][_0x54eb9d(0x276)]||0xf)*0x3c*0x3e8;this['eventHistory'][_0x54eb9d(0x28e)]>0x0&&_0x92ddf1<=_0x112290?this[_0x54eb9d(0x1e3)]()[_0x54eb9d(0x1f5)](_0x48ca9c=>this[_0x54eb9d(0x1df)][_0x54eb9d(0x287)](_0x48ca9c)):!this[_0x54eb9d(0x2b8)]&&(this[_0x54eb9d(0x2a1)]('analysis.isAlert',{'val':![],'ack':!![]}),this['setState'](_0x54eb9d(0x254),{'val':![],'ack':!![]}));}async[a0_0x23471d(0x1e3)](_0x35ce04=''){const _0x2bf6f1=a0_0x23471d;this[_0x2bf6f1(0x1df)][_0x2bf6f1(0x1fb)](_0x2bf6f1(0x223));if(!this[_0x2bf6f1(0x218)]){this[_0x2bf6f1(0x1df)]['error']('‚ùå\x20Gemini\x20Model\x20not\x20initialized!\x20Check\x20API\x20Key.');return;}const _0x15fb90=this['eventHistory'][_0x2bf6f1(0x28e)]>0x0?this[_0x2bf6f1(0x2a2)]:[{'note':_0x2bf6f1(0x2d3)}],_0xd6ae64=PERSONA_MAPPING[this['config'][_0x2bf6f1(0x292)]||_0x2bf6f1(0x1fe)],_0x205964=this['config'][_0x2bf6f1(0x2b5)]||'',_0x420da8=this[_0x2bf6f1(0x2de)],_0x2ebe72=new Date(),_0x2fc701=_0x2ebe72[_0x2bf6f1(0x27e)]('de-DE',{'weekday':_0x2bf6f1(0x2ea),'hour':_0x2bf6f1(0x22e),'minute':'2-digit'}),_0x6e115e=this['systemConfig'];let _0x2d9dad='';if(this[_0x2bf6f1(0x29b)][_0x2bf6f1(0x28e)]>0x0){const _0x2ccdff=this[_0x2bf6f1(0x29b)][_0x2bf6f1(0x28a)](0x0,0x3)[_0x2bf6f1(0x308)](_0x527c1d=>'User\x20Feedback:\x20Alarm\x20\x22'+_0x527c1d['alertReason']+'\x22\x20was\x20'+_0x527c1d['rating']+'.')['join']('\x0a');_0x2d9dad=_0x2bf6f1(0x228)+_0x2ccdff+'\x0a';}const _0x154047=_0x35ce04?_0x2bf6f1(0x2e3)+_0x35ce04+_0x2bf6f1(0x2d2):'',_0x33ffe2='Baseline:\x20Inactive\x20(Pro\x20Feature).',_0x1401d3='ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20'+_0x2fc701+'.\x20ORT:\x20'+_0x6e115e['city']+_0x2bf6f1(0x27a)+_0x420da8+_0x2bf6f1(0x2bc)+(this[_0x2bf6f1(0x296)]?'Ja':_0x2bf6f1(0x26c))+'.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20'+_0x205964+'.\x20PERSONA:\x20'+_0xd6ae64+_0x2bf6f1(0x256)+_0x33ffe2+'\x20'+_0x2d9dad+'\x20'+_0x154047+_0x2bf6f1(0x29d)+JSON[_0x2bf6f1(0x1fa)](_0x15fb90)+_0x2bf6f1(0x221);try{this[_0x2bf6f1(0x1df)][_0x2bf6f1(0x24f)](_0x2bf6f1(0x23d)+_0x1401d3[_0x2bf6f1(0x28e)]+_0x2bf6f1(0x2b7));const _0x3528a3=await this[_0x2bf6f1(0x218)][_0x2bf6f1(0x29e)](_0x1401d3),_0xcb1960=_0x3528a3[_0x2bf6f1(0x1de)]['text']()['replace'](/```json|```/g,'')[_0x2bf6f1(0x211)]();this[_0x2bf6f1(0x1df)]['info'](_0x2bf6f1(0x2fc));const _0x31de79=JSON[_0x2bf6f1(0x2ad)](_0xcb1960);await this[_0x2bf6f1(0x1c8)](_0x2bf6f1(0x1d5),{'val':_0xcb1960,'ack':!![]}),await this[_0x2bf6f1(0x1c8)](_0x2bf6f1(0x2ec),{'val':_0x31de79['activity']['alertReason']||'','ack':!![]}),await this['setStateAsync']('analysis.activitySummary',{'val':_0x31de79['activity'][_0x2bf6f1(0x2a6)]||'N/A','ack':!![]});const _0x5ba63f=_0x31de79[_0x2bf6f1(0x2a5)][_0x2bf6f1(0x243)]||![],_0x1eab2c=_0x31de79[_0x2bf6f1(0x2a5)][_0x2bf6f1(0x2d4)]||![];if(_0x5ba63f||_0x1eab2c){await this[_0x2bf6f1(0x1c8)]('analysis.isAlert',{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x2bf6f1(0x254),{'val':_0x1eab2c,'ack':!![]});if(!this['lastAlertState']||_0x1eab2c){const _0x2eef9c=_0x1eab2c?_0x2bf6f1(0x2df):'‚ö†Ô∏è\x20Alarm';this[_0x2bf6f1(0x1f8)](_0x2eef9c+':\x20'+_0x31de79['activity'][_0x2bf6f1(0x231)],![],_0x1eab2c);}}else await this[_0x2bf6f1(0x1c8)](_0x2bf6f1(0x29c),{'val':![],'ack':!![]}),await this[_0x2bf6f1(0x1c8)](_0x2bf6f1(0x254),{'val':![],'ack':!![]});this[_0x2bf6f1(0x2b8)]=_0x5ba63f||_0x1eab2c;const _0x39ab99={'timestamp':Date[_0x2bf6f1(0x2bb)](),'id':Date[_0x2bf6f1(0x2bb)]()[_0x2bf6f1(0x28f)](),'analysis':_0x31de79,'systemMode':_0x420da8,'isPro':this[_0x2bf6f1(0x1e8)]};this['updateAnalysisHistory'](_0x39ab99);}catch(_0x16e10f){this['log'][_0x2bf6f1(0x287)](_0x2bf6f1(0x2d8)+_0x16e10f['message']);}}async[a0_0x23471d(0x204)](){const _0x18023b=a0_0x23471d;if(!this[_0x18023b(0x1e8)])return;await this[_0x18023b(0x1c8)](LTM_DP_STATUS,{'val':_0x18023b(0x2eb)+new Date()[_0x18023b(0x27e)](),'ack':!![]});if(!this[_0x18023b(0x218)]||this['rawEventLog']['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x18023b(0x2dc),'ack':!![]});return;}const _0x46dc0e=JSON[_0x18023b(0x2ad)](JSON[_0x18023b(0x1fa)](this[_0x18023b(0x25a)])),_0x49477a=(this['config'][_0x18023b(0x2b5)]||'')[_0x18023b(0x1c9)](0x0,0x3e8),_0x1b1b4e=_0x18023b(0x1f7)+_0x49477a+_0x18023b(0x2da)+JSON['stringify'](_0x46dc0e);try{const _0x1aba79=await this[_0x18023b(0x218)][_0x18023b(0x29e)](_0x1b1b4e),_0x5e102b=JSON[_0x18023b(0x2ad)](_0x1aba79[_0x18023b(0x1de)][_0x18023b(0x246)]()[_0x18023b(0x298)](/```json|```/g,'')[_0x18023b(0x211)]());_0x5e102b['summary']&&(this[_0x18023b(0x20f)][_0x18023b(0x286)]({'timestamp':new Date()[_0x18023b(0x257)](),'eventCount':_0x46dc0e[_0x18023b(0x28e)],'summary':_0x5e102b[_0x18023b(0x2a6)],'activityLevel':_0x5e102b[_0x18023b(0x1e0)],'systemMode':this[_0x18023b(0x2de)]}),await this['saveDailyDigests'](),this[_0x18023b(0x25a)]=[],await this[_0x18023b(0x1d4)](),await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x18023b(0x22b)+_0x46dc0e[_0x18023b(0x28e)]+_0x18023b(0x2dd),'ack':!![]}));}catch(_0x136bc4){await this[_0x18023b(0x1c8)](LTM_DP_STATUS,{'val':_0x18023b(0x238)+_0x136bc4[_0x18023b(0x1e7)],'ack':!![]});}}async[a0_0x23471d(0x1d9)](){const _0x355b56=a0_0x23471d;await this[_0x355b56(0x23a)](),await this[_0x355b56(0x282)]('system.isPresent',{'type':_0x355b56(0x2ee),'common':{'name':_0x355b56(0x307),'type':_0x355b56(0x2ac),'role':_0x355b56(0x1dd),'read':!![],'write':![],'def':!![]},'native':{}}),await this['setObjectNotExistsAsync']('events.lastEvent',{'type':_0x355b56(0x2ee),'common':{'name':_0x355b56(0x1c5),'type':'string','role':'json','read':!![],'write':![]},'native':{}}),await this[_0x355b56(0x282)](_0x355b56(0x203),{'type':'state','common':{'name':_0x355b56(0x1f1),'type':_0x355b56(0x224),'role':_0x355b56(0x239),'read':!![],'write':![]},'native':{}}),await this[_0x355b56(0x282)]('analysis.trigger',{'type':_0x355b56(0x2ee),'common':{'name':'Trigger\x20Analysis','type':'boolean','role':_0x355b56(0x27d),'read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x355b56(0x1d5),{'type':_0x355b56(0x2ee),'common':{'name':_0x355b56(0x245),'type':_0x355b56(0x224),'role':_0x355b56(0x239),'read':!![],'write':![]},'native':{}}),await this[_0x355b56(0x282)](_0x355b56(0x29c),{'type':_0x355b56(0x2ee),'common':{'name':_0x355b56(0x299),'type':'boolean','role':_0x355b56(0x230),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x355b56(0x282)](_0x355b56(0x254),{'type':_0x355b56(0x2ee),'common':{'name':'AI\x20Emergency\x20Status','type':_0x355b56(0x2ac),'role':_0x355b56(0x255),'read':!![],'write':![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x355b56(0x2ec),{'type':_0x355b56(0x2ee),'common':{'name':'Alert\x20Reason','type':_0x355b56(0x224),'role':_0x355b56(0x1ec),'read':!![],'write':![]},'native':{}}),await this[_0x355b56(0x282)]('analysis.activitySummary',{'type':_0x355b56(0x2ee),'common':{'name':_0x355b56(0x1f9),'type':_0x355b56(0x224),'role':_0x355b56(0x246),'read':!![],'write':![]},'native':{}}),await this[_0x355b56(0x282)]('analysis.deviationFromBaseline',{'type':'state','common':{'name':_0x355b56(0x1bd),'type':_0x355b56(0x224),'role':_0x355b56(0x2ee),'read':!![],'write':![],'def':_0x355b56(0x2cf)},'native':{}}),await this['setObjectNotExistsAsync'](_0x355b56(0x2af),{'type':_0x355b56(0x2ee),'common':{'name':_0x355b56(0x2d5),'type':_0x355b56(0x224),'role':_0x355b56(0x246),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.comfortSuggestion',{'type':_0x355b56(0x2ee),'common':{'name':_0x355b56(0x206),'type':'string','role':_0x355b56(0x246),'read':!![],'write':![]},'native':{}}),await this[_0x355b56(0x241)](_0x355b56(0x1d1),{'type':'channel','common':{'name':_0x355b56(0x1f0)},'native':{}}),await this[_0x355b56(0x282)](_0x355b56(0x30c),{'type':_0x355b56(0x2ee),'common':{'name':_0x355b56(0x29a),'type':'boolean','role':'indicator','read':!![],'write':![],'def':![]},'native':{}}),await this[_0x355b56(0x282)](_0x355b56(0x1f3),{'type':'state','common':{'name':_0x355b56(0x252),'type':_0x355b56(0x224),'role':_0x355b56(0x246),'read':!![],'write':![]},'native':{}}),await this[_0x355b56(0x282)]('analysis.automation.suggestedAction',{'type':_0x355b56(0x2ee),'common':{'name':'Action','type':_0x355b56(0x224),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x355b56(0x282)](_0x355b56(0x290),{'type':'state','common':{'name':_0x355b56(0x1db),'type':_0x355b56(0x224),'role':_0x355b56(0x239),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x355b56(0x282)](_0x355b56(0x23c),{'type':_0x355b56(0x2ee),'common':{'name':'Feedback\x20Log','type':_0x355b56(0x224),'role':'json','read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x355b56(0x1dc)](),await this[_0x355b56(0x2f6)]();}async['checkSystemObjects'](){const _0x500ba7=a0_0x23471d;await this['extendObjectAsync'](_0x500ba7(0x26b),{'type':_0x500ba7(0x217),'common':{'name':_0x500ba7(0x1eb)},'native':{}}),await this[_0x500ba7(0x241)](SYSTEM_DP_MODE,{'type':_0x500ba7(0x2ee),'common':{'name':_0x500ba7(0x1f6),'type':'string','role':_0x500ba7(0x2ee),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x500ba7(0x2b1)],'states':{[SYSTEM_MODES[_0x500ba7(0x2b1)]]:_0x500ba7(0x28c),[SYSTEM_MODES['VACATION']]:_0x500ba7(0x281),[SYSTEM_MODES[_0x500ba7(0x2a8)]]:_0x500ba7(0x21e),[SYSTEM_MODES[_0x500ba7(0x27b)]]:'Gast'}},'native':{}});}async['sendNotification'](_0x3035c2,_0x505e07=![],_0x4781cc=![]){const _0x338cd8=a0_0x23471d;this['log'][_0x338cd8(0x1fb)]((_0x505e07?_0x338cd8(0x1f2):'')+_0x338cd8(0x27c)+_0x3035c2+'\x22'+(_0x4781cc?_0x338cd8(0x2a7):''));const _0x44b869=this['config'];let _0x328916=0x0;_0x44b869['notifyTelegramEnabled']&&_0x44b869['notifyTelegramInstance']&&(await this[_0x338cd8(0x249)](_0x44b869['notifyTelegramInstance'],_0x338cd8(0x261),{'text':_0x3035c2,'user':_0x44b869[_0x338cd8(0x234)]}),_0x328916++);if(_0x44b869['notifyPushoverEnabled']&&_0x44b869[_0x338cd8(0x266)]){let _0x5735ca={'message':_0x3035c2,'title':_0x4781cc?'üö®\x20EMERGENCY':_0x338cd8(0x2d1),'priority':_0x4781cc?0x2:0x1,'device':_0x44b869[_0x338cd8(0x23f)]};_0x4781cc&&(_0x5735ca['retry']=0x1e,_0x5735ca['expire']=0xe10,_0x5735ca[_0x338cd8(0x2c0)]=_0x338cd8(0x2a4)),await this[_0x338cd8(0x249)](_0x44b869[_0x338cd8(0x266)],_0x338cd8(0x261),_0x5735ca),_0x328916++;}return _0x44b869['notifyEmailEnabled']&&_0x44b869[_0x338cd8(0x237)]&&(await this[_0x338cd8(0x249)](_0x44b869['notifyEmailInstance'],_0x338cd8(0x261),{'text':_0x3035c2,'to':_0x44b869['notifyEmailRecipient']}),_0x328916++),_0x44b869[_0x338cd8(0x28b)]&&_0x44b869[_0x338cd8(0x2e6)]&&(await this['sendToAsync'](_0x44b869[_0x338cd8(0x2e6)],_0x338cd8(0x261),{'text':_0x3035c2,'phone':_0x44b869[_0x338cd8(0x274)]}),_0x328916++),_0x44b869[_0x338cd8(0x20d)]&&_0x44b869[_0x338cd8(0x2fe)]&&(await this[_0x338cd8(0x249)](_0x44b869['notifySignalInstance'],'send',{'text':_0x3035c2,'phone':_0x44b869[_0x338cd8(0x251)]}),_0x328916++),_0x328916;}async[a0_0x23471d(0x1ef)](){const _0x56f81f=a0_0x23471d;try{const _0x5ebe0f=await this[_0x56f81f(0x209)](LTM_DP_RAW_LOG);if(_0x5ebe0f&&_0x5ebe0f[_0x56f81f(0x268)])this[_0x56f81f(0x25a)]=JSON['parse'](_0x5ebe0f['val']);}catch(_0x5d7cb0){this[_0x56f81f(0x25a)]=[];}}async[a0_0x23471d(0x1d4)](){const _0x4ff96e=a0_0x23471d;this[_0x4ff96e(0x25a)][_0x4ff96e(0x28e)]>RAW_LOG_MAX_SIZE&&this[_0x4ff96e(0x25a)][_0x4ff96e(0x1d2)](0x0,this[_0x4ff96e(0x25a)][_0x4ff96e(0x28e)]-RAW_LOG_MAX_SIZE),await this['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x4ff96e(0x1fa)](this['rawEventLog']),'ack':!![]});}async[a0_0x23471d(0x21b)](){const _0xd0cf0=a0_0x23471d;try{const _0x3c9b16=await this[_0xd0cf0(0x209)](LTM_DP_DAILY_DIGESTS);if(_0x3c9b16&&_0x3c9b16[_0xd0cf0(0x268)])this[_0xd0cf0(0x20f)]=JSON['parse'](_0x3c9b16[_0xd0cf0(0x268)]);}catch(_0x33ca88){this[_0xd0cf0(0x20f)]=[];}await this[_0xd0cf0(0x1cf)]();}async[a0_0x23471d(0x253)](_0x407c52=!![]){const _0x16495c=a0_0x23471d,_0x3aad74=this[_0x16495c(0x201)][_0x16495c(0x2c1)]||0x3c;this[_0x16495c(0x20f)][_0x16495c(0x28e)]>_0x3aad74&&this[_0x16495c(0x20f)]['splice'](0x0,this[_0x16495c(0x20f)][_0x16495c(0x28e)]-_0x3aad74);await this[_0x16495c(0x1c8)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x16495c(0x1fa)](this['dailyDigests']),'ack':!![]});if(_0x407c52)await this['updateBaselineStatus']();}[a0_0x23471d(0x214)](){const _0x3c229e=a0_0x23471d;if(this['ltmJob'])this[_0x3c229e(0x28d)][_0x3c229e(0x2ff)]();if(!this['isProVersion']){this[_0x3c229e(0x1c8)](LTM_DP_STATUS,{'val':_0x3c229e(0x27f),'ack':!![]});return;}this[_0x3c229e(0x28d)]=schedule['scheduleJob'](LTM_SCHEDULE,()=>this[_0x3c229e(0x204)]());}[a0_0x23471d(0x20c)](){const _0x28760d=a0_0x23471d;if(this[_0x28760d(0x2c9)])clearInterval(this['driftAnalysisTimer']);if(!this[_0x28760d(0x1e8)])return;this[_0x28760d(0x2c9)]=setInterval(()=>this[_0x28760d(0x294)](),(this['config'][_0x28760d(0x26d)]||0x18)*0x36ee80),setTimeout(()=>this[_0x28760d(0x294)](),0x1388);}async[a0_0x23471d(0x216)](){const _0x4eefbd=a0_0x23471d;await this[_0x4eefbd(0x1c8)]('analysis.activitySummary',{'val':_0x4eefbd(0x291),'ack':!![]}),await this[_0x4eefbd(0x1c8)](_0x4eefbd(0x26f),{'val':this[_0x4eefbd(0x1e8)]?'N/A\x20(No\x20Activity)':'N/A\x20(Pro\x20Feature)','ack':!![]}),await this[_0x4eefbd(0x1c8)](_0x4eefbd(0x29c),{'val':![],'ack':!![]}),await this[_0x4eefbd(0x1c8)](_0x4eefbd(0x254),{'val':![],'ack':!![]}),this[_0x4eefbd(0x2b8)]=![];}async[a0_0x23471d(0x29f)](_0x1e72ac){const _0x1232a8=a0_0x23471d;this[_0x1232a8(0x284)][_0x1232a8(0x2b9)](_0x1e72ac);if(this['analysisHistory'][_0x1232a8(0x28e)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x1232a8(0x284)]['pop']();await this[_0x1232a8(0x1c8)](_0x1232a8(0x290),{'val':JSON[_0x1232a8(0x1fa)](this[_0x1232a8(0x284)]),'ack':!![]});}[a0_0x23471d(0x2e8)](){const _0x3e8fd7=a0_0x23471d;if(this['modeResetJob'])this[_0x3e8fd7(0x2cd)][_0x3e8fd7(0x2ff)]();this[_0x3e8fd7(0x2cd)]=schedule[_0x3e8fd7(0x2db)](MODE_RESET_SCHEDULE,async()=>{const _0x319dfb=_0x3e8fd7;await this[_0x319dfb(0x2e1)](),AUTO_RESET_MODES[_0x319dfb(0x273)](this['currentSystemMode'])&&await this[_0x319dfb(0x1c8)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}async[a0_0x23471d(0x1cf)](){const _0x3947c2=a0_0x23471d;if(!this[_0x3947c2(0x1e8)]){await this[_0x3947c2(0x1c8)](LTM_DP_BASELINE_STATUS,{'val':_0x3947c2(0x27f),'ack':!![]});return;}const _0x252c3a=this[_0x3947c2(0x20f)][_0x3947c2(0x28e)]>=(this[_0x3947c2(0x201)][_0x3947c2(0x304)]||0x7)?'Aktiv\x20('+this[_0x3947c2(0x20f)][_0x3947c2(0x28e)]+_0x3947c2(0x275):'Lernphase\x20('+this[_0x3947c2(0x20f)][_0x3947c2(0x28e)]+'/'+(this[_0x3947c2(0x201)]['minDaysForBaseline']||0x7)+')';await this[_0x3947c2(0x1c8)](LTM_DP_BASELINE_STATUS,{'val':_0x252c3a,'ack':!![]});}async[a0_0x23471d(0x1dc)](){const _0x44798b=a0_0x23471d;await this['extendObjectAsync']('LTM',{'type':'channel','common':{'name':_0x44798b(0x2b3)},'native':{}}),await this[_0x44798b(0x241)](LTM_DP_RAW_LOG,{'type':'state','common':{'name':_0x44798b(0x1bc),'type':_0x44798b(0x224),'role':_0x44798b(0x239),'read':!![],'write':![]},'native':{}}),await this[_0x44798b(0x241)](LTM_DP_DAILY_DIGESTS,{'type':_0x44798b(0x2ee),'common':{'name':_0x44798b(0x1ca),'type':_0x44798b(0x224),'role':_0x44798b(0x239),'read':!![],'write':![]},'native':{}}),await this[_0x44798b(0x241)](LTM_DP_STATUS,{'type':'state','common':{'name':_0x44798b(0x303),'type':'string','role':_0x44798b(0x246),'read':!![],'write':![]},'native':{}}),await this[_0x44798b(0x241)](LTM_DP_TRIGGER_DIGEST,{'type':'state','common':{'name':_0x44798b(0x2ca),'type':_0x44798b(0x2ac),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this['extendObjectAsync'](LTM_DP_BASELINE_STATUS,{'type':_0x44798b(0x2ee),'common':{'name':'Baseline\x20Status','type':_0x44798b(0x224),'role':'text','read':!![],'write':![]},'native':{}});}async[a0_0x23471d(0x2f6)](){const _0x27f4dc=a0_0x23471d;await this[_0x27f4dc(0x241)](LTM_DP_DRIFT_CHANNEL,{'type':_0x27f4dc(0x217),'common':{'name':_0x27f4dc(0x1f4)},'native':{}}),await this[_0x27f4dc(0x241)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x27f4dc(0x2c5),'type':_0x27f4dc(0x224),'role':_0x27f4dc(0x2ee),'read':!![],'write':![],'def':_0x27f4dc(0x2cf)},'native':{}}),await this[_0x27f4dc(0x241)](LTM_DP_DRIFT_DETAILS,{'type':_0x27f4dc(0x2ee),'common':{'name':'Drift\x20Details','type':'string','role':_0x27f4dc(0x246),'read':!![],'write':![]},'native':{}}),await this[_0x27f4dc(0x241)](LTM_DP_DRIFT_LAST_CHECK,{'type':_0x27f4dc(0x2ee),'common':{'name':'Last\x20Check','type':'number','role':_0x27f4dc(0x2e7),'read':!![],'write':![]},'native':{}});}async[a0_0x23471d(0x294)](){const _0x2c7f90=a0_0x23471d;if(!this[_0x2c7f90(0x1e8)]||!this[_0x2c7f90(0x218)])return;const _0x22ea7f=this['config'][_0x2c7f90(0x297)]||0xe;if(this[_0x2c7f90(0x20f)][_0x2c7f90(0x28e)]<_0x22ea7f+(this['config'][_0x2c7f90(0x304)]||0x7)){await this[_0x2c7f90(0x1c8)](LTM_DP_DRIFT_STATUS,{'val':_0x2c7f90(0x212),'ack':!![]});return;}const _0x4059da=this[_0x2c7f90(0x20f)]['slice'](-_0x22ea7f),_0xb2114=this['dailyDigests'][_0x2c7f90(0x28a)](0x0,this[_0x2c7f90(0x20f)][_0x2c7f90(0x28e)]-_0x22ea7f),_0x372aa1=_0x2c7f90(0x205)+JSON[_0x2c7f90(0x1fa)](_0xb2114)+'\x0a\x0aA\x20(STB):\x0a'+JSON[_0x2c7f90(0x1fa)](_0x4059da);try{const _0xb35827=await this[_0x2c7f90(0x218)][_0x2c7f90(0x29e)](_0x372aa1),_0x280c0e=JSON[_0x2c7f90(0x2ad)](_0xb35827[_0x2c7f90(0x1de)][_0x2c7f90(0x246)]()[_0x2c7f90(0x298)](/```json|```/g,'')[_0x2c7f90(0x211)]());_0x280c0e[_0x2c7f90(0x22d)]&&(await this[_0x2c7f90(0x1c8)](LTM_DP_DRIFT_STATUS,{'val':_0x280c0e['baselineDrift'],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x280c0e[_0x2c7f90(0x1e4)],'ack':!![]}),await this[_0x2c7f90(0x1c8)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x2c7f90(0x2bb)](),'ack':!![]}));}catch(_0x35b01d){}}async[a0_0x23471d(0x2e1)](){const _0x417658=a0_0x23471d;try{const _0x117609=await this[_0x417658(0x209)](SYSTEM_DP_MODE);_0x117609&&_0x117609[_0x417658(0x268)]&&Object[_0x417658(0x2b6)](SYSTEM_MODES)[_0x417658(0x273)](_0x117609[_0x417658(0x268)])?this[_0x417658(0x2de)]=_0x117609[_0x417658(0x268)]:(this[_0x417658(0x2de)]=SYSTEM_MODES[_0x417658(0x2b1)],await this[_0x417658(0x1c8)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x417658(0x2b1)],'ack':!![]}));}catch(_0x3b4b03){this[_0x417658(0x2de)]=SYSTEM_MODES[_0x417658(0x2b1)];}}async[a0_0x23471d(0x2bd)](){const _0x50ca28=a0_0x23471d;try{const _0x3ace0c=await this[_0x50ca28(0x277)](_0x50ca28(0x202));if(_0x3ace0c&&_0x3ace0c[_0x50ca28(0x20b)]&&_0x3ace0c[_0x50ca28(0x20b)][_0x50ca28(0x2e9)])return _0x3ace0c[_0x50ca28(0x20b)][_0x50ca28(0x2e9)];return _0x50ca28(0x1c1);}catch(_0x3f2947){return'uuid-error';}}async['checkLicense'](_0x58e283){const _0x2ba646=a0_0x23471d;if(!_0x58e283)return![];this[_0x2ba646(0x260)]=await this[_0x2ba646(0x2bd)]();if(_0x58e283===_0x2ba646(0x1ed)||_0x58e283[_0x2ba646(0x236)](_0x2ba646(0x272)))return!![];return![];}['onUnload'](_0x2e2ac2){const _0x4e63c3=a0_0x23471d;if(this[_0x4e63c3(0x2be)])clearInterval(this[_0x4e63c3(0x2be)]);if(this[_0x4e63c3(0x2c9)])clearInterval(this['driftAnalysisTimer']);if(this[_0x4e63c3(0x28d)])this[_0x4e63c3(0x28d)][_0x4e63c3(0x2ff)]();if(this[_0x4e63c3(0x2cd)])this['modeResetJob'][_0x4e63c3(0x2ff)]();if(this[_0x4e63c3(0x30b)])clearTimeout(this[_0x4e63c3(0x30b)]);if(this[_0x4e63c3(0x2f0)])clearTimeout(this[_0x4e63c3(0x2f0)]);_0x2e2ac2();}async[a0_0x23471d(0x222)](_0x2daab5){const _0x5b9c9c=a0_0x23471d;if(typeof _0x2daab5===_0x5b9c9c(0x1e1)&&_0x2daab5[_0x5b9c9c(0x1e7)]){if(_0x2daab5[_0x5b9c9c(0x2e2)]==='testApiKey'){if(!_0x2daab5[_0x5b9c9c(0x1e7)][_0x5b9c9c(0x264)])return this[_0x5b9c9c(0x24e)](_0x2daab5[_0x5b9c9c(0x235)],_0x2daab5[_0x5b9c9c(0x2e2)],{'success':![],'message':_0x5b9c9c(0x283)},_0x2daab5[_0x5b9c9c(0x247)]);try{const _0x1b4074=new GoogleGenerativeAI(_0x2daab5[_0x5b9c9c(0x1e7)][_0x5b9c9c(0x264)])[_0x5b9c9c(0x279)]({'model':_0x5b9c9c(0x240)});await _0x1b4074['generateContent'](_0x5b9c9c(0x2cc)),this[_0x5b9c9c(0x24e)](_0x2daab5[_0x5b9c9c(0x235)],_0x2daab5[_0x5b9c9c(0x2e2)],{'success':!![],'message':_0x5b9c9c(0x248)},_0x2daab5['callback']);}catch(_0x5f0655){this['sendTo'](_0x2daab5[_0x5b9c9c(0x235)],_0x2daab5[_0x5b9c9c(0x2e2)],{'success':![],'message':_0x5f0655[_0x5b9c9c(0x1e7)]},_0x2daab5[_0x5b9c9c(0x247)]);}}else{if(_0x2daab5['command']===_0x5b9c9c(0x1ee)){const _0x11aa11=await this[_0x5b9c9c(0x1f8)](_0x5b9c9c(0x26a),!![]);this[_0x5b9c9c(0x24e)](_0x2daab5[_0x5b9c9c(0x235)],_0x2daab5[_0x5b9c9c(0x2e2)],{'success':_0x11aa11>0x0,'message':_0x11aa11+_0x5b9c9c(0x1e5)},_0x2daab5[_0x5b9c9c(0x247)]);}else{if(_0x2daab5[_0x5b9c9c(0x2e2)]===_0x5b9c9c(0x2f2)){if(!this['isProVersion'])return this['sendTo'](_0x2daab5['from'],_0x2daab5['command'],{'success':![],'isPro':![]},_0x2daab5[_0x5b9c9c(0x247)]);let _0x2464ef={'status':_0x5b9c9c(0x2cf),'details':'','lastCheck':0x0};try{_0x2464ef['status']=(await this['getStateAsync'](LTM_DP_DRIFT_STATUS))['val'],_0x2464ef[_0x5b9c9c(0x2ba)]=(await this[_0x5b9c9c(0x209)](LTM_DP_DRIFT_DETAILS))['val'],_0x2464ef[_0x5b9c9c(0x302)]=(await this['getStateAsync'](LTM_DP_DRIFT_LAST_CHECK))[_0x5b9c9c(0x268)];}catch(_0x3d09df){}this['sendTo'](_0x2daab5[_0x5b9c9c(0x235)],_0x2daab5[_0x5b9c9c(0x2e2)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x5b9c9c(0x20f)],'driftAnalysis':_0x2464ef,'analysisHistory':this[_0x5b9c9c(0x284)]},_0x2daab5[_0x5b9c9c(0x247)]);}else{if(_0x2daab5[_0x5b9c9c(0x2e2)]===_0x5b9c9c(0x2fb)){const _0x435c52=await this[_0x5b9c9c(0x1d7)]('enum.functions.*',_0x5b9c9c(0x200)),_0x8e0f35=[];if(_0x435c52)for(const _0x295632 in _0x435c52){const _0x2de790=_0x435c52[_0x295632],_0x3cd8b8=(_0x2de790[_0x5b9c9c(0x1bf)]&&typeof _0x2de790[_0x5b9c9c(0x1bf)][_0x5b9c9c(0x1c0)]==='object'?_0x2de790[_0x5b9c9c(0x1bf)][_0x5b9c9c(0x1c0)]['de']:_0x2de790['common'][_0x5b9c9c(0x1c0)])||_0x2de790[_0x5b9c9c(0x1bf)][_0x5b9c9c(0x1c0)];_0x8e0f35['push']({'id':_0x295632,'name':_0x3cd8b8});}this[_0x5b9c9c(0x24e)](_0x2daab5[_0x5b9c9c(0x235)],_0x2daab5['command'],{'success':!![],'enums':_0x8e0f35},_0x2daab5[_0x5b9c9c(0x247)]);}else{if(_0x2daab5['command']===_0x5b9c9c(0x1da)){this['log'][_0x5b9c9c(0x1fb)](_0x5b9c9c(0x2c2));const _0x2b3cf5=_0x2daab5['message']||{};try{const _0x517a67=await this['scanForDevices'](_0x2b3cf5);this[_0x5b9c9c(0x24e)](_0x2daab5[_0x5b9c9c(0x235)],_0x2daab5['command'],{'success':!![],'devices':_0x517a67},_0x2daab5[_0x5b9c9c(0x247)]);}catch(_0x274c1f){this[_0x5b9c9c(0x24e)](_0x2daab5[_0x5b9c9c(0x235)],_0x2daab5[_0x5b9c9c(0x2e2)],{'success':![],'error':_0x274c1f[_0x5b9c9c(0x1e7)]},_0x2daab5[_0x5b9c9c(0x247)]);}}else{if(_0x2daab5[_0x5b9c9c(0x2e2)]==='submitFeedback'){const {historyId:_0x3f96c3,rating:_0x2f3a53,comment:_0x245673,alertReason:_0x177d07}=_0x2daab5['message'];_0x3f96c3&&_0x2f3a53?(await this[_0x5b9c9c(0x30a)]({'timestamp':Date[_0x5b9c9c(0x2bb)](),'historyId':_0x3f96c3,'rating':_0x2f3a53,'comment':_0x245673,'alertReason':_0x177d07}),this[_0x5b9c9c(0x24e)](_0x2daab5[_0x5b9c9c(0x235)],_0x2daab5[_0x5b9c9c(0x2e2)],{'success':!![]},_0x2daab5[_0x5b9c9c(0x247)])):this['sendTo'](_0x2daab5[_0x5b9c9c(0x235)],_0x2daab5[_0x5b9c9c(0x2e2)],{'success':![],'error':_0x5b9c9c(0x1e9)},_0x2daab5[_0x5b9c9c(0x247)]);}}}}}}}}}if(require['main']!==module)module[a0_0x23471d(0x24d)]=_0x5ad554=>new CogniLiving(_0x5ad554);else new CogniLiving();