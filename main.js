const a0_0x4a7c0f=a0_0x28f4;(function(_0x3de456,_0x26610a){const _0x28cdc4=a0_0x28f4,_0x339997=_0x3de456();while(!![]){try{const _0x36681f=-parseInt(_0x28cdc4(0x18f))/0x1+parseInt(_0x28cdc4(0x126))/0x2+parseInt(_0x28cdc4(0x18e))/0x3+parseInt(_0x28cdc4(0x215))/0x4*(-parseInt(_0x28cdc4(0x16f))/0x5)+-parseInt(_0x28cdc4(0x19d))/0x6+parseInt(_0x28cdc4(0x193))/0x7*(parseInt(_0x28cdc4(0x210))/0x8)+-parseInt(_0x28cdc4(0x28c))/0x9*(-parseInt(_0x28cdc4(0x201))/0xa);if(_0x36681f===_0x26610a)break;else _0x339997['push'](_0x339997['shift']());}catch(_0x558c6e){_0x339997['push'](_0x339997['shift']());}}}(a0_0xd0bf,0x8e377));const a0_0x5afa3f=(function(){let _0x4687e1=!![];return function(_0x22dbb1,_0x5eb901){const _0x3db5b3=_0x4687e1?function(){if(_0x5eb901){const _0x439039=_0x5eb901['apply'](_0x22dbb1,arguments);return _0x5eb901=null,_0x439039;}}:function(){};return _0x4687e1=![],_0x3db5b3;};}()),a0_0x3365cb=a0_0x5afa3f(this,function(){const _0xb2fda5=a0_0x28f4;return a0_0x3365cb[_0xb2fda5(0x16a)]()[_0xb2fda5(0x185)](_0xb2fda5(0x293))[_0xb2fda5(0x16a)]()[_0xb2fda5(0x27c)](a0_0x3365cb)[_0xb2fda5(0x185)]('(((.+)+)+)+$');});a0_0x3365cb();'use strict';const utils=require('@iobroker/adapter-core'),{GoogleGenerativeAI}=require(a0_0x4a7c0f(0x239)),schedule=require(a0_0x4a7c0f(0x177)),{spawn,exec,execSync}=require(a0_0x4a7c0f(0x287)),path=require(a0_0x4a7c0f(0x1fc)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x9c4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL=a0_0x4a7c0f(0x1aa),LTM_SCHEDULE='0\x203\x20*\x20*\x20*',MODE_RESET_SCHEDULE='0\x204\x20*\x20*\x20*',SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x4a7c0f(0x17d),LTM_DP_DAILY_DIGESTS=a0_0x4a7c0f(0x19f),LTM_DP_STATUS=a0_0x4a7c0f(0x1a6),LTM_DP_TRIGGER_DIGEST='LTM.triggerDailyDigest',LTM_DP_BASELINE_STATUS=a0_0x4a7c0f(0x1be),LTM_DP_DRIFT_CHANNEL=a0_0x4a7c0f(0x189),LTM_DP_DRIFT_STATUS=a0_0x4a7c0f(0x209),LTM_DP_DRIFT_DETAILS=a0_0x4a7c0f(0x136),LTM_DP_DRIFT_LAST_CHECK='LTM.driftAnalysis.lastCheck',SYSTEM_DP_MODE=a0_0x4a7c0f(0x232),SYSTEM_MODES={'NORMAL':'normal','VACATION':a0_0x4a7c0f(0x1ef),'PARTY':a0_0x4a7c0f(0x2a3),'GUEST':'guest'},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x4a7c0f(0x1df)],SYSTEM_MODES[a0_0x4a7c0f(0x2a1)]],PERSONA_MAPPING={'generic':a0_0x4a7c0f(0x224),'senior_aal':a0_0x4a7c0f(0x1f6),'family':a0_0x4a7c0f(0x162),'single_comfort':a0_0x4a7c0f(0x163),'security':'PRIORIT√ÑT:\x20Sicherheit.'},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process[a0_0x4a7c0f(0x1bc)]===a0_0x4a7c0f(0x2b7),PERSISTENT_DIR=path['join'](__dirname,a0_0x4a7c0f(0x265)),VENV_PATH=PERSISTENT_DIR,PYTHON_EXE=IS_WIN?path['join'](VENV_PATH,'Scripts',a0_0x4a7c0f(0x26b)):path['join'](VENV_PATH,a0_0x4a7c0f(0x18c),a0_0x4a7c0f(0x10f)),PIP_EXE=IS_WIN?path['join'](VENV_PATH,'Scripts',a0_0x4a7c0f(0x11f)):path[a0_0x4a7c0f(0x27e)](VENV_PATH,'bin',a0_0x4a7c0f(0x17c));let activeSequence=[],sequenceTimer=null;function stopPythonService(_0x5e1ba7){const _0x206065=a0_0x4a7c0f;if(_0x5e1ba7[_0x206065(0x1bf)]){try{_0x5e1ba7[_0x206065(0x1bf)]['kill']();}catch(_0x4f26eb){}_0x5e1ba7[_0x206065(0x1bf)]=null;}}function sendToPython(_0x35f787,_0x1dc610,_0x192c9f={}){const _0x5d89a7=a0_0x4a7c0f;if(!_0x35f787[_0x5d89a7(0x1bf)]||!_0x35f787[_0x5d89a7(0x1bf)][_0x5d89a7(0x167)][_0x5d89a7(0x253)])return;const _0x4dabca=JSON['stringify']({'command':_0x1dc610,..._0x192c9f});try{_0x35f787[_0x5d89a7(0x1bf)]['stdin'][_0x5d89a7(0x130)](_0x4dabca+'\x0a');}catch(_0x270d02){}}function handlePythonResult(_0x2cc18a,_0x2658e3){const _0x471443=a0_0x4a7c0f;if(_0x2658e3[_0x471443(0x18b)]===_0x471443(0x214))_0x2cc18a[_0x471443(0x252)]['debug'](_0x471443(0x266));else{if(_0x2658e3[_0x471443(0x18b)]===_0x471443(0x26e)){const {anomaly_score:_0x41ea48,is_anomaly:_0x44db82,threshold:_0x2b953e,explanation:_0x3bff31}=_0x2658e3[_0x471443(0x14f)];_0x2cc18a[_0x471443(0x252)][_0x471443(0x235)](_0x471443(0x1b9)+_0x41ea48[_0x471443(0x260)](0x5)+_0x471443(0x258)+(_0x44db82?_0x471443(0x1d3):'OK')),_0x2cc18a[_0x471443(0x230)](_0x471443(0x23d),{'val':_0x41ea48,'ack':!![]}),_0x2cc18a[_0x471443(0x230)]('analysis.security.lastCheck',{'val':new Date()[_0x471443(0x23e)](),'ack':!![]});if(_0x2b953e)_0x2cc18a[_0x471443(0x230)]('analysis.security.currentThreshold',{'val':_0x2b953e,'ack':!![]});if(_0x44db82){let _0x269083=_0x471443(0x14c)+_0x41ea48[_0x471443(0x260)](0x4)+')';if(_0x3bff31&&_0x3bff31!==_0x471443(0x29e))_0x269083+=_0x471443(0x1b1)+_0x3bff31;_0x2cc18a[_0x471443(0x230)]('analysis.isAlert',{'val':!![],'ack':!![]}),_0x2cc18a['setStateAsync'](_0x471443(0x28d),{'val':_0x269083,'ack':!![]}),sendNotification(_0x2cc18a,_0x471443(0x1c5)+_0x269083,![],!![]);}}else{if(_0x2658e3[_0x471443(0x18b)]===_0x471443(0x14b)){const _0x4e9c7e=_0x2658e3['payload'][_0x471443(0x2a9)]||'',_0x334fc7=_0x2658e3['payload'][_0x471443(0x195)],_0x2f1f24=_0x2658e3[_0x471443(0x14f)]['success']?_0x471443(0x2a5)+new Date()[_0x471443(0x138)]()+'\x20('+_0x4e9c7e+')':_0x471443(0x192)+_0x2658e3[_0x471443(0x14f)][_0x471443(0x236)];_0x2cc18a[_0x471443(0x230)](_0x471443(0x262),{'val':_0x2f1f24,'ack':!![]});if(_0x2658e3[_0x471443(0x14f)]['success']&&_0x334fc7)_0x2cc18a[_0x471443(0x230)](_0x471443(0x1c9),{'val':_0x334fc7,'ack':!![]});}else{if(_0x2658e3['type']===_0x471443(0x2af)){const {patterns:_0xdf4197}=_0x2658e3['payload'];if(_0xdf4197&&_0xdf4197['length']>0x0){_0x2cc18a[_0x471443(0x252)][_0x471443(0x235)](_0x471443(0x208)+_0xdf4197[_0x471443(0x241)]+_0x471443(0x159)),_0x2cc18a[_0x471443(0x230)](_0x471443(0x15c),{'val':JSON[_0x471443(0x267)](_0xdf4197),'ack':!![]});const _0x4c36bd=_0xdf4197[0x0],_0x2a833e=_0x471443(0x12e)+_0x4c36bd[_0x471443(0x1b6)]+'\x20('+(_0x4c36bd[_0x471443(0x257)]*0x64)[_0x471443(0x260)](0x0)+'%)';_0x2cc18a[_0x471443(0x230)](_0x471443(0x12c),{'val':!![],'ack':!![]}),_0x2cc18a[_0x471443(0x230)](_0x471443(0x284),{'val':_0x2a833e,'ack':!![]});}else _0x2cc18a[_0x471443(0x252)][_0x471443(0x235)]('üõãÔ∏è\x20BUTLER:\x20Keine\x20neuen\x20Muster\x20gefunden.'),_0x2cc18a['setStateAsync'](_0x471443(0x12c),{'val':![],'ack':!![]}),_0x2cc18a[_0x471443(0x230)](_0x471443(0x15c),{'val':'[]','ack':!![]});}else{if(_0x2658e3[_0x471443(0x18b)]==='ENERGY_TRAIN_RESULT'){if(_0x2658e3[_0x471443(0x14f)]['success'])try{const _0x5a6572=JSON[_0x471443(0x12d)](_0x2658e3[_0x471443(0x14f)][_0x471443(0x2a9)]);if(_0x5a6572[_0x471443(0x194)])_0x2cc18a[_0x471443(0x230)](_0x471443(0x1ac),{'val':JSON['stringify'](_0x5a6572['insulation']),'ack':!![]});if(_0x5a6572[_0x471443(0x166)])_0x2cc18a[_0x471443(0x230)]('analysis.energy.heatingScore',{'val':JSON[_0x471443(0x267)](_0x5a6572['heating']),'ack':!![]});}catch(_0x2f302d){}}else{if(_0x2658e3[_0x471443(0x18b)]===_0x471443(0x175)){if(_0x2658e3[_0x471443(0x14f)][_0x471443(0x1c2)])_0x2cc18a[_0x471443(0x252)]['info']('‚úÖ\x20HEALTH\x20TRAINED.');}else{if(_0x2658e3[_0x471443(0x18b)]===_0x471443(0x1e5))_0x2cc18a[_0x471443(0x230)](_0x471443(0x180),{'val':new Date()[_0x471443(0x23e)](),'ack':!![]}),_0x2cc18a[_0x471443(0x230)](_0x471443(0x1bb),{'val':_0x2658e3[_0x471443(0x14f)][_0x471443(0x1cd)],'ack':!![]});else{if(_0x2658e3[_0x471443(0x18b)]===_0x471443(0x2a7))_0x2cc18a['setStateAsync'](_0x471443(0x22c),{'val':_0x2658e3[_0x471443(0x14f)][_0x471443(0x1d5)],'ack':!![]}),_0x2cc18a[_0x471443(0x230)](_0x471443(0x1c7),{'val':_0x2658e3[_0x471443(0x14f)][_0x471443(0x1ec)],'ack':!![]});else{if(_0x2658e3[_0x471443(0x18b)]===_0x471443(0x20f)){const {speed_trend:_0x1f7257}=_0x2658e3['payload'];if(_0x1f7257!==undefined)_0x2cc18a[_0x471443(0x230)]('analysis.health.gaitSpeed',{'val':_0x1f7257,'ack':!![]});}else{if(_0x2658e3[_0x471443(0x18b)]===_0x471443(0x1fe)){const {forecast:_0x46cb32}=_0x2658e3[_0x471443(0x14f)];if(_0x46cb32)_0x2cc18a['setStateAsync'](_0x471443(0x1ea),{'val':JSON[_0x471443(0x267)](_0x46cb32),'ack':!![]});}else{if(_0x2658e3[_0x471443(0x18b)]===_0x471443(0x212)){const {data:_0xc53339}=_0x2658e3['payload'];_0xc53339&&(_0x2cc18a[_0x471443(0x252)]['info'](_0x471443(0x25c)),_0x2cc18a[_0x471443(0x230)]('analysis.security.topologyMatrix',{'val':JSON['stringify'](_0xc53339),'ack':!![]}));}}}}}}}}}}}}function startPythonService(_0x4e1feb){const _0xa06140=a0_0x4a7c0f;let _0xa319f5='python3';if(fs['existsSync'](PYTHON_EXE))_0xa319f5=PYTHON_EXE;try{const _0x184e79=path[_0xa06140(0x27e)](__dirname,_0xa06140(0x1c6),_0xa06140(0x276));_0x4e1feb[_0xa06140(0x1bf)]=spawn(_0xa319f5,[_0x184e79]),_0x4e1feb['pythonProcess'][_0xa06140(0x25b)]['on'](_0xa06140(0x2a6),_0x206210=>{const _0x4f5489=_0xa06140,_0x2efb8=_0x206210[_0x4f5489(0x16a)]()['split']('\x0a');_0x2efb8[_0x4f5489(0x24f)](_0x43862f=>{const _0x351df7=_0x4f5489,_0x235980=_0x43862f[_0x351df7(0x1af)]();if(!_0x235980)return;if(_0x235980[_0x351df7(0x1c3)](_0x351df7(0x12b)))_0x4e1feb[_0x351df7(0x252)][_0x351df7(0x1d4)](_0x351df7(0x1ff)+_0x235980[_0x351df7(0x22b)](0x5)[_0x351df7(0x1af)]());else{if(_0x235980[_0x351df7(0x1c3)]('[RESULT]'))try{const _0x1e9d35=JSON[_0x351df7(0x12d)](_0x235980[_0x351df7(0x22b)](0x8)[_0x351df7(0x1af)]());handlePythonResult(_0x4e1feb,_0x1e9d35);}catch(_0x3c68e6){}}});}),_0x4e1feb['pythonProcess']['on']('close',_0x110eca=>{const _0x27e7af=_0xa06140;_0x4e1feb[_0x27e7af(0x1bf)]=null;});}catch(_0x24fe09){_0x4e1feb[_0xa06140(0x252)][_0xa06140(0x25d)](_0xa06140(0x220)+_0x24fe09[_0xa06140(0x1e7)]);}}function installRequirementsInVenv(_0xf94e32,_0x16c14d){const _0x53cdad=a0_0x4a7c0f;_0xf94e32[_0x53cdad(0x252)]['info'](_0x53cdad(0x23a));const _0x3168d9='\x22'+PIP_EXE+'\x22\x20install\x20-r\x20\x22'+_0x16c14d+'\x22';exec(_0x3168d9,{'timeout':0x1b7740},(_0x14ad0a,_0x184700,_0x166716)=>{const _0x343c1b=_0x53cdad;_0xf94e32[_0x343c1b(0x2a8)]=![];if(_0x14ad0a){_0xf94e32[_0x343c1b(0x252)][_0x343c1b(0x25d)]('‚ùå\x20INSTALL\x20FAILED:\x20'+(_0x166716||_0x14ad0a[_0x343c1b(0x1e7)]));try{fs[_0x343c1b(0x259)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x1fd32b){}}else _0xf94e32['log'][_0x343c1b(0x235)](_0x343c1b(0x158)),startSystem(_0xf94e32);});}function installPythonDependencies(_0x433a3a){const _0x538d48=a0_0x4a7c0f;if(_0x433a3a[_0x538d48(0x2a8)])return;_0x433a3a[_0x538d48(0x2a8)]=!![];const _0x4a3033=path['join'](__dirname,_0x538d48(0x1c6),_0x538d48(0x1d8));stopPythonService(_0x433a3a);if(fs[_0x538d48(0x1ca)](VENV_PATH)&&!fs[_0x538d48(0x1ca)](PIP_EXE)){_0x433a3a[_0x538d48(0x252)]['warn'](_0x538d48(0x147));try{fs['rmSync'](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x4e88af){_0x433a3a[_0x538d48(0x252)][_0x538d48(0x25d)](_0x538d48(0x16d)+_0x4e88af['message']);}}if(!fs['existsSync'](VENV_PATH))try{_0x433a3a[_0x538d48(0x252)][_0x538d48(0x235)](_0x538d48(0x204)),execSync(_0x538d48(0x174)+VENV_PATH+'\x22');}catch(_0x38e941){_0x433a3a[_0x538d48(0x2a8)]=![];_0x38e941['message'][_0x538d48(0x1c8)]('EACCES')||_0x38e941[_0x538d48(0x1e7)][_0x538d48(0x1c8)](_0x538d48(0x1f2))?(_0x433a3a[_0x538d48(0x252)][_0x538d48(0x25d)](_0x538d48(0x269)),_0x433a3a[_0x538d48(0x252)]['error'](_0x538d48(0x139)+path['join'](__dirname))):_0x433a3a[_0x538d48(0x252)][_0x538d48(0x25d)](_0x538d48(0x223)+_0x38e941['message']+_0x538d48(0x274));return;}installRequirementsInVenv(_0x433a3a,_0x4a3033);}function checkAndInstall(_0x1c71cf){const _0x4a837f=a0_0x4a7c0f;if(fs[_0x4a837f(0x1ca)](PYTHON_EXE)&&fs[_0x4a837f(0x1ca)](PIP_EXE))try{return _0x1c71cf['log']['info'](_0x4a837f(0x290)),execSync('\x22'+PYTHON_EXE+'\x22\x20-c\x20\x22import\x20tensorflow;\x20print(\x27libs_ok\x27)\x22',{'timeout':0x3a98}),_0x1c71cf[_0x4a837f(0x252)][_0x4a837f(0x235)](_0x4a837f(0x18d)),!![];}catch(_0x4eb5d7){_0x1c71cf[_0x4a837f(0x252)]['warn']('‚ö†Ô∏è\x20Fast-Boot\x20failed.\x20Triggering\x20Self-Healing...');}else _0x1c71cf[_0x4a837f(0x252)][_0x4a837f(0x229)](_0x4a837f(0x28a));return installPythonDependencies(_0x1c71cf),![];}async function startSystem(_0x28afe5){const _0xbaca34=a0_0x4a7c0f;_0x28afe5[_0xbaca34(0x252)]['info']('üöÄ\x20Starting\x20NUUKANNI\x20Logic\x20(v0.12.4)...'),await initZombies(_0x28afe5);try{_0x28afe5[_0xbaca34(0x17b)]=await checkLicense(_0x28afe5[_0xbaca34(0x141)][_0xbaca34(0x1b5)]);}catch(_0x22ae28){}if(!_0x28afe5[_0xbaca34(0x141)][_0xbaca34(0x23c)]||_0x28afe5[_0xbaca34(0x141)][_0xbaca34(0x23c)]<0.1)_0x28afe5['config']['inactivityThresholdHours']=0xc;await initHistory(_0x28afe5),await initSystemConfig(_0x28afe5);if(_0x28afe5[_0xbaca34(0x141)][_0xbaca34(0x264)])try{_0x28afe5[_0xbaca34(0x222)]=new GoogleGenerativeAI(_0x28afe5[_0xbaca34(0x141)][_0xbaca34(0x264)]),_0x28afe5['geminiModel']=_0x28afe5['genAI'][_0xbaca34(0x277)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0xbaca34(0x1e0)}}),_0x28afe5[_0xbaca34(0x252)]['info'](_0xbaca34(0x2ae));}catch(_0x332b91){_0x28afe5['log'][_0xbaca34(0x25d)](_0xbaca34(0x128)+_0x332b91['message']);}await createAllObjects(_0x28afe5),await loadSystemMode(_0x28afe5),await loadRawEventLog(_0x28afe5),await loadDailyDigests(_0x28afe5),_0x28afe5[_0xbaca34(0x13f)]('analysis.trigger'),_0x28afe5['subscribeStates'](LTM_DP_TRIGGER_DIGEST),_0x28afe5['subscribeStates'](_0xbaca34(0x232)),_0x28afe5[_0xbaca34(0x13f)]('analysis.triggerBriefing'),_0x28afe5['subscribeStates'](_0xbaca34(0x23b)),_0x28afe5[_0xbaca34(0x13f)](_0xbaca34(0x127)),_0x28afe5[_0xbaca34(0x13f)](_0xbaca34(0x295)),_0x28afe5[_0xbaca34(0x13f)]('analysis.training.triggerHealth'),_0x28afe5[_0xbaca34(0x13f)](_0xbaca34(0x172)),_0x28afe5[_0xbaca34(0x13f)]('analysis.training.triggerComfort'),_0x28afe5[_0xbaca34(0x13f)](_0xbaca34(0x182)),await initSensorSubscriptions(_0x28afe5),await initPresenceSubscriptions(_0x28afe5),await setupTelegramListener(_0x28afe5),setTimeout(()=>checkWifiPresence(_0x28afe5),0x1388);if(_0x28afe5['analysisTimer'])clearInterval(_0x28afe5[_0xbaca34(0x296)]);const _0x394ba5=_0x28afe5['config'][_0xbaca34(0x1eb)]||0xf;_0x394ba5>0x0&&(_0x28afe5['analysisTimer']=setInterval(()=>{runAutopilot(_0x28afe5);},_0x394ba5*0x3c*0x3e8)),setupLtmScheduler(_0x28afe5),setupModeResetScheduler(_0x28afe5),setupDriftAnalysisScheduler(_0x28afe5),setupBriefingScheduler(_0x28afe5),startPythonService(_0x28afe5),setTimeout(()=>{const _0x556e0=_0xbaca34;_0x28afe5[_0x556e0(0x1bf)]&&(runPythonHealthCheck(_0x28afe5),triggerGaitAnalysis(_0x28afe5),triggerEnergyPrediction(_0x28afe5)),updateHealthVector(_0x28afe5);},0x1388);}async function runAutopilot(_0x1dde05){const _0x592a08=a0_0x4a7c0f;_0x1dde05[_0x592a08(0x252)][_0x592a08(0x1d4)](_0x592a08(0x11d)),await runGeminiAnalysis(_0x1dde05),updateHealthVector(_0x1dde05),triggerGaitAnalysis(_0x1dde05),triggerEnergyPrediction(_0x1dde05);}async function triggerGaitAnalysis(_0x41a791){const _0x2790bb=a0_0x4a7c0f;if(!_0x41a791[_0x2790bb(0x17b)])return;try{const _0x456390=await _0x41a791[_0x2790bb(0x1d1)](_0x2790bb(0x250));_0x456390&&_0x456390['val']&&sendToPython(_0x41a791,_0x2790bb(0x131),{'sequences':JSON['parse'](_0x456390[_0x2790bb(0x123)])});}catch(_0x32d654){}}async function triggerEnergyPrediction(_0x46ff40){const _0x53014d=a0_0x4a7c0f;if(!_0x46ff40['isProVersion'])return;try{const _0x4f7670=await getOutsideTemperatureNumeric(_0x46ff40);if(_0x4f7670===null)return;const _0x490bce={},_0x4fda66=_0x46ff40[_0x53014d(0x141)][_0x53014d(0x288)]||[];for(const _0x306e86 of _0x4fda66){if(_0x306e86[_0x53014d(0x18b)]==='temperature'&&_0x306e86[_0x53014d(0x216)]){const _0x3b80ac=_0x46ff40[_0x53014d(0x124)][_0x306e86['id']];if(_0x3b80ac!==undefined)_0x490bce[_0x306e86[_0x53014d(0x216)]]=_0x3b80ac;}}Object[_0x53014d(0x279)](_0x490bce)[_0x53014d(0x241)]>0x0&&sendToPython(_0x46ff40,_0x53014d(0x245),{'current_temps':_0x490bce,'t_out':_0x4f7670});}catch(_0x4f16e3){}}function updateHealthVector(_0x3179f1){const _0x45dc99=a0_0x4a7c0f;if(!_0x3179f1[_0x45dc99(0x22e)]||_0x3179f1['rawEventLog'][_0x45dc99(0x241)]===0x0)return;const _0x6a62da=new Array(0x60)[_0x45dc99(0x275)](0x0),_0x25f49a=new Date()[_0x45dc99(0x1de)](0x0,0x0,0x0,0x0);_0x3179f1[_0x45dc99(0x22e)][_0x45dc99(0x24f)](_0x540c70=>{const _0x4a5aec=_0x45dc99,_0x2577a7=new Date(_0x540c70[_0x4a5aec(0x273)]);if(_0x2577a7[_0x4a5aec(0x1e2)]()>=_0x25f49a){const _0x25e2fa=_0x2577a7['getHours'](),_0x1d5067=_0x2577a7[_0x4a5aec(0x16c)](),_0x192f68=_0x25e2fa*0x4+Math[_0x4a5aec(0x25f)](_0x1d5067/0xf);if(_0x192f68>=0x0&&_0x192f68<0x60)_0x6a62da[_0x192f68]++;}}),_0x3179f1[_0x45dc99(0x230)]('analysis.health.todayVector',{'val':JSON[_0x45dc99(0x267)](_0x6a62da),'ack':!![]});}async function scanForDevices(_0x5b41bd,_0x2506ad){const _0x23775f=a0_0x4a7c0f;_0x5b41bd[_0x23775f(0x252)][_0x23775f(0x235)](_0x23775f(0x243));const _0x2a07cb=[],_0xba0722=await _0x5b41bd[_0x23775f(0x225)]('*'),_0x451a7f={};try{const _0x2fe2f0=await _0x5b41bd[_0x23775f(0x225)]('enum.rooms.*',_0x23775f(0x116));for(const _0x95802b in _0x2fe2f0){const _0x50c2ef=_0x2fe2f0[_0x95802b],_0x335b39=(_0x50c2ef[_0x23775f(0x2b1)]&&typeof _0x50c2ef[_0x23775f(0x2b1)][_0x23775f(0x294)]===_0x23775f(0x115)?_0x50c2ef['common']['name']['de']:_0x50c2ef[_0x23775f(0x2b1)][_0x23775f(0x294)])||_0x50c2ef['common']['name'];if(_0x50c2ef['common']&&_0x50c2ef[_0x23775f(0x2b1)][_0x23775f(0x26a)])for(const _0x191dca of _0x50c2ef[_0x23775f(0x2b1)]['members']){_0x451a7f[_0x191dca]=_0x335b39;}}}catch(_0x1ad2ec){_0x5b41bd['log'][_0x23775f(0x229)](_0x23775f(0x146)+_0x1ad2ec['message']);}let _0x1cf577=null,_0x4ab874={};if(_0x2506ad[_0x23775f(0x227)]&&_0x2506ad[_0x23775f(0x227)]['length']>0x0){_0x1cf577=new Set();for(const _0x5211de of _0x2506ad['selectedFunctionIds']){const _0x14fa3e=await _0x5b41bd[_0x23775f(0x2aa)](_0x5211de);if(_0x14fa3e&&_0x14fa3e[_0x23775f(0x2b1)]&&_0x14fa3e[_0x23775f(0x2b1)][_0x23775f(0x26a)]){let _0x430b74=null;const _0x25904a=_0x5211de['toLowerCase']();if(_0x25904a[_0x23775f(0x1c8)](_0x23775f(0x271))||_0x25904a[_0x23775f(0x1c8)](_0x23775f(0x143)))_0x430b74=_0x23775f(0x271);else{if(_0x25904a[_0x23775f(0x1c8)]('heating')||_0x25904a[_0x23775f(0x1c8)](_0x23775f(0x1ab)))_0x430b74=_0x23775f(0x283);else{if(_0x25904a[_0x23775f(0x1c8)](_0x23775f(0x173))||_0x25904a[_0x23775f(0x1c8)](_0x23775f(0x21d)))_0x430b74=_0x23775f(0x129);}}for(const _0x4a5971 of _0x14fa3e[_0x23775f(0x2b1)][_0x23775f(0x26a)]){_0x1cf577[_0x23775f(0x2a2)](_0x4a5971);if(_0x430b74)_0x4ab874[_0x4a5971]=_0x430b74;}}}}for(const _0x785739 in _0xba0722){const _0x541640=_0xba0722[_0x785739];if(_0x541640&&_0x541640['common']&&_0x541640[_0x23775f(0x18b)]===_0x23775f(0x282)){if(_0x1cf577){let _0x12b8b9=_0x1cf577[_0x23775f(0x21c)](_0x785739);if(!_0x12b8b9){const _0x30e786=_0x785739[_0x23775f(0x24b)]('.'),_0x256602=_0x30e786[_0x23775f(0x29f)](0x0,-0x1)[_0x23775f(0x27e)]('.'),_0x2cf859=_0x30e786['slice'](0x0,-0x2)[_0x23775f(0x27e)]('.');if(_0x1cf577[_0x23775f(0x21c)](_0x256602)){_0x12b8b9=!![];if(_0x4ab874[_0x256602])_0x4ab874[_0x785739]=_0x4ab874[_0x256602];}else{if(_0x1cf577[_0x23775f(0x21c)](_0x2cf859)){_0x12b8b9=!![];if(_0x4ab874[_0x2cf859])_0x4ab874[_0x785739]=_0x4ab874[_0x2cf859];}}}if(!_0x12b8b9)continue;}let _0xa69602=(_0x541640[_0x23775f(0x2b1)][_0x23775f(0x294)]&&typeof _0x541640['common'][_0x23775f(0x294)]==='object'?_0x541640['common'][_0x23775f(0x294)]['de']:_0x541640[_0x23775f(0x2b1)][_0x23775f(0x294)])||'';const _0x3d8dcf=(_0x541640[_0x23775f(0x2b1)][_0x23775f(0x278)]||'')[_0x23775f(0x28b)](),_0x3c5dac=_0xa69602[_0x23775f(0x28b)]();let _0x2f7987=_0x4ab874[_0x785739]||null;if(!_0x2f7987){if(_0x2506ad[_0x23775f(0x2b9)]&&(_0x3d8dcf[_0x23775f(0x1c8)](_0x23775f(0x2b9))||_0x3c5dac['includes']('bewegung')||_0x3d8dcf['includes'](_0x23775f(0x125))))_0x2f7987='motion';else{if(_0x2506ad['doors']&&(_0x3d8dcf[_0x23775f(0x1c8)]('door')||_0x3d8dcf[_0x23775f(0x1c8)](_0x23775f(0x173))||_0x3c5dac[_0x23775f(0x1c8)](_0x23775f(0x23f))||_0x3c5dac[_0x23775f(0x1c8)](_0x23775f(0x21d))||_0x3d8dcf[_0x23775f(0x1c8)](_0x23775f(0x14d))))_0x2f7987=_0x23775f(0x129);else{if(_0x2506ad['lights']&&(_0x3d8dcf['includes'](_0x23775f(0x271))||_0x3d8dcf[_0x23775f(0x1c8)]('switch')||_0x3c5dac[_0x23775f(0x1c8)](_0x23775f(0x143))||_0x3d8dcf[_0x23775f(0x1c8)](_0x23775f(0x1a9))))_0x2f7987=_0x23775f(0x271);else{if(_0x2506ad['temperature']&&(_0x3d8dcf[_0x23775f(0x1c8)]('temperature')||_0x3c5dac[_0x23775f(0x1c8)](_0x23775f(0x155))||_0x3d8dcf[_0x23775f(0x1c8)](_0x23775f(0x1e8))))_0x2f7987=_0x23775f(0x283);}}}}if(_0x2f7987){const _0x5aa760=['occupancy',_0x23775f(0x282),_0x23775f(0x15f),'value','on','off',_0x23775f(0x228),_0x23775f(0x169),_0x23775f(0x133),_0x23775f(0x1f9),_0x23775f(0x283),'setpoint',_0x23775f(0x125)],_0x454d6c=!_0xa69602||_0x5aa760[_0x23775f(0x1fb)](_0x10a24f=>_0x3c5dac===_0x10a24f||_0x3c5dac['includes'](_0x10a24f));if(_0x454d6c){const _0x57c34e=_0x785739[_0x23775f(0x24b)]('.'),_0x578af4=_0x57c34e['slice'](0x0,-0x1)[_0x23775f(0x27e)]('.'),_0x2bf6a4=_0xba0722[_0x578af4];if(_0x2bf6a4&&_0x2bf6a4[_0x23775f(0x2b1)]&&_0x2bf6a4[_0x23775f(0x2b1)]['name']){let _0x4870a7=(typeof _0x2bf6a4[_0x23775f(0x2b1)][_0x23775f(0x294)]===_0x23775f(0x115)?_0x2bf6a4['common'][_0x23775f(0x294)]['de']:_0x2bf6a4[_0x23775f(0x2b1)][_0x23775f(0x294)])||'';if(!_0x4870a7||_0x4870a7[_0x23775f(0x28b)]()[_0x23775f(0x1c8)](_0x23775f(0x168))||_0x4870a7===_0x578af4[_0x23775f(0x24b)]('.')[_0x23775f(0x286)]()){const _0x37360c=_0x57c34e[_0x23775f(0x29f)](0x0,-0x2)[_0x23775f(0x27e)]('.'),_0x1f7509=_0xba0722[_0x37360c];_0x1f7509&&_0x1f7509[_0x23775f(0x2b1)]&&_0x1f7509[_0x23775f(0x2b1)][_0x23775f(0x294)]&&(_0x4870a7=(typeof _0x1f7509[_0x23775f(0x2b1)][_0x23775f(0x294)]===_0x23775f(0x115)?_0x1f7509[_0x23775f(0x2b1)]['name']['de']:_0x1f7509[_0x23775f(0x2b1)][_0x23775f(0x294)])||'');}if(_0x4870a7)_0xa69602=_0x4870a7+'\x20('+(_0xa69602||_0x785739[_0x23775f(0x24b)]('.')['pop']())+')';}}let _0xf233ee=_0x451a7f[_0x785739];if(!_0xf233ee){const _0x2710f8=_0x785739[_0x23775f(0x24b)]('.')[_0x23775f(0x29f)](0x0,-0x1)['join']('.');_0xf233ee=_0x451a7f[_0x2710f8];}if(!_0xf233ee){const _0x45055c=_0x785739[_0x23775f(0x24b)]('.')['slice'](0x0,-0x2)[_0x23775f(0x27e)]('.');_0xf233ee=_0x451a7f[_0x45055c];}if(!_0xf233ee){const _0x4a5e74=_0x785739[_0x23775f(0x24b)]('.');if(_0x4a5e74['length']>0x2)_0xf233ee=_0x4a5e74[0x2];}_0x2a07cb[_0x23775f(0x14a)]({'id':_0x785739,'name':_0xa69602||_0x785739,'type':_0x2f7987,'location':_0xf233ee||'','_score':_0x1cf577?0x5a:0x32});}}}return _0x2a07cb;}async function getWeatherContext(_0x52ccb7){const _0x1176db=a0_0x4a7c0f;if(!_0x52ccb7[_0x1176db(0x141)]['useWeather']||!_0x52ccb7[_0x1176db(0x141)]['weatherInstance'])return'Wetterdaten\x20deaktiviert.';try{const _0x53a150=_0x52ccb7['config'][_0x1176db(0x263)];let _0x17243e=await _0x52ccb7[_0x1176db(0x1dc)](_0x53a150+_0x1176db(0x251));if(!_0x17243e)_0x17243e=await _0x52ccb7[_0x1176db(0x1dc)](_0x53a150+_0x1176db(0x2b4));let _0x3abfe2=await _0x52ccb7['getForeignStateAsync'](_0x53a150+_0x1176db(0x1ba));if(!_0x3abfe2)_0x3abfe2=await _0x52ccb7[_0x1176db(0x1dc)](_0x53a150+_0x1176db(0x21e));if(_0x17243e&&_0x3abfe2)return _0x17243e['val']+_0x1176db(0x1a7)+_0x3abfe2[_0x1176db(0x123)];}catch(_0x15f809){}return _0x1176db(0x203);}async function getCalendarContext(_0x13d766){const _0x2011cb=a0_0x4a7c0f;if(!_0x13d766[_0x2011cb(0x141)][_0x2011cb(0x268)]||!_0x13d766[_0x2011cb(0x141)][_0x2011cb(0x196)])return _0x2011cb(0x2b5);return _0x2011cb(0x1db);}async function getCalendarNames(_0x3cd74b,_0x48fbf3){return[];}async function saveFeedback(_0x2e77f2,_0x46c03c){const _0x1cfcc6=a0_0x4a7c0f;_0x2e77f2[_0x1cfcc6(0x252)][_0x1cfcc6(0x235)](_0x1cfcc6(0x21a)+_0x46c03c[_0x1cfcc6(0x181)]);}async function sendMorningBriefing(_0x352732){const _0x409c64=a0_0x4a7c0f;if(!_0x352732['geminiModel'])return;try{const _0x59d87f=_0x409c64(0x112),_0x3465e7=await _0x352732[_0x409c64(0x285)][_0x409c64(0x26c)](_0x59d87f),_0x26b2cc=_0x3465e7[_0x409c64(0x297)][_0x409c64(0x25e)]();sendNotification(_0x352732,_0x409c64(0x2a0)+_0x26b2cc);}catch(_0x53d208){_0x352732[_0x409c64(0x252)][_0x409c64(0x25d)]('Briefing\x20Error:\x20'+_0x53d208[_0x409c64(0x1e7)]);}}async function initZombies(_0x2e4b1e){const _0x310bfa=a0_0x4a7c0f;try{const _0x393dde=['analysis.history_debug_00',_0x310bfa(0x1e6)];for(const _0x14214a of _0x393dde){try{const _0x27337f=await _0x2e4b1e[_0x310bfa(0x29c)](_0x14214a);if(_0x27337f)await _0x2e4b1e['delObjectAsync'](_0x14214a);}catch(_0x4fe9d2){}}}catch(_0x5dcda4){}}async function checkLicense(_0x4f1b72){return!![];}async function initHistory(_0x2230cb){const _0x420088=a0_0x4a7c0f;try{const _0x43c400=await _0x2230cb[_0x420088(0x1d1)](_0x420088(0x13b));_0x43c400&&_0x43c400[_0x420088(0x123)]&&(_0x2230cb[_0x420088(0x140)]=JSON[_0x420088(0x12d)](_0x43c400[_0x420088(0x123)][_0x420088(0x16a)]()));}catch(_0x50ebed){_0x2230cb['eventHistory']=[];}try{const _0x305da7=await _0x2230cb[_0x420088(0x1d1)](_0x420088(0x202));if(_0x305da7&&_0x305da7[_0x420088(0x123)])_0x2230cb['analysisHistory']=JSON['parse'](_0x305da7['val'][_0x420088(0x16a)]());}catch(_0x3c2f16){_0x2230cb[_0x420088(0x142)]=[];}if(_0x2230cb[_0x420088(0x140)]&&_0x2230cb[_0x420088(0x140)][_0x420088(0x241)]>0x0){_0x2230cb[_0x420088(0x252)][_0x420088(0x235)](_0x420088(0x1a0));for(let _0x1e13ad=_0x2230cb[_0x420088(0x140)][_0x420088(0x241)]-0x1;_0x1e13ad>=0x0;_0x1e13ad--){const _0x229c8d=_0x2230cb['eventHistory'][_0x1e13ad];if(_0x229c8d&&_0x229c8d['id']!==undefined&&_0x229c8d['value']!==undefined)_0x2230cb[_0x420088(0x124)][_0x229c8d['id']]=_0x229c8d['value'];}}}async function initSystemConfig(_0x151810){const _0x537c76=a0_0x4a7c0f;try{const _0x77b811=await _0x151810[_0x537c76(0x2aa)](_0x537c76(0x187));if(_0x77b811&&_0x77b811[_0x537c76(0x2b1)])_0x151810['systemConfig']={'latitude':_0x77b811[_0x537c76(0x2b1)][_0x537c76(0x1bd)]||0x0,'longitude':_0x77b811[_0x537c76(0x2b1)]['longitude']||0x0,'city':_0x77b811['common']['city']||''};}catch(_0x34b4fe){}}async function createAllObjects(_0x10bc1e){const _0x2e70e6=a0_0x4a7c0f;await _0x10bc1e[_0x2e70e6(0x144)](_0x2e70e6(0x2b0),{'type':_0x2e70e6(0x168),'common':{'name':_0x2e70e6(0x137)},'native':{}}),await _0x10bc1e[_0x2e70e6(0x144)](SYSTEM_DP_MODE,{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x11c),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x282),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x2e70e6(0x1f3)]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)]('system.presenceWho',{'type':'state','common':{'name':_0x2e70e6(0x1d9),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x25e),'read':!![],'write':![]},'native':{}}),await _0x10bc1e['setObjectNotExistsAsync'](_0x2e70e6(0x226),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x29b),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x281),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x13b),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x22f),'type':'string','role':_0x2e70e6(0x281),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x144)](_0x2e70e6(0x161),{'type':_0x2e70e6(0x168),'common':{'name':'AI\x20Training'},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x295),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x15b),'type':_0x2e70e6(0x20c),'role':_0x2e70e6(0x26f),'read':!![],'write':!![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)]('analysis.training.triggerHealth',{'type':_0x2e70e6(0x282),'common':{'name':'Train\x20Health','type':'boolean','role':_0x2e70e6(0x26f),'read':!![],'write':!![]},'native':{}}),await _0x10bc1e['setObjectNotExistsAsync']('analysis.training.triggerEnergy',{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x27f),'type':_0x2e70e6(0x20c),'role':_0x2e70e6(0x26f),'read':!![],'write':!![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x190),{'type':_0x2e70e6(0x282),'common':{'name':'Train\x20Comfort','type':_0x2e70e6(0x20c),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x182),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x157),'type':_0x2e70e6(0x20c),'role':_0x2e70e6(0x26f),'read':!![],'write':!![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x262),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x165),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x25e),'read':!![],'write':![]},'native':{}}),await _0x10bc1e['extendObjectAsync']('analysis.security',{'type':_0x2e70e6(0x168),'common':{'name':_0x2e70e6(0x218)},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x23d),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x1ad),'type':_0x2e70e6(0x151),'role':_0x2e70e6(0x205),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x1c9),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x110),'type':'number','role':_0x2e70e6(0x205),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x178),{'type':'state','common':{'name':_0x2e70e6(0x13a),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x113),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x1f4),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x164),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x281),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x144)](_0x2e70e6(0x2b3),{'type':_0x2e70e6(0x168),'common':{'name':'Health\x20Analysis'},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x180),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x13a),'type':'string','role':'date','read':!![],'write':![]},'native':{}}),await _0x10bc1e['setObjectNotExistsAsync'](_0x2e70e6(0x1bb),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x298),'type':'boolean','role':_0x2e70e6(0x1b7),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x22c),{'type':'state','common':{'name':_0x2e70e6(0x240),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x25e),'read':!![],'write':![]},'native':{}}),await _0x10bc1e['setObjectNotExistsAsync'](_0x2e70e6(0x1c7),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x13c),'type':_0x2e70e6(0x151),'role':_0x2e70e6(0x205),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x1d2),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x20d),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x281),'read':!![],'write':![]},'native':{}}),await _0x10bc1e['setObjectNotExistsAsync'](_0x2e70e6(0x1c4),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x135),'type':_0x2e70e6(0x151),'role':_0x2e70e6(0x205),'read':!![],'write':![]},'native':{}}),await _0x10bc1e['extendObjectAsync']('analysis.energy',{'type':_0x2e70e6(0x168),'common':{'name':_0x2e70e6(0x1b8)},'native':{}}),await _0x10bc1e['setObjectNotExistsAsync'](_0x2e70e6(0x1ac),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x1a2),'type':'string','role':_0x2e70e6(0x25e),'read':!![],'write':![]},'native':{}}),await _0x10bc1e['setObjectNotExistsAsync'](_0x2e70e6(0x11b),{'type':'state','common':{'name':'Heating\x20Score','type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x25e),'read':!![],'write':![]},'native':{}}),await _0x10bc1e['setObjectNotExistsAsync'](_0x2e70e6(0x1ea),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x27d),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x281),'read':!![],'write':![]},'native':{}}),await _0x10bc1e['extendObjectAsync'](_0x2e70e6(0x1fd),{'type':_0x2e70e6(0x168),'common':{'name':_0x2e70e6(0x1fd)},'native':{}}),await _0x10bc1e['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x2e70e6(0x282),'common':{'name':'Raw\x20Log','type':'string','role':_0x2e70e6(0x281),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x144)](LTM_DP_DAILY_DIGESTS,{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x1b4),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x281),'read':!![],'write':![]},'native':{}}),await _0x10bc1e['setObjectNotExistsAsync'](_0x2e70e6(0x250),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x249),'type':_0x2e70e6(0x2b8),'role':'json','read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x1d7),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x183),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x281),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x19b),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x19a),'type':_0x2e70e6(0x20c),'role':_0x2e70e6(0x26f),'read':!![],'write':!![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)]('analysis.triggerBriefing',{'type':_0x2e70e6(0x282),'common':{'name':'Trigger\x20Briefing','type':_0x2e70e6(0x20c),'role':_0x2e70e6(0x26f),'read':!![],'write':!![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x17a),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x119),'type':'boolean','role':_0x2e70e6(0x1ed),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x28d),{'type':'state','common':{'name':_0x2e70e6(0x15a),'type':'string','role':_0x2e70e6(0x117),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x200),{'type':_0x2e70e6(0x282),'common':{'name':'Activity\x20Summary','type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x25e),'read':!![],'write':![]},'native':{}}),await _0x10bc1e['setObjectNotExistsAsync'](_0x2e70e6(0x12c),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x2a4),'type':_0x2e70e6(0x20c),'role':_0x2e70e6(0x1b7),'read':!![],'write':![]},'native':{}}),await _0x10bc1e['setObjectNotExistsAsync'](_0x2e70e6(0x284),{'type':_0x2e70e6(0x282),'common':{'name':'Description','type':_0x2e70e6(0x2b8),'role':'text','read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x15c),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x10e),'type':'string','role':_0x2e70e6(0x281),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x28e),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x18a),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x25e),'read':!![],'write':![]},'native':{}}),await _0x10bc1e['setObjectNotExistsAsync'](_0x2e70e6(0x246),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x1f8),'type':_0x2e70e6(0x2b8),'role':_0x2e70e6(0x25e),'read':!![],'write':![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x127),{'type':_0x2e70e6(0x282),'common':{'name':'Auto\x20Apply','type':_0x2e70e6(0x20c),'role':_0x2e70e6(0x26d),'read':!![],'write':!![]},'native':{}}),await _0x10bc1e[_0x2e70e6(0x20b)](_0x2e70e6(0x23b),{'type':_0x2e70e6(0x282),'common':{'name':_0x2e70e6(0x1a3),'type':_0x2e70e6(0x20c),'role':_0x2e70e6(0x26f),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0x491e37){const _0x2ecfe4=a0_0x4a7c0f;try{const _0x1aa71c=await _0x491e37[_0x2ecfe4(0x1d1)](SYSTEM_DP_MODE);_0x1aa71c&&_0x1aa71c[_0x2ecfe4(0x123)]&&Object[_0x2ecfe4(0x1b0)](SYSTEM_MODES)['includes'](_0x1aa71c[_0x2ecfe4(0x123)])?_0x491e37[_0x2ecfe4(0x1f1)]=_0x1aa71c['val']:(_0x491e37[_0x2ecfe4(0x1f1)]=SYSTEM_MODES[_0x2ecfe4(0x1f3)],await _0x491e37[_0x2ecfe4(0x230)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x2ecfe4(0x1f3)],'ack':!![]}));}catch(_0x29bc8f){_0x491e37[_0x2ecfe4(0x1f1)]=SYSTEM_MODES[_0x2ecfe4(0x1f3)];}}async function loadRawEventLog(_0x2b537c){const _0xd4239c=a0_0x4a7c0f;try{const _0x205ff4=await _0x2b537c[_0xd4239c(0x1d1)](LTM_DP_RAW_LOG);if(_0x205ff4&&_0x205ff4[_0xd4239c(0x123)])_0x2b537c[_0xd4239c(0x22e)]=JSON[_0xd4239c(0x12d)](_0x205ff4['val']);}catch(_0x203f5e){_0x2b537c[_0xd4239c(0x22e)]=[];}}async function saveRawEventLog(_0x3d3cbe){const _0xb57e1f=a0_0x4a7c0f;if(_0x3d3cbe[_0xb57e1f(0x22e)]['length']>RAW_LOG_MAX_SIZE)_0x3d3cbe[_0xb57e1f(0x22e)][_0xb57e1f(0x2ad)](0x0,_0x3d3cbe[_0xb57e1f(0x22e)][_0xb57e1f(0x241)]-RAW_LOG_MAX_SIZE);await _0x3d3cbe[_0xb57e1f(0x230)](LTM_DP_RAW_LOG,{'val':JSON[_0xb57e1f(0x267)](_0x3d3cbe[_0xb57e1f(0x22e)]),'ack':!![]});}async function loadDailyDigests(_0x3c3f90){const _0x5f5a54=a0_0x4a7c0f;try{const _0x1a5de3=await _0x3c3f90[_0x5f5a54(0x1d1)](LTM_DP_DAILY_DIGESTS);if(_0x1a5de3&&_0x1a5de3['val'])_0x3c3f90[_0x5f5a54(0x170)]=JSON[_0x5f5a54(0x12d)](_0x1a5de3[_0x5f5a54(0x123)]);}catch(_0x8d9dfe){_0x3c3f90['dailyDigests']=[];}await updateBaselineStatus(_0x3c3f90);}async function saveDailyDigests(_0x1159df,_0x25c075=!![]){const _0x3ea5b2=a0_0x4a7c0f,_0x57957b=_0x1159df['config'][_0x3ea5b2(0x1e9)]||0x3c;_0x1159df[_0x3ea5b2(0x170)][_0x3ea5b2(0x241)]>_0x57957b&&_0x1159df[_0x3ea5b2(0x170)]['splice'](0x0,_0x1159df[_0x3ea5b2(0x170)]['length']-_0x57957b);await _0x1159df[_0x3ea5b2(0x230)](LTM_DP_DAILY_DIGESTS,{'val':JSON['stringify'](_0x1159df[_0x3ea5b2(0x170)]),'ack':!![]});if(_0x25c075)await updateBaselineStatus(_0x1159df);}async function updateAnalysisHistory(_0x44e247,_0x20053f){const _0x33d76d=a0_0x4a7c0f;_0x44e247[_0x33d76d(0x142)][_0x33d76d(0x1a8)](_0x20053f);if(_0x44e247[_0x33d76d(0x142)][_0x33d76d(0x241)]>HISTORY_MAX_SIZE)_0x44e247[_0x33d76d(0x142)]['pop']();await _0x44e247[_0x33d76d(0x230)](_0x33d76d(0x202),{'val':JSON[_0x33d76d(0x267)](_0x44e247['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x5451d1){const _0x21ba49=a0_0x4a7c0f;if(!_0x5451d1[_0x21ba49(0x17b)]){await _0x5451d1[_0x21ba49(0x230)](LTM_DP_BASELINE_STATUS,{'val':_0x21ba49(0x2bb),'ack':!![]});return;}const _0x34b9be=_0x5451d1[_0x21ba49(0x170)][_0x21ba49(0x241)]>=(_0x5451d1['config'][_0x21ba49(0x219)]||0x7)?_0x21ba49(0x198)+_0x5451d1[_0x21ba49(0x170)]['length']+_0x21ba49(0x1b3):'Lernphase\x20('+_0x5451d1[_0x21ba49(0x170)][_0x21ba49(0x241)]+'/'+(_0x5451d1['config'][_0x21ba49(0x219)]||0x7)+')';await _0x5451d1[_0x21ba49(0x230)](LTM_DP_BASELINE_STATUS,{'val':_0x34b9be,'ack':!![]});}async function initSensorSubscriptions(_0x428b85){const _0x114584=a0_0x4a7c0f,_0x3822a0=_0x428b85['config'][_0x114584(0x288)];if(_0x3822a0)for(const _0x4d76f9 of _0x3822a0){await _0x428b85[_0x114584(0x221)](_0x4d76f9['id']);}}async function initPresenceSubscriptions(_0x4e3ac3){const _0x4bca7e=a0_0x4a7c0f,_0x466412=_0x4e3ac3[_0x4bca7e(0x141)]['presenceDevices'];if(_0x466412)for(const _0x27c03d of _0x466412){await _0x4e3ac3[_0x4bca7e(0x221)](_0x27c03d);}}async function setupTelegramListener(_0x4f8aed){const _0xdc7916=a0_0x4a7c0f,_0x46c286=_0x4f8aed['config'][_0xdc7916(0x25a)];if(_0x4f8aed['config']['notifyTelegramEnabled']&&_0x46c286)await _0x4f8aed[_0xdc7916(0x221)](_0x46c286+_0xdc7916(0x1f0));}async function checkWifiPresence(_0x431be2){const _0x4726eb=a0_0x4a7c0f;try{const _0x4d7e23=_0x431be2['config']['presenceDevices']||[];let _0x93960a=![];const _0x44ee05=[];for(const _0x639d84 of _0x4d7e23){try{const _0x2815f0=await _0x431be2[_0x4726eb(0x1dc)](_0x639d84);_0x2815f0&&(_0x2815f0[_0x4726eb(0x123)]===!![]||_0x2815f0[_0x4726eb(0x123)]==='online'||_0x2815f0['val']===0x1)&&(_0x93960a=!![],_0x44ee05[_0x4726eb(0x14a)](_0x639d84));}catch(_0x378c19){}}return await _0x431be2[_0x4726eb(0x230)](_0x4726eb(0x292),{'val':_0x44ee05[_0x4726eb(0x27e)](',\x20'),'ack':!![]}),_0x93960a&&(_0x431be2[_0x4726eb(0x206)]&&(_0x431be2[_0x4726eb(0x252)][_0x4726eb(0x235)](_0x4726eb(0x199)),abortExitTimer(_0x431be2)),!_0x431be2['isPresent']&&_0x431be2[_0x4726eb(0x1f1)]===SYSTEM_MODES['NORMAL']&&await setPresence(_0x431be2,!![])),_0x93960a;}catch(_0x60846f){return![];}}function startExitTimer(_0x540cb0){const _0x134494=a0_0x4a7c0f;abortExitTimer(_0x540cb0),_0x540cb0['isGracePeriodActive']=!![],_0x540cb0[_0x134494(0x256)]=setTimeout(()=>{const _0x18adbd=_0x134494;_0x540cb0[_0x18adbd(0x2b6)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x540cb0['exitTimer']=setTimeout(()=>{const _0x7f1c7d=_0x134494;setPresence(_0x540cb0,![]),_0x540cb0[_0x7f1c7d(0x206)]=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x35393d){const _0x1b453a=a0_0x4a7c0f;if(_0x35393d[_0x1b453a(0x206)])clearTimeout(_0x35393d[_0x1b453a(0x206)]);if(_0x35393d['exitGraceTimer'])clearTimeout(_0x35393d[_0x1b453a(0x256)]);_0x35393d[_0x1b453a(0x206)]=null,_0x35393d[_0x1b453a(0x256)]=null,_0x35393d[_0x1b453a(0x2b6)]=![];}function a0_0x28f4(_0x4794d1,_0x506e28){const _0x2df0d1=a0_0xd0bf();return a0_0x28f4=function(_0x3365cb,_0x5afa3f){_0x3365cb=_0x3365cb-0x10e;let _0xd0bfa6=_0x2df0d1[_0x3365cb];return _0xd0bfa6;},a0_0x28f4(_0x4794d1,_0x506e28);}async function setPresence(_0x17626f,_0x4ea91e){const _0x23eae9=a0_0x4a7c0f;if(_0x17626f[_0x23eae9(0x22d)]===_0x4ea91e)return;_0x17626f[_0x23eae9(0x22d)]=_0x4ea91e,await _0x17626f[_0x23eae9(0x230)](_0x23eae9(0x184),{'val':_0x4ea91e,'ack':!![]});}async function executeAutomationAction(_0x1d4b4a){const _0x22b0f4=a0_0x4a7c0f;try{const _0x85968f=await _0x1d4b4a[_0x22b0f4(0x1d1)]('analysis.automation.targetId'),_0x5a4296=await _0x1d4b4a[_0x22b0f4(0x1d1)](_0x22b0f4(0x246));if(_0x85968f&&_0x85968f[_0x22b0f4(0x123)]&&_0x5a4296){const _0x2d60a8=_0x85968f[_0x22b0f4(0x123)];let _0x57e33f=_0x5a4296[_0x22b0f4(0x123)];try{_0x57e33f=JSON['parse'](_0x57e33f);}catch(_0x2dff33){}_0x1d4b4a[_0x22b0f4(0x252)]['info'](_0x22b0f4(0x111)+_0x2d60a8+_0x22b0f4(0x1c0)+_0x57e33f),await _0x1d4b4a[_0x22b0f4(0x238)](_0x2d60a8,_0x57e33f);}else _0x1d4b4a[_0x22b0f4(0x252)][_0x22b0f4(0x229)]('ü§ñ\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.');}catch(_0x34de98){_0x1d4b4a['log'][_0x22b0f4(0x25d)]('BUTLER\x20Execution\x20Error:\x20'+_0x34de98[_0x22b0f4(0x1e7)]);}}async function processSensorEvent(_0x19cc9a,_0x33b67f,_0x537ed5,_0x2250cd){const _0x22d6a0=a0_0x4a7c0f;if(!_0x2250cd)return;const _0x592af1=_0x537ed5['val'],_0x10b3aa=Date[_0x22d6a0(0x148)](),_0xc56f29=_0x19cc9a['sensorLastValues'][_0x33b67f];_0x19cc9a[_0x22d6a0(0x124)][_0x33b67f]=_0x592af1;if(!_0x2250cd[_0x22d6a0(0x1da)]&&_0xc56f29!=undefined&&_0xc56f29==_0x592af1)return;const _0x57c438=(_0x2250cd['type']||'')['toLowerCase'](),_0x4816bd=_0x57c438[_0x22d6a0(0x1c8)](_0x22d6a0(0x283))||_0x57c438[_0x22d6a0(0x1c8)](_0x22d6a0(0x155))||_0x57c438['includes'](_0x22d6a0(0x24c))||_0x57c438['includes']('heizung');_0x19cc9a['isProVersion']&&_0x4816bd&&recordThermodynamics(_0x19cc9a,_0x33b67f,_0x592af1,_0x2250cd['location']);const _0x226129={'timestamp':_0x10b3aa,'id':_0x33b67f,'name':_0x2250cd[_0x22d6a0(0x294)],'type':_0x2250cd[_0x22d6a0(0x18b)],'location':_0x2250cd[_0x22d6a0(0x216)],'value':_0x592af1};_0x19cc9a[_0x22d6a0(0x140)]['unshift'](_0x226129);if(_0x19cc9a['eventHistory'][_0x22d6a0(0x241)]>HISTORY_MAX_SIZE)_0x19cc9a[_0x22d6a0(0x140)][_0x22d6a0(0x286)]();await _0x19cc9a[_0x22d6a0(0x230)](_0x22d6a0(0x226),{'val':JSON[_0x22d6a0(0x267)](_0x226129),'ack':!![]}),await _0x19cc9a['setStateAsync']('events.history',{'val':JSON[_0x22d6a0(0x267)](_0x19cc9a[_0x22d6a0(0x140)]),'ack':!![]});_0x19cc9a[_0x22d6a0(0x17b)]&&(_0x19cc9a[_0x22d6a0(0x22e)]['push'](_0x226129),await saveRawEventLog(_0x19cc9a),recordSequence(_0x19cc9a,_0x226129));if(_0x2250cd[_0x22d6a0(0x213)]&&_0x592af1===!![]){if(_0x19cc9a[_0x22d6a0(0x22d)]&&!_0x19cc9a[_0x22d6a0(0x2b6)])startExitTimer(_0x19cc9a);else{if(!_0x19cc9a['isPresent'])setPresence(_0x19cc9a,!![]);}}else{if(_0x2250cd['type']===_0x22d6a0(0x2b9)&&_0x592af1===!![]){if(_0x19cc9a[_0x22d6a0(0x206)])abortExitTimer(_0x19cc9a);if(!_0x19cc9a[_0x22d6a0(0x22d)]&&_0x19cc9a[_0x22d6a0(0x1f1)]===SYSTEM_MODES[_0x22d6a0(0x1f3)])setPresence(_0x19cc9a,!![]);}}}async function recordThermodynamics(_0x5eb99f,_0x4760f0,_0x358b92,_0x5a0a43){const _0x131098=a0_0x4a7c0f,_0xdf16fd=await getOutsideTemperatureNumeric(_0x5eb99f),_0x73138e=await _0x5eb99f['getStateAsync']('LTM.trainingData.thermodynamics');let _0x6b756e=[];if(_0x73138e&&_0x73138e[_0x131098(0x123)])try{_0x6b756e=JSON[_0x131098(0x12d)](_0x73138e[_0x131098(0x123)]);}catch(_0x36b86e){}_0x6b756e[_0x131098(0x14a)]({'ts':Date[_0x131098(0x148)](),'room':_0x5a0a43||_0x131098(0x29e),'t_in':_0x358b92,'t_out':_0xdf16fd});if(_0x6b756e['length']>THERMO_LOG_SIZE)_0x6b756e[_0x131098(0x118)]();await _0x5eb99f[_0x131098(0x230)](_0x131098(0x1d7),{'val':JSON[_0x131098(0x267)](_0x6b756e),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x3cb5bb){const _0x8ce91a=a0_0x4a7c0f;if(_0x3cb5bb[_0x8ce91a(0x141)][_0x8ce91a(0x17f)])try{const _0x24b179=await _0x3cb5bb[_0x8ce91a(0x1dc)](_0x3cb5bb[_0x8ce91a(0x141)][_0x8ce91a(0x17f)]);if(_0x24b179&&_0x24b179['val']!==undefined&&_0x24b179[_0x8ce91a(0x123)]!==null)return parseFloat(_0x24b179['val']);}catch(_0xcb3a19){}const _0x258923=_0x3cb5bb[_0x8ce91a(0x141)][_0x8ce91a(0x263)];if(!_0x3cb5bb['config'][_0x8ce91a(0x242)]||!_0x258923)return null;try{let _0x2578e4='';if(_0x258923[_0x8ce91a(0x1c8)]('accuweather'))_0x2578e4=_0x258923+_0x8ce91a(0x251);else{if(_0x258923['includes'](_0x8ce91a(0x1cf)))_0x2578e4=_0x258923+'.NextHours.Location_1.Day_1.current.temp_value';else{if(_0x258923[_0x8ce91a(0x1c8)](_0x8ce91a(0x19c)))_0x2578e4=_0x258923+'.forecast.current.temperature';else{if(_0x258923[_0x8ce91a(0x1c8)](_0x8ce91a(0x1d0)))_0x2578e4=_0x258923+_0x8ce91a(0x289);}}}if(_0x2578e4){const _0x16066f=await _0x3cb5bb['getForeignStateAsync'](_0x2578e4);if(_0x16066f&&_0x16066f['val']!==undefined&&_0x16066f['val']!==null)return parseFloat(_0x16066f['val']);}}catch(_0x2d3418){}return null;}async function recordSequence(_0x2fdd87,_0x292876){const _0x2cdd47=a0_0x4a7c0f,_0x4199de=(_0x292876[_0x2cdd47(0x18b)]||'')[_0x2cdd47(0x28b)](),_0x4ef50e=[_0x2cdd47(0x2b9),_0x2cdd47(0x1ee),_0x2cdd47(0x207),_0x2cdd47(0x125),_0x2cdd47(0x21b),_0x2cdd47(0x129),_0x2cdd47(0x23f),_0x2cdd47(0x173),_0x2cdd47(0x21d),_0x2cdd47(0x14d),_0x2cdd47(0x20a),_0x2cdd47(0x271),_0x2cdd47(0x143),_0x2cdd47(0x26d),_0x2cdd47(0x1a5),'dimmer',_0x2cdd47(0x191)];if(!_0x4ef50e[_0x2cdd47(0x1fb)](_0x3d84ba=>_0x4199de[_0x2cdd47(0x1c8)](_0x3d84ba)))return;if(!_0x292876[_0x2cdd47(0x205)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence['push']({'loc':_0x292876[_0x2cdd47(0x216)]||'Unknown','id':_0x292876['id'],'ts':Date[_0x2cdd47(0x148)]()}),sequenceTimer=setTimeout(async()=>{if(activeSequence['length']>0x1)await saveCompletedSequence(_0x2fdd87);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x5d4bfc){const _0xdc4aed=a0_0x4a7c0f;try{const _0x236b01=await _0x5d4bfc[_0xdc4aed(0x1d1)](_0xdc4aed(0x250));let _0x5956aa=[];if(_0x236b01&&_0x236b01[_0xdc4aed(0x123)])try{_0x5956aa=JSON[_0xdc4aed(0x12d)](_0x236b01[_0xdc4aed(0x123)]);}catch(_0xf0bcc3){}const _0x1aead7=activeSequence[0x0]['ts'],_0x81272c=activeSequence['map'](_0x95f58=>({'loc':_0x95f58[_0xdc4aed(0x153)],'t_delta':Math[_0xdc4aed(0x27a)]((_0x95f58['ts']-_0x1aead7)/0x3e8)})),_0x5efea9={'timestamp':new Date(_0x1aead7)[_0xdc4aed(0x23e)](),'steps':_0x81272c,'duration':Math[_0xdc4aed(0x27a)]((activeSequence[activeSequence['length']-0x1]['ts']-_0x1aead7)/0x3e8),'daytime':new Date(_0x1aead7)[_0xdc4aed(0x1a1)]()};_0x5956aa['push'](_0x5efea9);if(_0x5956aa[_0xdc4aed(0x241)]>MAX_TRAINING_SET_SIZE)_0x5956aa[_0xdc4aed(0x118)]();await _0x5d4bfc[_0xdc4aed(0x230)](_0xdc4aed(0x250),{'val':JSON[_0xdc4aed(0x267)](_0x5956aa),'ack':!![]}),runSecurityCheck(_0x5d4bfc,_0x5efea9);}catch(_0x56d145){_0x5d4bfc['log'][_0xdc4aed(0x25d)]('[RECORDER]\x20Error:\x20'+_0x56d145[_0xdc4aed(0x1e7)]);}}function runSecurityCheck(_0x59c629,_0x1c908b){const _0x17bac0=a0_0x4a7c0f;if(!_0x59c629[_0x17bac0(0x17b)])return;sendToPython(_0x59c629,_0x17bac0(0x15d),{'sequence':_0x1c908b});}function setupLtmScheduler(_0x57efe6){const _0x570827=a0_0x4a7c0f;try{if(_0x57efe6[_0x570827(0x247)])_0x57efe6[_0x570827(0x247)][_0x570827(0x132)]();if(!_0x57efe6[_0x570827(0x17b)])return;_0x57efe6['ltmJob']=schedule['scheduleJob'](LTM_SCHEDULE,()=>createDailyDigest(_0x57efe6));}catch(_0x1b64b7){_0x57efe6['log'][_0x570827(0x25d)](_0x570827(0x171)+_0x1b64b7[_0x570827(0x1e7)]);}}function setupModeResetScheduler(_0x5b14de){const _0x1d5bb8=a0_0x4a7c0f;try{if(_0x5b14de['modeResetJob'])_0x5b14de[_0x1d5bb8(0x1dd)][_0x1d5bb8(0x132)]();_0x5b14de['modeResetJob']=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x41563b=_0x1d5bb8;await loadSystemMode(_0x5b14de),AUTO_RESET_MODES[_0x41563b(0x1c8)](_0x5b14de[_0x41563b(0x1f1)])&&await _0x5b14de[_0x41563b(0x230)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x41563b(0x1f3)],'ack':![]});});}catch(_0x1d8f97){_0x5b14de['log'][_0x1d5bb8(0x25d)](_0x1d5bb8(0x13d)+_0x1d8f97[_0x1d5bb8(0x1e7)]);}}function setupDriftAnalysisScheduler(_0x317842){const _0x3e9982=a0_0x4a7c0f;try{if(_0x317842['driftAnalysisTimer'])clearInterval(_0x317842['driftAnalysisTimer']);if(!_0x317842[_0x3e9982(0x17b)])return;_0x317842[_0x3e9982(0x254)]=setInterval(()=>runBaselineDriftAnalysis(_0x317842),(_0x317842[_0x3e9982(0x141)][_0x3e9982(0x29d)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x317842),0x1388);}catch(_0x3dc692){_0x317842[_0x3e9982(0x252)][_0x3e9982(0x25d)](_0x3e9982(0x1f7)+_0x3dc692[_0x3e9982(0x1e7)]);}}function setupBriefingScheduler(_0x4b1c75){const _0x295089=a0_0x4a7c0f;try{if(_0x4b1c75[_0x295089(0x1e4)])_0x4b1c75[_0x295089(0x1e4)][_0x295089(0x132)]();if(!_0x4b1c75[_0x295089(0x141)][_0x295089(0x11a)])return;const _0x489d7c=(_0x4b1c75['config'][_0x295089(0x121)]||'08:00')[_0x295089(0x24b)](':'),_0x159150=parseInt(_0x489d7c[0x0])||0x8,_0x268df0=parseInt(_0x489d7c[0x1])||0x0,_0x2a26f5=_0x268df0+'\x20'+_0x159150+_0x295089(0x186);_0x4b1c75[_0x295089(0x1e4)]=schedule[_0x295089(0x150)](_0x2a26f5,()=>{sendMorningBriefing(_0x4b1c75);});}catch(_0x1806d4){_0x4b1c75[_0x295089(0x252)][_0x295089(0x25d)](_0x295089(0x1cb)+_0x1806d4[_0x295089(0x1e7)]);}}function a0_0xd0bf(){const _0x2939db=['SIMULATION:\x20Test-Vorschlag\x20f√ºr\x20','Deaktiviert\x20(Pro-Feature)','Detected\x20Patterns','python','Current\x20Threshold','ü§ñ\x20BUTLER:\x20Executing\x20Action\x20->\x20','Erstelle\x20ein\x20kurzes\x20\x27Guten\x20Morgen\x27\x20Briefing\x20basierend\x20auf\x20den\x20Events\x20der\x20letzten\x20Nacht.','date','apiKey','object','enum','text.alarm','shift','Alert\x20Status','briefingEnabled','analysis.energy.heatingScore','System\x20Mode','ü§ñ\x20Autopilot:\x20Running\x20periodic\x20analysis...','from','pip.exe','getLtmData','briefingTime','baselineDrift','val','sensorLastValues','presence','1133310EbCDEV','analysis.automation.autoApply','Gemini\x20Init\x20Error:\x20','door','N/A\x20(Learning)','[LOG]','analysis.automation.patternDetected','parse','Regel\x20erkannt:\x20','üß†\x20Triggering\x20Security\x20Training...','write','ANALYZE_GAIT','cancel','status','üõãÔ∏è\x20Triggering\x20Comfort\x20Analysis\x20(Pattern\x20Mining)...','Gait\x20Speed\x20Trend','LTM.driftAnalysis.driftDetails','System','toLocaleTimeString','üëâ\x20L√ñSUNG\x20(SSH):\x20sudo\x20chown\x20-R\x20iobroker:iobroker\x20','Last\x20Check','events.history','Trend\x20Value','Reset\x20Sched\x20Error:\x20','endsWith','subscribeStates','eventHistory','config','analysisHistory','licht','extendObjectAsync','KI-Modell\x20nicht\x20initialisiert','Could\x20not\x20load\x20rooms:\x20','‚ôªÔ∏è\x20Found\x20broken\x20VENV\x20(no\x20pip).\x20Deleting\x20and\x20recreating...','now','sendTo','push','TRAINING_COMPLETE','Ungew√∂hnliches\x20Bewegungsmuster!\x20(Score:\x20','contact','onUnload','payload','scheduleJob','number','exports','loc','ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20','temperatur','getOverviewData','Build\x20Topology','‚úÖ\x20INSTALL\x20SUCCESS.','\x20new\x20patterns.','Alert\x20Reason','Train\x20Security','analysis.automation.detectedPatterns','ANALYZE_SEQUENCE','lastAlertState','level','cogni-living\x20adapter\x20starting\x20(v','analysis.training','Fokus\x20auf\x20Familienroutinen.','Fokus\x20auf\x20Komfort.','Topology\x20Matrix','Training\x20Status','heating','stdin','channel','brightness','toString','enum.rooms.*','getMinutes','Delete\x20failed:\x20','VACATION','3463595sBwglJ','dailyDigests','LTM\x20Sched\x20Error:\x20','analysis.training.triggerEnergy','window','python3\x20-m\x20venv\x20\x22','HEALTH_TRAIN_RESULT','analysis.training.triggerHealth','node-schedule','analysis.security.lastCheck','TRAIN_HEALTH','analysis.isAlert','isProVersion','pip','LTM.rawEventLog','TRAIN_COMFORT','outdoorSensorId','analysis.health.lastCheck','rating','analysis.training.triggerTopology','Thermodynamics','system.isPresent','search','\x20*\x20*\x20*','system.config','TRAIN_ENERGY','LTM.driftAnalysis','Target\x20ID','type','bin','‚úÖ\x20Fast-Boot:\x20Environment\x20healthy.\x20Skipping\x20installation.','62160aYPFKJ','562078QgFtGO','analysis.training.triggerComfort','lampe','Failed:\x20','91PsEwsX','insulation','threshold','calendarInstance','version','Aktiv\x20(','WiFi\x20Presence\x20detected.','Trigger\x20Analysis','analysis.trigger','openweathermap','676056RhTAmh','Sec-Training\x20started...','LTM.dailyDigests','Restoring\x20sensor\x20cache...','getHours','Insulation\x20Score','Trigger\x20Action','enum.functions.*','schalter','LTM.processingStatus','¬∞C,\x20','unshift','level.dimmer','models/gemini-flash-latest','heizung','analysis.energy.insulationScore','Anomaly\x20Score','getEnums','trim','values','\x0aGrund:\x20','getCalendarNames','\x20Tage)','Daily\x20Digests','licenseKey','rule','indicator','Energy\x20Intelligence','üõ°Ô∏è\x20SECURITY\x20CHECK:\x20Score\x20','.Current.WeatherText','analysis.health.isAnomaly','platform','latitude','LTM.baselineStatus','pythonProcess','\x20=\x20','Adapter','success','startsWith','analysis.health.gaitSpeed','‚ö†Ô∏è\x20SECURITY\x20ALARM:\x20','python_service','analysis.health.trendValue','includes','analysis.security.currentThreshold','existsSync','Briefing\x20Sched\x20Error:\x20','getMonth','is_anomaly','telegram','daswetter','weatherunderground','getStateAsync','analysis.health.todayVector','ANOMALY','debug','diagnosis','main','LTM.trainingData.thermodynamics','requirements.txt','Who\x20is\x20present?','logDuplicates','Keine\x20Termine.','getForeignStateAsync','modeResetJob','setHours','PARTY','application/json','scanDevices','getTime','bind','briefingJob','HEALTH_RESULT','events.history_debug_00','message','thermostat','ltmLtbWindowDays','analysis.energy.forecast','analysisInterval','change_percent','indicator.alarm','bewegung','vacation','.communicate.request','currentSystemMode','Permission\x20denied','NORMAL','analysis.security.topologyMatrix','ack','PRIORIT√ÑT:\x20Gesundheit/AAL.','Drift\x20Sched\x20Error:\x20','Target\x20Value','temp','command','some','path','LTM','ENERGY_PREDICT_RESULT','[PYTHON]\x20','analysis.activitySummary','1873810ErpBOE','analysis.analysisHistory','Keine\x20Wetterdaten\x20verf√ºgbar.','Creating\x20new\x20VENV...','value','exitTimer','pr√§senz','üõãÔ∏è\x20BUTLER:\x20Found\x20','LTM.driftAnalysis.baselineDrift','kontakt','setObjectNotExistsAsync','boolean','Today\x20Vector\x20(15m)','targetId','GAIT_RESULT','377288ALeVkH','systemConfig','TOPOLOGY_RESULT','isExit','PONG','4FoJSiR','location','triggerDailyDigest','Security\x20Monitor','minDaysForBaseline','üìù\x20Feedback\x20received:\x20','occupancy','has','fenster','.forecast.current.state','targetValue','Error\x20launching\x20Python:\x20','subscribeForeignStatesAsync','genAI','‚ùå\x20VENV\x20CREATION\x20FAILED:\x20','Analysiere\x20ausgewogen.','getForeignObjectsAsync','events.lastEvent','selectedFunctionIds','power','warn','triggerBriefing','substring','analysis.health.trendDiagnosis','isPresent','rawEventLog','Event\x20History','setStateAsync','instance','system.mode','onReady','setState','info','reason','submitFeedback','setForeignStateAsync','@google/generative-ai','Installing\x20pip\x20packages...\x20(Caching\x20enabled)','analysis.automation.triggerAction','inactivityThresholdHours','analysis.security.lastScore','toISOString','t√ºr','Trend','length','useWeather','üîç\x20Scanning\x20for\x20devices\x20(Smart\x20Strategy)...','\x0aSTB:\x20','PREDICT_ENERGY','analysis.automation.targetValue','ltmJob','onMessage','Sequences','presenceDevices','split','klima','testContext','ready','forEach','LTM.trainingData.sequences','.Current.Temperature','log','writable','driftAnalysisTimer','N/A','exitGraceTimer','confidence','\x20->\x20','rmSync','notifyTelegramInstance','stdout','üï∏Ô∏è\x20Topology\x20Map\x20updated.','error','text','floor','toFixed','filter','analysis.training.status','weatherInstance','geminiApiKey','.venv','üêç\x20Python\x20Pong','stringify','useCalendar','üõë\x20PERMISSION\x20ERROR:\x20Der\x20Adapter\x20darf\x20das\x20VENV\x20nicht\x20anlegen.','members','python.exe','generateContent','switch','SECURITY_RESULT','button','callback','light','onStateChange','timestamp','.\x20(Is\x20\x27python3-venv\x27\x20installed?\x20\x27sudo\x20apt\x20install\x20python3-venv\x27)','fill','service.py','getGenerativeModel','role','keys','round','ltmStbWindowDays','constructor','Temperature\x20Forecast','join','Train\x20Energy','testApiKey','json','state','temperature','analysis.automation.description','geminiModel','pop','child_process','devices','.forecast.current.temp','‚ö†Ô∏è\x20Python\x20VENV\x20or\x20PIP\x20missing.\x20Installing...','toLowerCase','36xTVorG','analysis.alertReason','analysis.automation.targetId','detected','üêç\x20Checking\x20Python\x20environment...','OK:\x20','system.presenceWho','(((.+)+)+)+$','name','analysis.training.triggerSecurity','analysisTimer','response','Anomaly\x20Detected','namespace','simulateButler','Last\x20raw\x20event','getObjectAsync','ltmDriftCheckIntervalHours','Unknown','slice','üåÖ\x20Morning\x20Briefing:\x0a','GUEST','add','party','Pattern\x20Detected','Success:\x20','data','TREND_RESULT','dependencyInstallInProgress','details','getForeignObjectAsync','getFullYear','description','splice','Gemini\x20AI\x20initialized.','COMFORT_RESULT','system','common','TRAIN_SECURITY','analysis.health','.forecast.current.temperature','Kalender\x20deaktiviert.','isGracePeriodActive','win32','string','motion'];a0_0xd0bf=function(){return _0x2939db;};return a0_0xd0bf();}async function runBaselineDriftAnalysis(_0x2d6b6e){const _0x11dfd7=a0_0x4a7c0f;if(!_0x2d6b6e[_0x11dfd7(0x17b)]||!_0x2d6b6e[_0x11dfd7(0x285)])return;const _0x44473a=_0x2d6b6e[_0x11dfd7(0x141)][_0x11dfd7(0x27b)]||0xe;if(_0x2d6b6e[_0x11dfd7(0x170)][_0x11dfd7(0x241)]<_0x44473a+0x7){await _0x2d6b6e[_0x11dfd7(0x230)](LTM_DP_DRIFT_STATUS,{'val':_0x11dfd7(0x12a),'ack':!![]});return;}const _0x256f8e=_0x2d6b6e[_0x11dfd7(0x170)][_0x11dfd7(0x29f)](-_0x44473a),_0x3722c3=_0x2d6b6e[_0x11dfd7(0x170)]['slice'](0x0,_0x2d6b6e[_0x11dfd7(0x170)][_0x11dfd7(0x241)]-_0x44473a),_0x30131c=_0x11dfd7(0x154)+JSON[_0x11dfd7(0x267)](_0x3722c3)+_0x11dfd7(0x244)+JSON['stringify'](_0x256f8e);try{const _0xf4f450=await _0x2d6b6e[_0x11dfd7(0x285)][_0x11dfd7(0x26c)](_0x30131c),_0x53f483=JSON[_0x11dfd7(0x12d)](_0xf4f450[_0x11dfd7(0x297)][_0x11dfd7(0x25e)]()['replace'](/```json|```/g,'')[_0x11dfd7(0x1af)]());_0x53f483[_0x11dfd7(0x122)]&&(await _0x2d6b6e[_0x11dfd7(0x230)](LTM_DP_DRIFT_STATUS,{'val':_0x53f483[_0x11dfd7(0x122)],'ack':!![]}),await _0x2d6b6e['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x53f483['driftDetails'],'ack':!![]}),await _0x2d6b6e[_0x11dfd7(0x230)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date['now'](),'ack':!![]}));}catch(_0x289406){}}class CogniLiving extends utils[a0_0x4a7c0f(0x1c1)]{constructor(_0x5d52f5){const _0xb2981b=a0_0x4a7c0f;super({..._0x5d52f5,'name':'cogni-living'}),this[_0xb2981b(0x140)]=[],this['analysisHistory']=[],this[_0xb2981b(0x22e)]=[],this['dailyDigests']=[],this[_0xb2981b(0x124)]={},this[_0xb2981b(0x211)]={'latitude':0x0,'longitude':0x0,'city':''},this['isPresent']=!![],this[_0xb2981b(0x206)]=null,this[_0xb2981b(0x256)]=null,this['isGracePeriodActive']=![],this[_0xb2981b(0x222)]=null,this[_0xb2981b(0x285)]=null,this[_0xb2981b(0x1f1)]=SYSTEM_MODES[_0xb2981b(0x1f3)],this['isProVersion']=![],this[_0xb2981b(0x15e)]=![],this['systemUUID']='unknown',this['analysisTimer']=null,this[_0xb2981b(0x247)]=null,this['modeResetJob']=null,this['driftAnalysisTimer']=null,this[_0xb2981b(0x1e4)]=null,this[_0xb2981b(0x1bf)]=null,this[_0xb2981b(0x2a8)]=![],this['on'](_0xb2981b(0x24e),this['onReady'][_0xb2981b(0x1e3)](this)),this['on']('stateChange',this[_0xb2981b(0x272)][_0xb2981b(0x1e3)](this)),this['on']('unload',this[_0xb2981b(0x14e)]['bind'](this)),this['on']('message',this[_0xb2981b(0x248)][_0xb2981b(0x1e3)](this));}async[a0_0x4a7c0f(0x233)](){const _0x35783f=a0_0x4a7c0f;this[_0x35783f(0x252)][_0x35783f(0x235)](_0x35783f(0x160)+this[_0x35783f(0x197)]+')\x20-\x20SAFE\x20BOOT');if(!checkAndInstall(this))return;await startSystem(this);}[a0_0x4a7c0f(0x14e)](_0x429aed){const _0x1d58b9=a0_0x4a7c0f;if(this[_0x1d58b9(0x296)])clearInterval(this['analysisTimer']);if(this[_0x1d58b9(0x254)])clearInterval(this[_0x1d58b9(0x254)]);if(this[_0x1d58b9(0x247)])this[_0x1d58b9(0x247)]['cancel']();if(this['modeResetJob'])this[_0x1d58b9(0x1dd)][_0x1d58b9(0x132)]();if(this[_0x1d58b9(0x1e4)])this['briefingJob']['cancel']();if(this[_0x1d58b9(0x206)])clearTimeout(this[_0x1d58b9(0x206)]);if(this[_0x1d58b9(0x256)])clearTimeout(this['exitGraceTimer']);stopPythonService(this),_0x429aed();}async[a0_0x4a7c0f(0x272)](_0x167e7d,_0x58c542){const _0x29908c=a0_0x4a7c0f;if(!_0x58c542||this['dependencyInstallInProgress'])return;if(_0x167e7d[_0x29908c(0x1c8)](_0x29908c(0x1ce))&&_0x167e7d[_0x29908c(0x13e)]('communicate.request')&&_0x58c542[_0x29908c(0x123)]){await handleTelegramResponse(this,_0x58c542[_0x29908c(0x123)]);return;}if(_0x167e7d===this[_0x29908c(0x299)]+'.'+SYSTEM_DP_MODE){if(_0x58c542[_0x29908c(0x123)]&&Object[_0x29908c(0x1b0)](SYSTEM_MODES)[_0x29908c(0x1c8)](_0x58c542[_0x29908c(0x123)])){this[_0x29908c(0x1f1)]=_0x58c542[_0x29908c(0x123)];if(_0x58c542[_0x29908c(0x123)]===SYSTEM_MODES[_0x29908c(0x16e)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x58c542[_0x29908c(0x1f5)])this['setState'](_0x167e7d,{'val':this[_0x29908c(0x1f1)],'ack':!![]});return;}if(!_0x58c542[_0x29908c(0x1f5)]){_0x167e7d['includes'](_0x29908c(0x19b))&&_0x58c542[_0x29908c(0x123)]&&(this['setState'](_0x167e7d,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x167e7d[_0x29908c(0x1c8)](_0x29908c(0x217))&&_0x58c542[_0x29908c(0x123)]){this[_0x29908c(0x234)](_0x167e7d,{'val':![],'ack':!![]});if(this['isProVersion'])createDailyDigest(this);}_0x167e7d[_0x29908c(0x1c8)](_0x29908c(0x22a))&&_0x58c542[_0x29908c(0x123)]&&(this[_0x29908c(0x234)](_0x167e7d,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x167e7d[_0x29908c(0x1c8)]('automation.triggerAction')&&_0x58c542[_0x29908c(0x123)]&&(this['setState'](_0x167e7d,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x167e7d[_0x29908c(0x1c8)](_0x29908c(0x295))&&_0x58c542[_0x29908c(0x123)]){this[_0x29908c(0x234)](_0x167e7d,{'val':![],'ack':!![]});if(this[_0x29908c(0x17b)])try{const _0x340a42=await this['getStateAsync'](_0x29908c(0x250));if(_0x340a42&&_0x340a42[_0x29908c(0x123)]){const _0x48ed86=JSON['parse'](_0x340a42[_0x29908c(0x123)]);this[_0x29908c(0x252)][_0x29908c(0x235)](_0x29908c(0x12f)),this[_0x29908c(0x230)](_0x29908c(0x262),{'val':_0x29908c(0x19e),'ack':!![]}),sendToPython(this,_0x29908c(0x2b2),{'sequences':_0x48ed86});}}catch(_0x2f60e3){this[_0x29908c(0x252)][_0x29908c(0x25d)]('Training\x20Error:\x20'+_0x2f60e3[_0x29908c(0x1e7)]);}}if(_0x167e7d[_0x29908c(0x1c8)](_0x29908c(0x176))&&_0x58c542[_0x29908c(0x123)]){this[_0x29908c(0x234)](_0x167e7d,{'val':![],'ack':!![]});if(this[_0x29908c(0x17b)])try{const _0x469408=await this[_0x29908c(0x1d1)](LTM_DP_DAILY_DIGESTS);if(_0x469408&&_0x469408[_0x29908c(0x123)])sendToPython(this,_0x29908c(0x179),{'digests':JSON[_0x29908c(0x12d)](_0x469408[_0x29908c(0x123)])});}catch(_0x33c317){}}if(_0x167e7d[_0x29908c(0x1c8)](_0x29908c(0x172))&&_0x58c542[_0x29908c(0x123)]){this[_0x29908c(0x234)](_0x167e7d,{'val':![],'ack':!![]});if(this[_0x29908c(0x17b)])try{const _0x695c02=await this[_0x29908c(0x1d1)]('LTM.trainingData.thermodynamics');if(_0x695c02&&_0x695c02[_0x29908c(0x123)])sendToPython(this,_0x29908c(0x188),{'points':JSON['parse'](_0x695c02[_0x29908c(0x123)])});}catch(_0x552366){}}if(_0x167e7d[_0x29908c(0x1c8)]('analysis.training.triggerComfort')&&_0x58c542[_0x29908c(0x123)]){this['setState'](_0x167e7d,{'val':![],'ack':!![]});if(this[_0x29908c(0x17b)])try{const _0x4c6dc3=await this[_0x29908c(0x1d1)](LTM_DP_RAW_LOG);_0x4c6dc3&&_0x4c6dc3['val']&&(this['log'][_0x29908c(0x235)](_0x29908c(0x134)),sendToPython(this,_0x29908c(0x17e),{'events':JSON[_0x29908c(0x12d)](_0x4c6dc3['val'])}));}catch(_0x273750){}}if(_0x167e7d[_0x29908c(0x1c8)](_0x29908c(0x182))&&_0x58c542[_0x29908c(0x123)]){this[_0x29908c(0x234)](_0x167e7d,{'val':![],'ack':!![]});if(this[_0x29908c(0x17b)])try{const _0x561c88=await this[_0x29908c(0x1d1)](_0x29908c(0x250));if(_0x561c88&&_0x561c88[_0x29908c(0x123)]){const _0x174ee7=JSON[_0x29908c(0x12d)](_0x561c88[_0x29908c(0x123)]);this[_0x29908c(0x252)]['info']('üï∏Ô∏è\x20Building\x20Topology\x20Matrix...'),sendToPython(this,'BUILD_TOPOLOGY',{'sequences':_0x174ee7});}}catch(_0x525e62){this[_0x29908c(0x252)][_0x29908c(0x25d)]('Topology\x20Error:\x20'+_0x525e62[_0x29908c(0x1e7)]);}}return;}if(this['config']['presenceDevices']&&this[_0x29908c(0x141)][_0x29908c(0x24a)][_0x29908c(0x1c8)](_0x167e7d)){await checkWifiPresence(this);return;}const _0x20a709=(this['config']['devices']||[])['find'](_0x30e8e9=>_0x30e8e9['id']===_0x167e7d);if(_0x20a709)processSensorEvent(this,_0x167e7d,_0x58c542,_0x20a709);}async[a0_0x4a7c0f(0x248)](_0x5ceff9){const _0x41dfe5=a0_0x4a7c0f;if(typeof _0x5ceff9===_0x41dfe5(0x115)&&_0x5ceff9[_0x41dfe5(0x1e7)]){if(_0x5ceff9[_0x41dfe5(0x1fa)]===_0x41dfe5(0x280)){const _0x84ec12=_0x5ceff9[_0x41dfe5(0x1e7)][_0x41dfe5(0x114)]||this[_0x41dfe5(0x141)]['geminiApiKey'];if(!_0x84ec12)return this['sendTo'](_0x5ceff9['from'],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':![],'message':'Kein\x20API\x20Key.'},_0x5ceff9[_0x41dfe5(0x270)]);try{const _0x3b6f51=new GoogleGenerativeAI(_0x84ec12),_0x199856=_0x3b6f51['getGenerativeModel']({'model':GEMINI_MODEL}),_0x39996c=await _0x199856['generateContent']('Hi');this[_0x41dfe5(0x149)](_0x5ceff9[_0x41dfe5(0x11e)],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':!![],'message':_0x41dfe5(0x291)+_0x39996c[_0x41dfe5(0x297)][_0x41dfe5(0x25e)]()},_0x5ceff9[_0x41dfe5(0x270)]);}catch(_0x5411cd){this[_0x41dfe5(0x149)](_0x5ceff9['from'],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':![],'message':'Err:\x20'+_0x5411cd[_0x41dfe5(0x1e7)]},_0x5ceff9[_0x41dfe5(0x270)]);}}else{if(_0x5ceff9[_0x41dfe5(0x1fa)]===_0x41dfe5(0x24d)){const _0x385d16=await getWeatherContext(this),_0x48a04e=await getCalendarContext(this);this[_0x41dfe5(0x149)](_0x5ceff9['from'],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':!![],'weather':_0x385d16,'calendar':_0x48a04e},_0x5ceff9[_0x41dfe5(0x270)]);}else{if(_0x5ceff9[_0x41dfe5(0x1fa)]===_0x41dfe5(0x120)){if(!this[_0x41dfe5(0x17b)])return this[_0x41dfe5(0x149)](_0x5ceff9['from'],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':![],'isPro':![]},_0x5ceff9[_0x41dfe5(0x270)]);let _0xe530ba={'status':_0x41dfe5(0x255)};try{const _0xe98f03=await this[_0x41dfe5(0x1d1)](LTM_DP_DRIFT_STATUS);_0xe530ba[_0x41dfe5(0x133)]=_0xe98f03?_0xe98f03['val']:_0x41dfe5(0x255);}catch(_0x596707){}this[_0x41dfe5(0x149)](_0x5ceff9[_0x41dfe5(0x11e)],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x41dfe5(0x170)],'driftAnalysis':_0xe530ba,'analysisHistory':this[_0x41dfe5(0x142)]},_0x5ceff9[_0x41dfe5(0x270)]);}else{if(_0x5ceff9[_0x41dfe5(0x1fa)]===_0x41dfe5(0x156)){const _0x5bc9fa=this['dailyDigests'][_0x41dfe5(0x241)],_0x1dcdf9=new Date(),_0xfcae96=new Date(_0x1dcdf9[_0x41dfe5(0x2ab)](),_0x1dcdf9[_0x41dfe5(0x1cc)](),_0x1dcdf9['getDate']())[_0x41dfe5(0x1e2)](),_0x5571ae=this[_0x41dfe5(0x22e)][_0x41dfe5(0x261)](_0x33a158=>new Date(_0x33a158['timestamp'])[_0x41dfe5(0x1e2)]()>_0xfcae96)[_0x41dfe5(0x241)],_0x5624e9=new Array(0x18)[_0x41dfe5(0x275)](0x0);this[_0x41dfe5(0x22e)][_0x41dfe5(0x24f)](_0x400e93=>{const _0x5f3b27=_0x41dfe5,_0x2d3d4a=new Date(_0x400e93[_0x5f3b27(0x273)]);if(_0x2d3d4a[_0x5f3b27(0x1e2)]()>_0xfcae96)_0x5624e9[_0x2d3d4a['getHours']()]++;});let _0x393eac={'status':_0x41dfe5(0x255)};try{const _0x4edf47=await this[_0x41dfe5(0x1d1)](LTM_DP_DRIFT_STATUS);_0x393eac['status']=_0x4edf47?_0x4edf47[_0x41dfe5(0x123)]:_0x41dfe5(0x255);}catch(_0x5ee7fa){}let _0x533a57='';try{const _0x3527c6=await this['getStateAsync'](_0x41dfe5(0x292));_0x533a57=_0x3527c6?_0x3527c6[_0x41dfe5(0x123)]:'';}catch(_0x4a7d94){}let _0x6e916b=null;!this[_0x41dfe5(0x285)]&&(_0x6e916b=this[_0x41dfe5(0x141)][_0x41dfe5(0x264)]?_0x41dfe5(0x145):'Kein\x20API\x20Key!');let _0x46060f={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x48c795=await this[_0x41dfe5(0x1d1)](_0x41dfe5(0x12c));if(_0x48c795&&_0x48c795[_0x41dfe5(0x123)]){_0x46060f[_0x41dfe5(0x28f)]=!![];const _0x17308c=await this[_0x41dfe5(0x1d1)](_0x41dfe5(0x284));_0x46060f[_0x41dfe5(0x2ac)]=_0x17308c?_0x17308c['val']:'';const _0x27a8aa=await this[_0x41dfe5(0x1d1)]('analysis.automation.targetId');_0x46060f[_0x41dfe5(0x20e)]=_0x27a8aa?_0x27a8aa[_0x41dfe5(0x123)]:'';const _0x509241=await this[_0x41dfe5(0x1d1)](_0x41dfe5(0x246));_0x46060f[_0x41dfe5(0x21f)]=_0x509241?_0x509241['val']:'';}const _0x4d5845=await this[_0x41dfe5(0x1d1)]('analysis.automation.autoApply');_0x46060f['autoApply']=_0x4d5845?!!_0x4d5845['val']:![];}catch(_0x1bd906){}this[_0x41dfe5(0x149)](_0x5ceff9[_0x41dfe5(0x11e)],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':!![],'eventHistory':this[_0x41dfe5(0x140)][_0x41dfe5(0x29f)](0x0,0xf),'stats':{'digestCount':_0x5bc9fa,'eventCountToday':_0x5571ae,'hourlyActivity':_0x5624e9,'driftStatus':_0x393eac[_0x41dfe5(0x133)],'isPresent':this[_0x41dfe5(0x22d)],'presenceWho':_0x533a57,'minDays':this[_0x41dfe5(0x141)][_0x41dfe5(0x219)]||0x7,'stbDays':this[_0x41dfe5(0x141)][_0x41dfe5(0x27b)]||0xe,'ltbDays':this[_0x41dfe5(0x141)][_0x41dfe5(0x1e9)]||0x3c,'systemError':_0x6e916b},'automation':_0x46060f},_0x5ceff9[_0x41dfe5(0x270)]);}else{if(_0x5ceff9[_0x41dfe5(0x1fa)]===_0x41dfe5(0x1e1))try{const _0x38d073=await scanForDevices(this,_0x5ceff9[_0x41dfe5(0x1e7)]||{});this['sendTo'](_0x5ceff9[_0x41dfe5(0x11e)],_0x5ceff9['command'],{'success':!![],'devices':_0x38d073},_0x5ceff9['callback']);}catch(_0x4e985e){this[_0x41dfe5(0x149)](_0x5ceff9[_0x41dfe5(0x11e)],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':![],'error':_0x4e985e[_0x41dfe5(0x1e7)]},_0x5ceff9[_0x41dfe5(0x270)]);}else{if(_0x5ceff9['command']===_0x41dfe5(0x1ae)){const _0x3a7fac=await this[_0x41dfe5(0x225)](_0x41dfe5(0x1a4),_0x41dfe5(0x116)),_0x31610c=[];if(_0x3a7fac)for(const _0x237d72 in _0x3a7fac){const _0x2473a8=_0x3a7fac[_0x237d72],_0x18ab7b=(_0x2473a8[_0x41dfe5(0x2b1)]&&typeof _0x2473a8[_0x41dfe5(0x2b1)][_0x41dfe5(0x294)]==='object'?_0x2473a8[_0x41dfe5(0x2b1)][_0x41dfe5(0x294)]['de']:_0x2473a8[_0x41dfe5(0x2b1)][_0x41dfe5(0x294)])||_0x2473a8[_0x41dfe5(0x2b1)][_0x41dfe5(0x294)];_0x31610c['push']({'id':_0x237d72,'name':_0x18ab7b});}const _0x3edaaf=await this[_0x41dfe5(0x225)](_0x41dfe5(0x16b),'enum'),_0x3e2236=[];if(_0x3edaaf)for(const _0x1dd7d7 in _0x3edaaf){const _0x1770d2=_0x3edaaf[_0x1dd7d7],_0x49744c=(_0x1770d2['common']&&typeof _0x1770d2['common'][_0x41dfe5(0x294)]==='object'?_0x1770d2[_0x41dfe5(0x2b1)]['name']['de']:_0x1770d2[_0x41dfe5(0x2b1)][_0x41dfe5(0x294)])||_0x1dd7d7[_0x41dfe5(0x24b)]('.')[_0x41dfe5(0x286)]();_0x3e2236[_0x41dfe5(0x14a)](_0x49744c);}this[_0x41dfe5(0x149)](_0x5ceff9[_0x41dfe5(0x11e)],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':!![],'enums':_0x31610c,'rooms':_0x3e2236},_0x5ceff9[_0x41dfe5(0x270)]);}else{if(_0x5ceff9['command']===_0x41dfe5(0x1b2)){const _0x1021d4=_0x5ceff9['message'][_0x41dfe5(0x231)];if(!_0x1021d4)return this[_0x41dfe5(0x149)](_0x5ceff9['from'],_0x5ceff9['command'],{'success':![],'error':'No\x20instance'},_0x5ceff9[_0x41dfe5(0x270)]);const _0x53cab5=await getCalendarNames(this,_0x1021d4);this['sendTo'](_0x5ceff9[_0x41dfe5(0x11e)],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':!![],'names':_0x53cab5},_0x5ceff9[_0x41dfe5(0x270)]);}else{if(_0x5ceff9[_0x41dfe5(0x1fa)]===_0x41dfe5(0x29a)){const {targetId:_0x2da3e0,targetValue:_0xf19586}=_0x5ceff9[_0x41dfe5(0x1e7)];this[_0x41dfe5(0x252)][_0x41dfe5(0x235)]('üß™\x20Simulating\x20Butler\x20Proposal:\x20'+_0x2da3e0+_0x41dfe5(0x1c0)+_0xf19586),await this[_0x41dfe5(0x230)](_0x41dfe5(0x12c),{'val':!![],'ack':!![]}),await this['setStateAsync']('analysis.automation.description',{'val':_0x41dfe5(0x2ba)+_0x2da3e0,'ack':!![]}),await this['setStateAsync'](_0x41dfe5(0x28e),{'val':_0x2da3e0,'ack':!![]}),await this[_0x41dfe5(0x230)](_0x41dfe5(0x246),{'val':_0xf19586,'ack':!![]}),this[_0x41dfe5(0x149)](_0x5ceff9['from'],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':!![]},_0x5ceff9[_0x41dfe5(0x270)]);}else{if(_0x5ceff9['command']===_0x41dfe5(0x237)){const {historyId:_0x325eef,rating:_0x3d02c6,comment:_0x3040f4,alertReason:_0x6c515e}=_0x5ceff9['message'];_0x325eef&&_0x3d02c6?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x325eef,'rating':_0x3d02c6,'comment':_0x3040f4,'alertReason':_0x6c515e}),this[_0x41dfe5(0x149)](_0x5ceff9[_0x41dfe5(0x11e)],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':!![]},_0x5ceff9[_0x41dfe5(0x270)])):this['sendTo'](_0x5ceff9['from'],_0x5ceff9[_0x41dfe5(0x1fa)],{'success':![],'error':'Missing\x20data'},_0x5ceff9[_0x41dfe5(0x270)]);}else _0x5ceff9['command']==='dismissAutomation'&&(this[_0x41dfe5(0x252)][_0x41dfe5(0x235)]('User\x20dismissed\x20automation\x20proposal.'),await this[_0x41dfe5(0x230)](_0x41dfe5(0x12c),{'val':![],'ack':!![]}),await this[_0x41dfe5(0x230)](_0x41dfe5(0x284),{'val':'','ack':!![]}),this['sendTo'](_0x5ceff9[_0x41dfe5(0x11e)],_0x5ceff9['command'],{'success':!![]},_0x5ceff9[_0x41dfe5(0x270)]));}}}}}}}}}}}if(require[a0_0x4a7c0f(0x1d6)]!==module)module[a0_0x4a7c0f(0x152)]=_0x2b40c4=>new CogniLiving(_0x2b40c4);else new CogniLiving();