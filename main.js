const a0_0x4b7593=a0_0x4641;(function(_0x43952b,_0xbf717){const _0x572871=a0_0x4641,_0x3b1556=_0x43952b();while(!![]){try{const _0x41fdad=-parseInt(_0x572871(0x19b))/0x1+parseInt(_0x572871(0x16f))/0x2*(-parseInt(_0x572871(0x153))/0x3)+-parseInt(_0x572871(0xd8))/0x4*(parseInt(_0x572871(0x9c))/0x5)+-parseInt(_0x572871(0x19c))/0x6+-parseInt(_0x572871(0x12a))/0x7+parseInt(_0x572871(0x14f))/0x8+parseInt(_0x572871(0xd9))/0x9;if(_0x41fdad===_0xbf717)break;else _0x3b1556['push'](_0x3b1556['shift']());}catch(_0x34f4fd){_0x3b1556['push'](_0x3b1556['shift']());}}}(a0_0x4640,0x4d055));const a0_0x43d163=(function(){let _0x1a0391=!![];return function(_0x207b29,_0x2ac92c){const _0x56e0ec=_0x1a0391?function(){const _0x52ce69=a0_0x4641;if(_0x2ac92c){const _0x2f1ef3=_0x2ac92c[_0x52ce69(0x1b0)](_0x207b29,arguments);return _0x2ac92c=null,_0x2f1ef3;}}:function(){};return _0x1a0391=![],_0x56e0ec;};}()),a0_0x35aa57=a0_0x43d163(this,function(){const _0x309dd0=a0_0x4641;return a0_0x35aa57[_0x309dd0(0x1e9)]()['search'](_0x309dd0(0x118))[_0x309dd0(0x1e9)]()[_0x309dd0(0x1cf)](a0_0x35aa57)[_0x309dd0(0x196)](_0x309dd0(0x118));});function a0_0x4641(_0x1e7f33,_0x4b2f9b){const _0x2ae5f3=a0_0x4640();return a0_0x4641=function(_0x35aa57,_0x43d163){_0x35aa57=_0x35aa57-0x91;let _0x4640f3=_0x2ae5f3[_0x35aa57];return _0x4640f3;},a0_0x4641(_0x1e7f33,_0x4b2f9b);}a0_0x35aa57();function a0_0x4640(){const _0x33a26b=['Fokus\x20auf\x20Maximierung\x20von\x20Komfort,\x20Automatisierungseffizienz\x20und\x20Energieeinsparung.','isPresent','notifyPushoverEnabled','Error:\x20','Exit-Timer\x20abgelaufen:\x20Keine\x20Bewegung\x20innen\x20erkannt\x20->\x20ABWESEND.','send','cleanUpZombies','checkLtmDriftObjects','flur','Sending\x20Prompt\x20(Length:\x20','setObjectNotExistsAsync','ltmJob','LTM.driftAnalysis.lastCheck','events.history_debug_04','\x0a!!!\x20EXTERNAL\x20SYSTEM\x20WARNING\x20!!!\x0a','lastCheck','summary','‚úÖ\x20Gemini\x20Response\x20received.','command','geminiApiKey','rawEventLog','baselineDrift','number','stringify','isProVersion','currentSystemMode','saveRawEventLog','analysis.trigger','N/A\x20(Learning)','Activity\x20Summary','setPresence','cogni-living','s\x20Grace).','modeResetJob','getObjectAsync','processSensorEvent','Fenster/T√ºr','(((.+)+)+)+$','Bewegung\x20w√§hrend\x20Exit-Timer\x20erkannt\x20->\x20Bewohner\x20ist\x20noch\x20da.','licenseKey','notifyWhatsappInstance','CRITICAL\x20WARNING:\x20No\x20sensor\x20activity\x20detected\x20for\x20','channel','getLtmData','PRO-','Feedback\x20Log','find','date','Analysis\x20Error:\x20','delObjectAsync','2-digit','Event\x20History','unshift','cancel','\x22\x20was\x20','2150309FOjsLz','lastAlertState','\x20Tage)','driftAnalysisTimer','retry','error','Deaktiviert\x20(Pro-Feature)','warn','ABWESEND\x20‚úàÔ∏è','Ignoring\x20event\x20during\x20Exit\x20Grace\x20Period:\x20','analysis.lastResult','LTM.processingStatus','LTM.dailyDigests','button','createAllObjects','city','loadHistoryFromState','Trigger\x20Digest','state','LTM','LTM.baselineStatus','native','notifyTelegramEnabled',')...','siren','substring','LTM.driftAnalysis','events.history','triggerDailyDigest','aiPersona','indicator.alarm.fire','Urlaub','Automation\x20Proposals','[Test]\x20Notification','analysis.history_debug_02','message','\x20sent','2717168phwCFR','Comfort\x20Summary','exitTimer','analysisTimer','219zpROSO','minDaysForBaseline','system.mode','NORMAL','\x20events','Normal','updateAnalysisHistory','\x20sensors...','@google/generative-ai','0\x203\x20*\x20*\x20*','common','Pattern\x20Detected','status','scanForDevices','Cogni-Living\x20Alert','Comfort\x20Suggestion','loadRawEventLog','length','analysis.alertReason','trim','getStateAsync','startExitTimer','geminiModel','getSystemUUID','replace','sendTo','parse','details','13466twXosT','activity','Processing\x20Status','notifyPushoverInstance','push','livingContext','alertReason','analysis.feedbackHistory','indicator.alarm','uuid-error','AI\x20Alert\x20Status','Gemini\x20AI\x20initialized.','GUEST','System\x20Status\x20&\x20Control','‚ùå\x20Gemini\x20Model\x20not\x20initialized!\x20Check\x20API\x20Key.','Daily\x20Digests','.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','Last\x20raw\x20event','notifyWhatsappEnabled','notifyEmailInstance','Drift\x20Status','User\x20Feedback:\x20Alarm\x20\x22','‚ö†Ô∏è\x20Alarm','LTM.triggerDailyDigest','ltmLtbWindowDays','analysis.deviationFromBaseline','saveFeedback','bind','notifySignalRecipient','system.meta.uuid','uuid-not-found','ltmStbWindowDays','getForeignObjectAsync','includes','ANWESEND\x20üè†','log','üö®üö®\x20NOTFALL','\x20min).\x20Watchdog\x20Limit:\x20','setState','search','callback','Raw\x20Log','analysis.activitySummary','config','88217Evumlw','3562596ayyhGX','runAutopilot','Action','sound','system.isPresent','now','onReady','long','toFixed','setupLtmScheduler','eingang','system.config','exitGraceTimer','0\x204\x20*\x20*\x20*','analysis.history_debug_01','analysis.history_debug_04','testNotification','Success:\x20Compressed\x20','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20SCHEMA:\x20{\x20\x22activity\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22deviationFromBaseline\x22:\x20\x22string\x22,\x20\x22isAlert\x22:\x20bool,\x20\x22isEmergency\x22:\x20bool,\x20\x22alertReason\x22:\x20\x22string\x22\x20},\x20\x22comfort\x22:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22suggestion\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22patternDetected\x22:\x20bool,\x20\x22description\x22:\x20\x22string\x22,\x20\x22suggestedAction\x22:\x20\x22string\x22\x20}\x20}\x20}','string','apply','Starting\x20Autopilot\x20(','analysis.isAlert','Skipped\x20(No\x20AI\x20or\x20Data)','events.lastEvent','text.alarm','createDailyDigest','checkLtmObjects','system','enum','main','runGeminiAnalysis','type','name','saveDailyDigests','enum.functions.*','ROLLE:\x20Smart\x20Home\x20Analyst.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20AKTUELLE\x20ZEIT:\x20','\x20(EMERGENCY)','json','isGracePeriodActive','getForeignObjectsAsync','subscribeStates','abortExitTimer','Logbook','notifyTelegramInstance','join','application/json','sendNotification','\x20Stunden!','setupDriftAnalysisScheduler','from','constructor','Sending\x20notification:\x20\x22','isEmergency','Adapter','[TEST]\x20','PARTY','Fokus\x20auf\x20Familienroutinen,\x20Kindersicherheit\x20und\x20allgemeines\x20Haushaltsmanagement.','analysis.analysisHistory','indicator','getForeignStateAsync','apiKey','expire','analysisInterval','party','events.history_debug_03','notifyPushoverRecipient','PRIORIT√ÑT:\x20Sicherheit.\x20Erkenne\x20Eindringlinge,\x20ungew√∂hnliche\x20Anwesenheit.','isAlert','latitude','notifyWhatsappRecipient','values','Drift\x20Analysis','scheduleJob','Gast','ready','val','toString','systemConfig','onStateChange','catch','sendToAsync','exports','submitFeedback','node-schedule','Last\x20Result','analysis.history_debug_03','\x20hours.\x20The\x20resident\x20might\x20be\x20incapacitated.\x20Risk\x20level:\x20HIGH.','Alert\x20Reason','.\x20PERSONA:\x20','üö®\x20EMERGENCY','notifyTelegramRecipient','splice','ack','2192180nCrcAz','loadDailyDigests','extendObjectAsync','onMessage','map','events.history_debug_01','inactivityMonitoringEnabled','Started\x20at\x20','Missing\x20data','boolean','runBaselineDriftAnalysis','eventHistory','cogni-living\x20adapter\x20starting\x20(v','analysisHistory','Party','TEST-PRO-KEY','pop','Trigger\x20Analysis','Gemini\x20Init\x20Error:\x20','analysis.comfortSuggestion','.\x0a\x20\x20\x20\x20\x20\x20\x20\x20','haust√ºr','Konnte\x20System-Standort\x20nicht\x20laden.','object','ltmDriftCheckIntervalHours','unload','onUnload','toLocaleString','normal','notifySignalInstance','genAI','slice','analysis.isEmergency','üö®\x20Dead\x20Man\x27s\x20Switch:\x20Keine\x20Aktivit√§t\x20seit\x20','analysis.automation.description','setStateAsync','setupModeResetScheduler','longitude','generateContent','.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20KONTEXT:\x20','feedbackHistory','location','test','getEnums','stateChange','toLowerCase','Manual\x20Analysis\x20Trigger\x20detected!','toISOString','dailyDigests','ROLLE:\x20Data\x20Scientist.\x20VERGLEICHE:\x20Dataset\x20A\x20(Recent)\x20vs\x20B\x20(Established).\x20ZIEL:\x20Erkenne\x20Drift.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aB\x20(LTB):\x0a','info','debug','analysis.automation','sensorLastValues','notifySignalEnabled','üìç\x20Standort\x20geladen:\x20','analysis.history_debug_00','Success','models/gemini-flash-latest','getGenerativeModel','4orPmsT','17054514sVFhbA','min\x20Timer,\x20','VACATION','loadSystemMode','inactivityThresholdHours','events.history_debug_02','text','@iobroker/adapter-core','testApiKey','guest','ü§ñ\x20Starting\x20Gemini\x20Analysis...','activityLevel','resetAnalysisStates','ROLLE:\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20KONTEXT:\x20','\x0a\x0aA\x20(STB):\x0a','Lernphase\x20(','\x0a\x20\x20\x20\x20\x20\x20\x20\x20EVENTS:\x20','devices','generic','LTM.driftAnalysis.driftDetails','uuid','Deviation','namespace','driftDetails','N/A','updateBaselineStatus'];a0_0x4640=function(){return _0x33a26b;};return a0_0x4640();}'use strict';const utils=require(a0_0x4b7593(0xe0)),{GoogleGenerativeAI}=require(a0_0x4b7593(0x15b)),schedule=require(a0_0x4b7593(0x92)),HISTORY_MAX_SIZE=0x32,FEEDBACK_MAX_SIZE=0x14,GEMINI_MODEL='models/gemini-flash-latest',ANALYSIS_HISTORY_MAX_SIZE=0x64,RAW_LOG_MAX_SIZE=0x5dc,DAILY_DIGEST_MAX_SIZE_LIMIT=0xb4,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,LTM_SCHEDULE=a0_0x4b7593(0x15c),LTM_DP_RAW_LOG='LTM.rawEventLog',LTM_DP_DAILY_DIGESTS=a0_0x4b7593(0x136),LTM_DP_STATUS=a0_0x4b7593(0x135),LTM_DP_TRIGGER_DIGEST=a0_0x4b7593(0x186),LTM_DP_BASELINE_STATUS=a0_0x4b7593(0x13e),LTM_DP_DRIFT_CHANNEL=a0_0x4b7593(0x144),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x4b7593(0xec),LTM_DP_DRIFT_LAST_CHECK=a0_0x4b7593(0xff),SYSTEM_DP_MODE=a0_0x4b7593(0x155),MODE_RESET_SCHEDULE=a0_0x4b7593(0x1a9),SYSTEM_MODES={'NORMAL':a0_0x4b7593(0xb8),'VACATION':'vacation','PARTY':a0_0x4b7593(0x1dc),'GUEST':a0_0x4b7593(0xe2)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x4b7593(0x1d4)],SYSTEM_MODES[a0_0x4b7593(0x17b)]],EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,PERSONA_MAPPING={'generic':'Analysiere\x20ausgewogen\x20auf\x20Gesundheit,\x20Sicherheit\x20und\x20Komfort.','senior_aal':'PRIORIT√ÑT:\x20Gesundheit\x20und\x20Sicherheit\x20f√ºr\x20Senioren\x20(AAL).\x20Erkenne\x20Inaktivit√§t,\x20potenzielle\x20St√ºrze\x20(indirekt),\x20ungew√∂hnliche\x20n√§chtliche\x20Aktivit√§t.','family':a0_0x4b7593(0x1d5),'single_comfort':a0_0x4b7593(0xf3),'security':a0_0x4b7593(0x1df)};class CogniLiving extends utils[a0_0x4b7593(0x1d2)]{constructor(_0x35a144){const _0x40c787=a0_0x4b7593;super({..._0x35a144,'name':_0x40c787(0x112)}),this[_0x40c787(0xa7)]=[],this[_0x40c787(0xa9)]=[],this[_0x40c787(0xc4)]=[],this[_0x40c787(0x107)]=[],this[_0x40c787(0xcc)]=[],this[_0x40c787(0xd1)]={},this[_0x40c787(0x1ea)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x40c787(0xf4)]=!![],this[_0x40c787(0x151)]=null,this[_0x40c787(0x1a8)]=null,this[_0x40c787(0x1c3)]=![],this[_0x40c787(0xba)]=null,this[_0x40c787(0x169)]=null,this[_0x40c787(0x10c)]=SYSTEM_MODES[_0x40c787(0x156)],this['isProVersion']=![],this[_0x40c787(0x12b)]=![],this['systemUUID']='unknown',this['analysisTimer']=null,this[_0x40c787(0xfe)]=null,this[_0x40c787(0x114)]=null,this[_0x40c787(0x12d)]=null,this['on'](_0x40c787(0x1e7),this['onReady'][_0x40c787(0x18a)](this)),this['on'](_0x40c787(0xc8),this[_0x40c787(0x1eb)]['bind'](this)),this['on'](_0x40c787(0xb5),this[_0x40c787(0xb6)][_0x40c787(0x18a)](this)),this['on'](_0x40c787(0x14d),this['onMessage'][_0x40c787(0x18a)](this));}async[a0_0x4b7593(0x1a2)](){const _0x193bab=a0_0x4b7593;this[_0x193bab(0x192)][_0x193bab(0xce)](_0x193bab(0xa8)+this['version']+')\x20-\x20DEBUG\x20MODE\x20ENABLED'),await this[_0x193bab(0xf9)](),this['config']['licenseKey']=this['config'][_0x193bab(0x11a)]||'',this[_0x193bab(0x10b)]=await this['checkLicense'](this['config'][_0x193bab(0x11a)]);if(!this[_0x193bab(0x19a)][_0x193bab(0xdd)]||this[_0x193bab(0x19a)][_0x193bab(0xdd)]<0.1)this[_0x193bab(0x19a)][_0x193bab(0xdd)]=0xc;await this[_0x193bab(0x13a)]();try{const _0x3dc3d4=await this[_0x193bab(0x18f)](_0x193bab(0x1a7));_0x3dc3d4&&_0x3dc3d4[_0x193bab(0x15d)]&&(this[_0x193bab(0x1ea)]={'latitude':_0x3dc3d4[_0x193bab(0x15d)][_0x193bab(0x1e1)]||0x0,'longitude':_0x3dc3d4[_0x193bab(0x15d)][_0x193bab(0xc1)]||0x0,'city':_0x3dc3d4[_0x193bab(0x15d)][_0x193bab(0x139)]||''},this[_0x193bab(0x192)][_0x193bab(0xce)](_0x193bab(0xd3)+this[_0x193bab(0x1ea)][_0x193bab(0x139)]));}catch(_0x94f12b){this['log'][_0x193bab(0x131)](_0x193bab(0xb2));}if(this['config'][_0x193bab(0x106)])try{this[_0x193bab(0xba)]=new GoogleGenerativeAI(this[_0x193bab(0x19a)]['geminiApiKey']),this[_0x193bab(0x169)]=this[_0x193bab(0xba)][_0x193bab(0xd7)]({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x193bab(0x1ca)}}),this[_0x193bab(0x192)][_0x193bab(0xce)](_0x193bab(0x17a));}catch(_0x176866){this[_0x193bab(0x192)]['error'](_0x193bab(0xae)+_0x176866[_0x193bab(0x14d)]);}else this[_0x193bab(0x192)][_0x193bab(0x131)]('Gemini\x20API\x20Key\x20missing.\x20AI\x20features\x20disabled.');await this[_0x193bab(0x138)](),await this[_0x193bab(0xdc)](),await this[_0x193bab(0x163)](),await this[_0x193bab(0x9d)](),this['subscribeStates'](_0x193bab(0x10e)),this[_0x193bab(0x1c5)](LTM_DP_TRIGGER_DIGEST),this[_0x193bab(0x1c5)](_0x193bab(0x155));const _0x310c64=this[_0x193bab(0x19a)][_0x193bab(0xea)];if(_0x310c64&&_0x310c64[_0x193bab(0x164)]>0x0){this[_0x193bab(0x192)][_0x193bab(0xce)]('Subscribing\x20to\x20'+_0x310c64[_0x193bab(0x164)]+_0x193bab(0x15a));for(const _0x3d5ac7 of _0x310c64){if(_0x3d5ac7['id']){await this['subscribeForeignStatesAsync'](_0x3d5ac7['id']);try{const _0x152389=await this[_0x193bab(0x1d8)](_0x3d5ac7['id']);if(_0x152389)this[_0x193bab(0xd1)][_0x3d5ac7['id']]=_0x152389[_0x193bab(0x1e8)];}catch(_0x55d7c0){}}}}if(this[_0x193bab(0x152)])clearInterval(this[_0x193bab(0x152)]);const _0xf136c5=this[_0x193bab(0x19a)][_0x193bab(0x1db)]||0xf;_0xf136c5>0x0&&(this[_0x193bab(0x192)][_0x193bab(0xce)](_0x193bab(0x1b1)+_0xf136c5+_0x193bab(0x194)+this[_0x193bab(0x19a)][_0x193bab(0xdd)]+'h.'),this[_0x193bab(0x152)]=setInterval(()=>this['runAutopilot'](),_0xf136c5*0x3c*0x3e8)),this[_0x193bab(0x1a5)](),this[_0x193bab(0xc0)](),this['setupDriftAnalysisScheduler']();}async[a0_0x4b7593(0xf9)](){const _0x38c74b=a0_0x4b7593,_0x3a4c60=[_0x38c74b(0xd4),_0x38c74b(0x1aa),_0x38c74b(0x14c),_0x38c74b(0x94),_0x38c74b(0x1ab),'events.history_debug_00',_0x38c74b(0xa1),_0x38c74b(0xde),_0x38c74b(0x1dd),_0x38c74b(0x100)];for(const _0x150776 of _0x3a4c60){try{const _0x3c8c64=await this[_0x38c74b(0x115)](_0x150776);_0x3c8c64&&await this[_0x38c74b(0x124)](_0x150776);}catch(_0x4da91c){}}}async[a0_0x4b7593(0x13a)](){const _0x189b3f=a0_0x4b7593;try{const _0x1db89f=await this['getStateAsync'](_0x189b3f(0x145));_0x1db89f&&_0x1db89f[_0x189b3f(0x1e8)]&&(this[_0x189b3f(0xa7)]=JSON[_0x189b3f(0x16d)](_0x1db89f[_0x189b3f(0x1e8)][_0x189b3f(0x1e9)]()),this['log']['info']('Loaded\x20'+this['eventHistory'][_0x189b3f(0x164)]+'\x20events\x20from\x20history.'));}catch(_0x404c40){this[_0x189b3f(0xa7)]=[];}try{const _0x4071ea=await this[_0x189b3f(0x167)](_0x189b3f(0x1d6));if(_0x4071ea&&_0x4071ea[_0x189b3f(0x1e8)])this['analysisHistory']=JSON['parse'](_0x4071ea[_0x189b3f(0x1e8)]['toString']());}catch(_0x41dc9d){this[_0x189b3f(0xa9)]=[];}}[a0_0x4b7593(0x1eb)](_0x5bf352,_0x1cf569){const _0xf00cf5=a0_0x4b7593;if(!_0x1cf569)return;if(_0x5bf352===this[_0xf00cf5(0xef)]+'.'+SYSTEM_DP_MODE){_0x1cf569[_0xf00cf5(0x1e8)]&&Object['values'](SYSTEM_MODES)[_0xf00cf5(0x190)](_0x1cf569[_0xf00cf5(0x1e8)])&&(this['currentSystemMode']=_0x1cf569[_0xf00cf5(0x1e8)],_0x1cf569[_0xf00cf5(0x1e8)]===SYSTEM_MODES[_0xf00cf5(0xdb)]?this[_0xf00cf5(0x111)](![]):this[_0xf00cf5(0x111)](!![]));if(!_0x1cf569[_0xf00cf5(0x9b)])this['setState'](_0x5bf352,{'val':this[_0xf00cf5(0x10c)],'ack':!![]});return;}if(!_0x1cf569[_0xf00cf5(0x9b)]){_0x5bf352[_0xf00cf5(0x190)](_0xf00cf5(0x10e))&&_0x1cf569['val']&&(this[_0xf00cf5(0x192)]['info'](_0xf00cf5(0xca)),this[_0xf00cf5(0x195)](_0x5bf352,{'val':![],'ack':!![]}),this[_0xf00cf5(0x1bb)]());if(_0x5bf352[_0xf00cf5(0x190)](_0xf00cf5(0x146))&&_0x1cf569[_0xf00cf5(0x1e8)]){this[_0xf00cf5(0x195)](_0x5bf352,{'val':![],'ack':!![]});if(this['isProVersion'])this[_0xf00cf5(0x1b6)]();}return;}const _0x468576=(this[_0xf00cf5(0x19a)][_0xf00cf5(0xea)]||[])[_0xf00cf5(0x121)](_0x5f1edb=>_0x5f1edb['id']===_0x5bf352);if(_0x468576)this['processSensorEvent'](_0x5bf352,_0x1cf569,_0x468576);}async[a0_0x4b7593(0x116)](_0x39e7ac,_0x3cc36d,_0x415db8){const _0x4de382=a0_0x4b7593;if(!_0x415db8['logDuplicates']&&this[_0x4de382(0xd1)][_0x39e7ac]===_0x3cc36d[_0x4de382(0x1e8)])return;this[_0x4de382(0xd1)][_0x39e7ac]=_0x3cc36d[_0x4de382(0x1e8)];if(this[_0x4de382(0x1c3)]){this[_0x4de382(0x192)][_0x4de382(0xcf)](_0x4de382(0x133)+_0x415db8[_0x4de382(0x1bd)]);return;}const _0x3320f4=_0x415db8[_0x4de382(0x1bc)]===_0x4de382(0x117)&&(_0x415db8[_0x4de382(0x1bd)][_0x4de382(0xc9)]()[_0x4de382(0x190)](_0x4de382(0xb1))||_0x415db8['name'][_0x4de382(0xc9)]()[_0x4de382(0x190)](_0x4de382(0x1a6))||_0x415db8['location']['toLowerCase']()[_0x4de382(0x190)](_0x4de382(0xfb)));_0x3320f4&&!_0x3cc36d[_0x4de382(0x1e8)]?this[_0x4de382(0x168)]():(this[_0x4de382(0x151)]&&(this[_0x4de382(0x192)][_0x4de382(0xce)](_0x4de382(0x119)),this['abortExitTimer']()),!this[_0x4de382(0xf4)]&&this[_0x4de382(0x10c)]===SYSTEM_MODES[_0x4de382(0x156)]&&this[_0x4de382(0x111)](!![]));const _0x3aaf32={'timestamp':_0x3cc36d['ts'],'id':_0x39e7ac,'name':_0x415db8[_0x4de382(0x1bd)],'value':_0x3cc36d[_0x4de382(0x1e8)],'location':_0x415db8[_0x4de382(0xc5)],'type':_0x415db8['type']};this[_0x4de382(0xa7)][_0x4de382(0x127)](_0x3aaf32);if(this[_0x4de382(0xa7)]['length']>HISTORY_MAX_SIZE)this['eventHistory'][_0x4de382(0xac)]();await this[_0x4de382(0xbf)]('events.lastEvent',{'val':JSON[_0x4de382(0x10a)](_0x3aaf32),'ack':!![]}),await this[_0x4de382(0xbf)](_0x4de382(0x145),{'val':JSON['stringify'](this[_0x4de382(0xa7)]),'ack':!![]}),this['rawEventLog'][_0x4de382(0x173)]({'timestamp':new Date(_0x3cc36d['ts'])[_0x4de382(0xcb)](),'sensorName':_0x415db8[_0x4de382(0x1bd)],'location':_0x415db8[_0x4de382(0xc5)],'value':_0x3cc36d['val']}),await this[_0x4de382(0x10d)]();}['startExitTimer'](){const _0x54ab0a=a0_0x4b7593;this[_0x54ab0a(0x192)][_0x54ab0a(0xce)]('Haust√ºr\x20Event:\x20Starte\x20Exit-Logik\x20('+EXIT_TIMER_MINUTES+_0x54ab0a(0xda)+EXIT_GRACE_PERIOD_SECONDS+_0x54ab0a(0x113)),this['abortExitTimer'](),this['isGracePeriodActive']=!![],this[_0x54ab0a(0x1a8)]=setTimeout(()=>{const _0x5d3d71=_0x54ab0a;this['isGracePeriodActive']=![],this[_0x5d3d71(0x192)]['debug']('Exit\x20Grace\x20Period\x20beendet.\x20√úberwache\x20nun\x20Innenraum...');},EXIT_GRACE_PERIOD_SECONDS*0x3e8),this[_0x54ab0a(0x151)]=setTimeout(()=>{const _0x1345f9=_0x54ab0a;this[_0x1345f9(0x192)][_0x1345f9(0xce)](_0x1345f9(0xf7)),this[_0x1345f9(0x111)](![]),this['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}[a0_0x4b7593(0x1c6)](){const _0x3003bc=a0_0x4b7593;if(this[_0x3003bc(0x151)])clearTimeout(this[_0x3003bc(0x151)]);if(this[_0x3003bc(0x1a8)])clearTimeout(this[_0x3003bc(0x1a8)]);this[_0x3003bc(0x151)]=null,this[_0x3003bc(0x1a8)]=null,this[_0x3003bc(0x1c3)]=![];}async[a0_0x4b7593(0x111)](_0xfea845){const _0x1f30b2=a0_0x4b7593;if(this[_0x1f30b2(0xf4)]===_0xfea845)return;this[_0x1f30b2(0xf4)]=_0xfea845,await this[_0x1f30b2(0xbf)]('system.isPresent',{'val':_0xfea845,'ack':!![]}),this[_0x1f30b2(0x192)][_0x1f30b2(0xce)]('Pr√§senz-Status\x20ge√§ndert:\x20'+(_0xfea845?_0x1f30b2(0x191):_0x1f30b2(0x132)));}[a0_0x4b7593(0x19d)](){const _0xdd7e8e=a0_0x4b7593,_0x584a96=this['config'][_0xdd7e8e(0xdd)],_0x3f1486=this[_0xdd7e8e(0x19a)][_0xdd7e8e(0xa2)],_0x49422d=this[_0xdd7e8e(0xa7)][_0xdd7e8e(0x164)]>0x0?this[_0xdd7e8e(0xa7)][0x0]['timestamp']:Date['now'](),_0x14d16e=(Date['now']()-_0x49422d)/(0x3e8*0x3c*0x3c);let _0x30a48e='';_0x3f1486&&this[_0xdd7e8e(0x10c)]===SYSTEM_MODES[_0xdd7e8e(0x156)]&&this[_0xdd7e8e(0xf4)]&&(_0x14d16e>_0x584a96&&(this['log'][_0xdd7e8e(0x131)](_0xdd7e8e(0xbd)+_0x14d16e['toFixed'](0x1)+_0xdd7e8e(0x1cc)),_0x30a48e=_0xdd7e8e(0x11c)+_0x14d16e[_0xdd7e8e(0x1a4)](0x1)+_0xdd7e8e(0x95)));if(_0x30a48e){this[_0xdd7e8e(0x1bb)](_0x30a48e)[_0xdd7e8e(0x1ec)](_0x5d93c0=>this[_0xdd7e8e(0x192)][_0xdd7e8e(0x12f)](_0x5d93c0));return;}const _0x4034b5=Date[_0xdd7e8e(0x1a1)](),_0x351972=_0x4034b5-_0x49422d,_0x3b7251=(this['config'][_0xdd7e8e(0x1db)]||0xf)*0x3c*0x3e8;this[_0xdd7e8e(0xa7)]['length']>0x0&&_0x351972<=_0x3b7251?this[_0xdd7e8e(0x1bb)]()[_0xdd7e8e(0x1ec)](_0x39736c=>this[_0xdd7e8e(0x192)][_0xdd7e8e(0x12f)](_0x39736c)):!this[_0xdd7e8e(0x12b)]&&(this[_0xdd7e8e(0x195)](_0xdd7e8e(0x1b2),{'val':![],'ack':!![]}),this[_0xdd7e8e(0x195)](_0xdd7e8e(0xbc),{'val':![],'ack':!![]}));}async[a0_0x4b7593(0x1bb)](_0xf8e65e=''){const _0x1b9e60=a0_0x4b7593;this[_0x1b9e60(0x192)][_0x1b9e60(0xce)](_0x1b9e60(0xe3));if(!this[_0x1b9e60(0x169)]){this['log'][_0x1b9e60(0x12f)](_0x1b9e60(0x17d));return;}const _0x2e3425=this[_0x1b9e60(0xa7)][_0x1b9e60(0x164)]>0x0?this['eventHistory']:[{'note':'No\x20recorded\x20events\x20yet.'}],_0xe8b79e=PERSONA_MAPPING[this[_0x1b9e60(0x19a)][_0x1b9e60(0x147)]||_0x1b9e60(0xeb)],_0xb1e30e=this[_0x1b9e60(0x19a)][_0x1b9e60(0x174)]||'',_0x2d5e08=this[_0x1b9e60(0x10c)],_0x5aef87=new Date(),_0x55d09b=_0x5aef87[_0x1b9e60(0xb7)]('de-DE',{'weekday':_0x1b9e60(0x1a3),'hour':_0x1b9e60(0x125),'minute':_0x1b9e60(0x125)}),_0x4d4fc0=this[_0x1b9e60(0x1ea)];let _0x28b166='';if(this[_0x1b9e60(0xc4)][_0x1b9e60(0x164)]>0x0){const _0x448e48=this['feedbackHistory'][_0x1b9e60(0xbb)](0x0,0x3)[_0x1b9e60(0xa0)](_0x177e04=>_0x1b9e60(0x184)+_0x177e04[_0x1b9e60(0x175)]+_0x1b9e60(0x129)+_0x177e04['rating']+'.')[_0x1b9e60(0x1c9)]('\x0a');_0x28b166='\x0aFEEDBACK:\x0a'+_0x448e48+'\x0a';}const _0x46b3f9=_0xf8e65e?_0x1b9e60(0x101)+_0xf8e65e+'\x0a!!!\x20END\x20WARNING\x20!!!\x0a':'',_0x4fede4='Baseline:\x20Inactive\x20(Pro\x20Feature).',_0x38dd9a=_0x1b9e60(0x1c0)+_0x55d09b+'.\x20ORT:\x20'+_0x4d4fc0[_0x1b9e60(0x139)]+'.\x0a\x20\x20\x20\x20\x20\x20\x20\x20MODUS:\x20'+_0x2d5e08+'.\x20PR√ÑSENZ:\x20'+(this[_0x1b9e60(0xf4)]?'Ja':'Nein')+_0x1b9e60(0xc3)+_0xb1e30e+_0x1b9e60(0x97)+_0xe8b79e+_0x1b9e60(0xb0)+_0x4fede4+'\x20'+_0x28b166+'\x20'+_0x46b3f9+_0x1b9e60(0xe9)+JSON[_0x1b9e60(0x10a)](_0x2e3425)+_0x1b9e60(0x1ae);try{this[_0x1b9e60(0x192)][_0x1b9e60(0xcf)](_0x1b9e60(0xfc)+_0x38dd9a[_0x1b9e60(0x164)]+_0x1b9e60(0x141));const _0x229a36=await this[_0x1b9e60(0x169)]['generateContent'](_0x38dd9a),_0x61731c=_0x229a36['response']['text']()[_0x1b9e60(0x16b)](/```json|```/g,'')[_0x1b9e60(0x166)]();this[_0x1b9e60(0x192)][_0x1b9e60(0xce)](_0x1b9e60(0x104));const _0x1e7cc5=JSON[_0x1b9e60(0x16d)](_0x61731c);await this[_0x1b9e60(0xbf)](_0x1b9e60(0x134),{'val':_0x61731c,'ack':!![]}),await this[_0x1b9e60(0xbf)](_0x1b9e60(0x165),{'val':_0x1e7cc5['activity']['alertReason']||'','ack':!![]}),await this[_0x1b9e60(0xbf)](_0x1b9e60(0x199),{'val':_0x1e7cc5[_0x1b9e60(0x170)][_0x1b9e60(0x103)]||'N/A','ack':!![]});const _0x2cfff4=_0x1e7cc5['activity'][_0x1b9e60(0x1e0)]||![],_0x38eb7b=_0x1e7cc5['activity'][_0x1b9e60(0x1d1)]||![];if(_0x2cfff4||_0x38eb7b){await this['setStateAsync'](_0x1b9e60(0x1b2),{'val':!![],'ack':!![]}),await this['setStateAsync'](_0x1b9e60(0xbc),{'val':_0x38eb7b,'ack':!![]});if(!this[_0x1b9e60(0x12b)]||_0x38eb7b){const _0x310707=_0x38eb7b?_0x1b9e60(0x193):_0x1b9e60(0x185);this['sendNotification'](_0x310707+':\x20'+_0x1e7cc5['activity']['alertReason'],![],_0x38eb7b);}}else await this['setStateAsync'](_0x1b9e60(0x1b2),{'val':![],'ack':!![]}),await this[_0x1b9e60(0xbf)]('analysis.isEmergency',{'val':![],'ack':!![]});this[_0x1b9e60(0x12b)]=_0x2cfff4||_0x38eb7b;const _0x42fe96={'timestamp':Date[_0x1b9e60(0x1a1)](),'id':Date['now']()[_0x1b9e60(0x1e9)](),'analysis':_0x1e7cc5,'systemMode':_0x2d5e08,'isPro':this[_0x1b9e60(0x10b)]};this[_0x1b9e60(0x159)](_0x42fe96);}catch(_0x32db8b){this[_0x1b9e60(0x192)][_0x1b9e60(0x12f)](_0x1b9e60(0x123)+_0x32db8b[_0x1b9e60(0x14d)]);}}async[a0_0x4b7593(0x1b6)](){const _0x3dd8d2=a0_0x4b7593;if(!this[_0x3dd8d2(0x10b)])return;await this[_0x3dd8d2(0xbf)](LTM_DP_STATUS,{'val':_0x3dd8d2(0xa3)+new Date()[_0x3dd8d2(0xb7)](),'ack':!![]});if(!this[_0x3dd8d2(0x169)]||this[_0x3dd8d2(0x107)]['length']<LTM_MIN_EVENTS_FOR_COMPRESSION){await this[_0x3dd8d2(0xbf)](LTM_DP_STATUS,{'val':_0x3dd8d2(0x1b3),'ack':!![]});return;}const _0x91c9e5=JSON[_0x3dd8d2(0x16d)](JSON['stringify'](this[_0x3dd8d2(0x107)])),_0x329b71=(this[_0x3dd8d2(0x19a)][_0x3dd8d2(0x174)]||'')[_0x3dd8d2(0x143)](0x0,0x3e8),_0x4aba7a=_0x3dd8d2(0xe6)+_0x329b71+_0x3dd8d2(0x17f)+JSON[_0x3dd8d2(0x10a)](_0x91c9e5);try{const _0x43e51f=await this['geminiModel'][_0x3dd8d2(0xc2)](_0x4aba7a),_0x5843ae=JSON[_0x3dd8d2(0x16d)](_0x43e51f['response'][_0x3dd8d2(0xdf)]()[_0x3dd8d2(0x16b)](/```json|```/g,'')[_0x3dd8d2(0x166)]());_0x5843ae[_0x3dd8d2(0x103)]&&(this['dailyDigests']['push']({'timestamp':new Date()['toISOString'](),'eventCount':_0x91c9e5[_0x3dd8d2(0x164)],'summary':_0x5843ae[_0x3dd8d2(0x103)],'activityLevel':_0x5843ae[_0x3dd8d2(0xe4)],'systemMode':this[_0x3dd8d2(0x10c)]}),await this[_0x3dd8d2(0x1be)](),this['rawEventLog']=[],await this['saveRawEventLog'](),await this['setStateAsync'](LTM_DP_STATUS,{'val':_0x3dd8d2(0x1ad)+_0x91c9e5[_0x3dd8d2(0x164)]+_0x3dd8d2(0x157),'ack':!![]}));}catch(_0x9b13bc){await this[_0x3dd8d2(0xbf)](LTM_DP_STATUS,{'val':_0x3dd8d2(0xf6)+_0x9b13bc[_0x3dd8d2(0x14d)],'ack':!![]});}}async[a0_0x4b7593(0x138)](){const _0x299a3c=a0_0x4b7593;await this['checkSystemObjects'](),await this[_0x299a3c(0xfd)](_0x299a3c(0x1a0),{'type':_0x299a3c(0x13c),'common':{'name':'Presence\x20Status','type':_0x299a3c(0xa5),'role':_0x299a3c(0x1d7),'read':!![],'write':![],'def':!![]},'native':{}}),await this[_0x299a3c(0xfd)](_0x299a3c(0x1b4),{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0x180),'type':'string','role':_0x299a3c(0x1c2),'read':!![],'write':![]},'native':{}}),await this[_0x299a3c(0xfd)](_0x299a3c(0x145),{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0x126),'type':'string','role':_0x299a3c(0x1c2),'read':!![],'write':![]},'native':{}}),await this[_0x299a3c(0xfd)](_0x299a3c(0x10e),{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0xad),'type':_0x299a3c(0xa5),'role':'button','read':!![],'write':!![],'def':![]},'native':{}}),await this['setObjectNotExistsAsync']('analysis.lastResult',{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0x93),'type':_0x299a3c(0x1af),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x299a3c(0xfd)]('analysis.isAlert',{'type':'state','common':{'name':_0x299a3c(0x179),'type':_0x299a3c(0xa5),'role':_0x299a3c(0x177),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x299a3c(0xfd)](_0x299a3c(0xbc),{'type':_0x299a3c(0x13c),'common':{'name':'AI\x20Emergency\x20Status','type':_0x299a3c(0xa5),'role':_0x299a3c(0x148),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x299a3c(0xfd)](_0x299a3c(0x165),{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0x96),'type':_0x299a3c(0x1af),'role':_0x299a3c(0x1b5),'read':!![],'write':![]},'native':{}}),await this[_0x299a3c(0xfd)](_0x299a3c(0x199),{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0x110),'type':'string','role':_0x299a3c(0xdf),'read':!![],'write':![]},'native':{}}),await this[_0x299a3c(0xfd)](_0x299a3c(0x188),{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0xee),'type':_0x299a3c(0x1af),'role':_0x299a3c(0x13c),'read':!![],'write':![],'def':'N/A'},'native':{}}),await this[_0x299a3c(0xfd)]('analysis.comfortSummary',{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0x150),'type':_0x299a3c(0x1af),'role':_0x299a3c(0xdf),'read':!![],'write':![]},'native':{}}),await this['setObjectNotExistsAsync'](_0x299a3c(0xaf),{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0x162),'type':_0x299a3c(0x1af),'role':_0x299a3c(0xdf),'read':!![],'write':![]},'native':{}}),await this['extendObjectAsync'](_0x299a3c(0xd0),{'type':_0x299a3c(0x11d),'common':{'name':_0x299a3c(0x14a)},'native':{}}),await this[_0x299a3c(0xfd)]('analysis.automation.patternDetected',{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0x15e),'type':'boolean','role':_0x299a3c(0x1d7),'read':!![],'write':![],'def':![]},'native':{}}),await this[_0x299a3c(0xfd)](_0x299a3c(0xbe),{'type':_0x299a3c(0x13c),'common':{'name':'Description','type':_0x299a3c(0x1af),'role':_0x299a3c(0xdf),'read':!![],'write':![]},'native':{}}),await this[_0x299a3c(0xfd)]('analysis.automation.suggestedAction',{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0x19e),'type':_0x299a3c(0x1af),'role':_0x299a3c(0xdf),'read':!![],'write':![]},'native':{}}),await this[_0x299a3c(0xfd)](_0x299a3c(0x1d6),{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0x1c7),'type':_0x299a3c(0x1af),'role':_0x299a3c(0x1c2),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x299a3c(0xfd)](_0x299a3c(0x176),{'type':_0x299a3c(0x13c),'common':{'name':_0x299a3c(0x120),'type':_0x299a3c(0x1af),'role':_0x299a3c(0x1c2),'read':!![],'write':![],'def':'[]'},'native':{}}),await this[_0x299a3c(0x1b7)](),await this[_0x299a3c(0xfa)]();}async['checkSystemObjects'](){const _0x181fb4=a0_0x4b7593;await this[_0x181fb4(0x9e)](_0x181fb4(0x1b8),{'type':_0x181fb4(0x11d),'common':{'name':_0x181fb4(0x17c)},'native':{}}),await this[_0x181fb4(0x9e)](SYSTEM_DP_MODE,{'type':'state','common':{'name':'System\x20Mode','type':'string','role':'state','read':!![],'write':!![],'def':SYSTEM_MODES['NORMAL'],'states':{[SYSTEM_MODES[_0x181fb4(0x156)]]:_0x181fb4(0x158),[SYSTEM_MODES[_0x181fb4(0xdb)]]:_0x181fb4(0x149),[SYSTEM_MODES[_0x181fb4(0x1d4)]]:_0x181fb4(0xaa),[SYSTEM_MODES[_0x181fb4(0x17b)]]:_0x181fb4(0x1e6)}},'native':{}});}async[a0_0x4b7593(0x1cb)](_0x799bba,_0xc723cc=![],_0xe7ccda=![]){const _0x317443=a0_0x4b7593;this['log'][_0x317443(0xce)]((_0xc723cc?_0x317443(0x1d3):'')+_0x317443(0x1d0)+_0x799bba+'\x22'+(_0xe7ccda?_0x317443(0x1c1):''));const _0x549998=this[_0x317443(0x19a)];let _0x4269d6=0x0;_0x549998[_0x317443(0x140)]&&_0x549998[_0x317443(0x1c8)]&&(await this['sendToAsync'](_0x549998[_0x317443(0x1c8)],'send',{'text':_0x799bba,'user':_0x549998[_0x317443(0x99)]}),_0x4269d6++);if(_0x549998[_0x317443(0xf5)]&&_0x549998[_0x317443(0x172)]){let _0x185fbb={'message':_0x799bba,'title':_0xe7ccda?_0x317443(0x98):_0x317443(0x161),'priority':_0xe7ccda?0x2:0x1,'device':_0x549998[_0x317443(0x1de)]};_0xe7ccda&&(_0x185fbb[_0x317443(0x12e)]=0x1e,_0x185fbb[_0x317443(0x1da)]=0xe10,_0x185fbb[_0x317443(0x19f)]=_0x317443(0x142)),await this[_0x317443(0x1ed)](_0x549998[_0x317443(0x172)],_0x317443(0xf8),_0x185fbb),_0x4269d6++;}return _0x549998['notifyEmailEnabled']&&_0x549998[_0x317443(0x182)]&&(await this[_0x317443(0x1ed)](_0x549998[_0x317443(0x182)],_0x317443(0xf8),{'text':_0x799bba,'to':_0x549998['notifyEmailRecipient']}),_0x4269d6++),_0x549998[_0x317443(0x181)]&&_0x549998[_0x317443(0x11b)]&&(await this['sendToAsync'](_0x549998[_0x317443(0x11b)],_0x317443(0xf8),{'text':_0x799bba,'phone':_0x549998[_0x317443(0x1e2)]}),_0x4269d6++),_0x549998[_0x317443(0xd2)]&&_0x549998['notifySignalInstance']&&(await this[_0x317443(0x1ed)](_0x549998[_0x317443(0xb9)],_0x317443(0xf8),{'text':_0x799bba,'phone':_0x549998[_0x317443(0x18b)]}),_0x4269d6++),_0x4269d6;}async[a0_0x4b7593(0x163)](){const _0x590053=a0_0x4b7593;try{const _0x345048=await this[_0x590053(0x167)](LTM_DP_RAW_LOG);if(_0x345048&&_0x345048['val'])this['rawEventLog']=JSON[_0x590053(0x16d)](_0x345048[_0x590053(0x1e8)]);}catch(_0x27e6ee){this[_0x590053(0x107)]=[];}}async[a0_0x4b7593(0x10d)](){const _0x7511bd=a0_0x4b7593;this[_0x7511bd(0x107)][_0x7511bd(0x164)]>RAW_LOG_MAX_SIZE&&this[_0x7511bd(0x107)][_0x7511bd(0x9a)](0x0,this['rawEventLog'][_0x7511bd(0x164)]-RAW_LOG_MAX_SIZE),await this[_0x7511bd(0xbf)](LTM_DP_RAW_LOG,{'val':JSON[_0x7511bd(0x10a)](this[_0x7511bd(0x107)]),'ack':!![]});}async[a0_0x4b7593(0x9d)](){const _0x27df4d=a0_0x4b7593;try{const _0x13b6a8=await this['getStateAsync'](LTM_DP_DAILY_DIGESTS);if(_0x13b6a8&&_0x13b6a8[_0x27df4d(0x1e8)])this['dailyDigests']=JSON[_0x27df4d(0x16d)](_0x13b6a8[_0x27df4d(0x1e8)]);}catch(_0x4d7311){this[_0x27df4d(0xcc)]=[];}await this[_0x27df4d(0xf2)]();}async[a0_0x4b7593(0x1be)](_0x17d5d5=!![]){const _0x1a7bb2=a0_0x4b7593,_0x42a470=this[_0x1a7bb2(0x19a)][_0x1a7bb2(0x187)]||0x3c;this[_0x1a7bb2(0xcc)][_0x1a7bb2(0x164)]>_0x42a470&&this['dailyDigests'][_0x1a7bb2(0x9a)](0x0,this['dailyDigests'][_0x1a7bb2(0x164)]-_0x42a470);await this[_0x1a7bb2(0xbf)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x1a7bb2(0x10a)](this[_0x1a7bb2(0xcc)]),'ack':!![]});if(_0x17d5d5)await this[_0x1a7bb2(0xf2)]();}[a0_0x4b7593(0x1a5)](){const _0x8977b7=a0_0x4b7593;if(this[_0x8977b7(0xfe)])this['ltmJob'][_0x8977b7(0x128)]();if(!this[_0x8977b7(0x10b)]){this[_0x8977b7(0xbf)](LTM_DP_STATUS,{'val':_0x8977b7(0x130),'ack':!![]});return;}this[_0x8977b7(0xfe)]=schedule[_0x8977b7(0x1e5)](LTM_SCHEDULE,()=>this[_0x8977b7(0x1b6)]());}[a0_0x4b7593(0x1cd)](){const _0x12d312=a0_0x4b7593;if(this[_0x12d312(0x12d)])clearInterval(this[_0x12d312(0x12d)]);if(!this[_0x12d312(0x10b)])return;this[_0x12d312(0x12d)]=setInterval(()=>this[_0x12d312(0xa6)](),(this[_0x12d312(0x19a)][_0x12d312(0xb4)]||0x18)*0x36ee80),setTimeout(()=>this[_0x12d312(0xa6)](),0x1388);}async[a0_0x4b7593(0xe5)](){const _0xa09fa8=a0_0x4b7593;await this[_0xa09fa8(0xbf)]('analysis.activitySummary',{'val':'No\x20recent\x20activity.','ack':!![]}),await this[_0xa09fa8(0xbf)](_0xa09fa8(0x188),{'val':this[_0xa09fa8(0x10b)]?'N/A\x20(No\x20Activity)':'N/A\x20(Pro\x20Feature)','ack':!![]}),await this[_0xa09fa8(0xbf)](_0xa09fa8(0x1b2),{'val':![],'ack':!![]}),await this[_0xa09fa8(0xbf)]('analysis.isEmergency',{'val':![],'ack':!![]}),this[_0xa09fa8(0x12b)]=![];}async[a0_0x4b7593(0x159)](_0x4765cd){const _0x29b659=a0_0x4b7593;this[_0x29b659(0xa9)][_0x29b659(0x127)](_0x4765cd);if(this[_0x29b659(0xa9)][_0x29b659(0x164)]>ANALYSIS_HISTORY_MAX_SIZE)this[_0x29b659(0xa9)][_0x29b659(0xac)]();await this['setStateAsync'](_0x29b659(0x1d6),{'val':JSON[_0x29b659(0x10a)](this[_0x29b659(0xa9)]),'ack':!![]});}[a0_0x4b7593(0xc0)](){const _0x2d41bf=a0_0x4b7593;if(this[_0x2d41bf(0x114)])this[_0x2d41bf(0x114)]['cancel']();this[_0x2d41bf(0x114)]=schedule[_0x2d41bf(0x1e5)](MODE_RESET_SCHEDULE,async()=>{const _0x26d505=_0x2d41bf;await this[_0x26d505(0xdc)](),AUTO_RESET_MODES[_0x26d505(0x190)](this[_0x26d505(0x10c)])&&await this[_0x26d505(0xbf)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES[_0x26d505(0x156)],'ack':![]});});}async[a0_0x4b7593(0xf2)](){const _0x417426=a0_0x4b7593;if(!this[_0x417426(0x10b)]){await this['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x417426(0x130),'ack':!![]});return;}const _0x56794d=this[_0x417426(0xcc)]['length']>=(this[_0x417426(0x19a)]['minDaysForBaseline']||0x7)?'Aktiv\x20('+this['dailyDigests']['length']+_0x417426(0x12c):_0x417426(0xe8)+this[_0x417426(0xcc)][_0x417426(0x164)]+'/'+(this[_0x417426(0x19a)]['minDaysForBaseline']||0x7)+')';await this[_0x417426(0xbf)](LTM_DP_BASELINE_STATUS,{'val':_0x56794d,'ack':!![]});}async[a0_0x4b7593(0x1b7)](){const _0x16df7a=a0_0x4b7593;await this['extendObjectAsync'](_0x16df7a(0x13d),{'type':_0x16df7a(0x11d),'common':{'name':'LTM'},'native':{}}),await this[_0x16df7a(0x9e)](LTM_DP_RAW_LOG,{'type':_0x16df7a(0x13c),'common':{'name':_0x16df7a(0x198),'type':_0x16df7a(0x1af),'role':'json','read':!![],'write':![]},'native':{}}),await this[_0x16df7a(0x9e)](LTM_DP_DAILY_DIGESTS,{'type':_0x16df7a(0x13c),'common':{'name':_0x16df7a(0x17e),'type':_0x16df7a(0x1af),'role':_0x16df7a(0x1c2),'read':!![],'write':![]},'native':{}}),await this[_0x16df7a(0x9e)](LTM_DP_STATUS,{'type':_0x16df7a(0x13c),'common':{'name':_0x16df7a(0x171),'type':_0x16df7a(0x1af),'role':'text','read':!![],'write':![]},'native':{}}),await this[_0x16df7a(0x9e)](LTM_DP_TRIGGER_DIGEST,{'type':_0x16df7a(0x13c),'common':{'name':_0x16df7a(0x13b),'type':_0x16df7a(0xa5),'role':_0x16df7a(0x137),'read':!![],'write':!![],'def':![]},'native':{}}),await this[_0x16df7a(0x9e)](LTM_DP_BASELINE_STATUS,{'type':_0x16df7a(0x13c),'common':{'name':'Baseline\x20Status','type':_0x16df7a(0x1af),'role':_0x16df7a(0xdf),'read':!![],'write':![]},'native':{}});}async['checkLtmDriftObjects'](){const _0x4d8390=a0_0x4b7593;await this[_0x4d8390(0x9e)](LTM_DP_DRIFT_CHANNEL,{'type':'channel','common':{'name':_0x4d8390(0x1e4)},'native':{}}),await this[_0x4d8390(0x9e)](LTM_DP_DRIFT_STATUS,{'type':'state','common':{'name':_0x4d8390(0x183),'type':_0x4d8390(0x1af),'role':_0x4d8390(0x13c),'read':!![],'write':![],'def':_0x4d8390(0xf1)},'native':{}}),await this[_0x4d8390(0x9e)](LTM_DP_DRIFT_DETAILS,{'type':_0x4d8390(0x13c),'common':{'name':'Drift\x20Details','type':_0x4d8390(0x1af),'role':_0x4d8390(0xdf),'read':!![],'write':![]},'native':{}}),await this[_0x4d8390(0x9e)](LTM_DP_DRIFT_LAST_CHECK,{'type':'state','common':{'name':'Last\x20Check','type':_0x4d8390(0x109),'role':_0x4d8390(0x122),'read':!![],'write':![]},'native':{}});}async[a0_0x4b7593(0xa6)](){const _0x445fcb=a0_0x4b7593;if(!this['isProVersion']||!this[_0x445fcb(0x169)])return;const _0x140f38=this['config'][_0x445fcb(0x18e)]||0xe;if(this[_0x445fcb(0xcc)]['length']<_0x140f38+(this[_0x445fcb(0x19a)][_0x445fcb(0x154)]||0x7)){await this[_0x445fcb(0xbf)](LTM_DP_DRIFT_STATUS,{'val':_0x445fcb(0x10f),'ack':!![]});return;}const _0x1b2986=this[_0x445fcb(0xcc)]['slice'](-_0x140f38),_0x53d517=this[_0x445fcb(0xcc)][_0x445fcb(0xbb)](0x0,this[_0x445fcb(0xcc)][_0x445fcb(0x164)]-_0x140f38),_0x5eef7c=_0x445fcb(0xcd)+JSON[_0x445fcb(0x10a)](_0x53d517)+_0x445fcb(0xe7)+JSON[_0x445fcb(0x10a)](_0x1b2986);try{const _0x160182=await this[_0x445fcb(0x169)][_0x445fcb(0xc2)](_0x5eef7c),_0x519629=JSON[_0x445fcb(0x16d)](_0x160182['response']['text']()['replace'](/```json|```/g,'')[_0x445fcb(0x166)]());_0x519629[_0x445fcb(0x108)]&&(await this['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x519629[_0x445fcb(0x108)],'ack':!![]}),await this['setStateAsync'](LTM_DP_DRIFT_DETAILS,{'val':_0x519629[_0x445fcb(0xf0)],'ack':!![]}),await this[_0x445fcb(0xbf)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x445fcb(0x1a1)](),'ack':!![]}));}catch(_0x532146){}}async['loadSystemMode'](){const _0x4959cc=a0_0x4b7593;try{const _0x1b9f34=await this[_0x4959cc(0x167)](SYSTEM_DP_MODE);_0x1b9f34&&_0x1b9f34[_0x4959cc(0x1e8)]&&Object[_0x4959cc(0x1e3)](SYSTEM_MODES)[_0x4959cc(0x190)](_0x1b9f34[_0x4959cc(0x1e8)])?this['currentSystemMode']=_0x1b9f34[_0x4959cc(0x1e8)]:(this[_0x4959cc(0x10c)]=SYSTEM_MODES[_0x4959cc(0x156)],await this[_0x4959cc(0xbf)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x483bde){this[_0x4959cc(0x10c)]=SYSTEM_MODES['NORMAL'];}}async[a0_0x4b7593(0x16a)](){const _0x2f54b6=a0_0x4b7593;try{const _0x309527=await this[_0x2f54b6(0x18f)](_0x2f54b6(0x18c));if(_0x309527&&_0x309527[_0x2f54b6(0x13f)]&&_0x309527[_0x2f54b6(0x13f)]['uuid'])return _0x309527[_0x2f54b6(0x13f)][_0x2f54b6(0xed)];return _0x2f54b6(0x18d);}catch(_0x35fd61){return _0x2f54b6(0x178);}}async['checkLicense'](_0x1a9925){const _0x4ee5a6=a0_0x4b7593;if(!_0x1a9925)return![];this['systemUUID']=await this['getSystemUUID']();if(_0x1a9925===_0x4ee5a6(0xab)||_0x1a9925['startsWith'](_0x4ee5a6(0x11f)))return!![];return![];}[a0_0x4b7593(0xb6)](_0x3bba4c){const _0x3d7daf=a0_0x4b7593;if(this['analysisTimer'])clearInterval(this['analysisTimer']);if(this[_0x3d7daf(0x12d)])clearInterval(this[_0x3d7daf(0x12d)]);if(this[_0x3d7daf(0xfe)])this[_0x3d7daf(0xfe)][_0x3d7daf(0x128)]();if(this[_0x3d7daf(0x114)])this[_0x3d7daf(0x114)][_0x3d7daf(0x128)]();if(this[_0x3d7daf(0x151)])clearTimeout(this['exitTimer']);if(this[_0x3d7daf(0x1a8)])clearTimeout(this[_0x3d7daf(0x1a8)]);_0x3bba4c();}async[a0_0x4b7593(0x9f)](_0x5dbd4c){const _0x10856d=a0_0x4b7593;if(typeof _0x5dbd4c===_0x10856d(0xb3)&&_0x5dbd4c[_0x10856d(0x14d)]){if(_0x5dbd4c[_0x10856d(0x105)]===_0x10856d(0xe1)){if(!_0x5dbd4c[_0x10856d(0x14d)]['apiKey'])return this[_0x10856d(0x16c)](_0x5dbd4c['from'],_0x5dbd4c[_0x10856d(0x105)],{'success':![],'message':'No\x20Key'},_0x5dbd4c[_0x10856d(0x197)]);try{const _0xaa8ea9=new GoogleGenerativeAI(_0x5dbd4c['message'][_0x10856d(0x1d9)])[_0x10856d(0xd7)]({'model':_0x10856d(0xd6)});await _0xaa8ea9[_0x10856d(0xc2)](_0x10856d(0xc6)),this['sendTo'](_0x5dbd4c[_0x10856d(0x1ce)],_0x5dbd4c[_0x10856d(0x105)],{'success':!![],'message':_0x10856d(0xd5)},_0x5dbd4c['callback']);}catch(_0x3211e0){this[_0x10856d(0x16c)](_0x5dbd4c[_0x10856d(0x1ce)],_0x5dbd4c[_0x10856d(0x105)],{'success':![],'message':_0x3211e0['message']},_0x5dbd4c[_0x10856d(0x197)]);}}else{if(_0x5dbd4c['command']===_0x10856d(0x1ac)){const _0x486bfa=await this['sendNotification'](_0x10856d(0x14b),!![]);this['sendTo'](_0x5dbd4c[_0x10856d(0x1ce)],_0x5dbd4c['command'],{'success':_0x486bfa>0x0,'message':_0x486bfa+_0x10856d(0x14e)},_0x5dbd4c['callback']);}else{if(_0x5dbd4c[_0x10856d(0x105)]===_0x10856d(0x11e)){if(!this['isProVersion'])return this[_0x10856d(0x16c)](_0x5dbd4c[_0x10856d(0x1ce)],_0x5dbd4c[_0x10856d(0x105)],{'success':![],'isPro':![]},_0x5dbd4c[_0x10856d(0x197)]);let _0x2b7bfd={'status':_0x10856d(0xf1),'details':'','lastCheck':0x0};try{_0x2b7bfd[_0x10856d(0x15f)]=(await this[_0x10856d(0x167)](LTM_DP_DRIFT_STATUS))['val'],_0x2b7bfd[_0x10856d(0x16e)]=(await this[_0x10856d(0x167)](LTM_DP_DRIFT_DETAILS))[_0x10856d(0x1e8)],_0x2b7bfd[_0x10856d(0x102)]=(await this[_0x10856d(0x167)](LTM_DP_DRIFT_LAST_CHECK))[_0x10856d(0x1e8)];}catch(_0x1a6ea8){}this[_0x10856d(0x16c)](_0x5dbd4c['from'],_0x5dbd4c[_0x10856d(0x105)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x10856d(0xcc)],'driftAnalysis':_0x2b7bfd,'analysisHistory':this[_0x10856d(0xa9)]},_0x5dbd4c[_0x10856d(0x197)]);}else{if(_0x5dbd4c['command']===_0x10856d(0xc7)){const _0x416e7f=await this[_0x10856d(0x1c4)](_0x10856d(0x1bf),_0x10856d(0x1b9)),_0x4b5496=[];if(_0x416e7f)for(const _0x3a061b in _0x416e7f){const _0x1a1409=_0x416e7f[_0x3a061b],_0x93b9b5=(_0x1a1409[_0x10856d(0x15d)]&&typeof _0x1a1409[_0x10856d(0x15d)]['name']===_0x10856d(0xb3)?_0x1a1409[_0x10856d(0x15d)][_0x10856d(0x1bd)]['de']:_0x1a1409[_0x10856d(0x15d)][_0x10856d(0x1bd)])||_0x1a1409[_0x10856d(0x15d)][_0x10856d(0x1bd)];_0x4b5496[_0x10856d(0x173)]({'id':_0x3a061b,'name':_0x93b9b5});}this[_0x10856d(0x16c)](_0x5dbd4c[_0x10856d(0x1ce)],_0x5dbd4c[_0x10856d(0x105)],{'success':!![],'enums':_0x4b5496},_0x5dbd4c[_0x10856d(0x197)]);}else{if(_0x5dbd4c['command']==='scanDevices'){this[_0x10856d(0x192)][_0x10856d(0xce)]('Received\x20scanDevices\x20request\x20from\x20Admin\x20UI.');const _0x20a326=_0x5dbd4c[_0x10856d(0x14d)]||{};try{const _0x3f0448=await this[_0x10856d(0x160)](_0x20a326);this[_0x10856d(0x16c)](_0x5dbd4c[_0x10856d(0x1ce)],_0x5dbd4c[_0x10856d(0x105)],{'success':!![],'devices':_0x3f0448},_0x5dbd4c[_0x10856d(0x197)]);}catch(_0x3b02d0){this['sendTo'](_0x5dbd4c['from'],_0x5dbd4c[_0x10856d(0x105)],{'success':![],'error':_0x3b02d0[_0x10856d(0x14d)]},_0x5dbd4c[_0x10856d(0x197)]);}}else{if(_0x5dbd4c['command']===_0x10856d(0x91)){const {historyId:_0x1a29b4,rating:_0x4065f1,comment:_0xf1a26a,alertReason:_0x463f39}=_0x5dbd4c['message'];_0x1a29b4&&_0x4065f1?(await this[_0x10856d(0x189)]({'timestamp':Date[_0x10856d(0x1a1)](),'historyId':_0x1a29b4,'rating':_0x4065f1,'comment':_0xf1a26a,'alertReason':_0x463f39}),this['sendTo'](_0x5dbd4c[_0x10856d(0x1ce)],_0x5dbd4c['command'],{'success':!![]},_0x5dbd4c[_0x10856d(0x197)])):this[_0x10856d(0x16c)](_0x5dbd4c[_0x10856d(0x1ce)],_0x5dbd4c[_0x10856d(0x105)],{'success':![],'error':_0x10856d(0xa4)},_0x5dbd4c[_0x10856d(0x197)]);}}}}}}}}}if(require[a0_0x4b7593(0x1ba)]!==module)module[a0_0x4b7593(0x1ee)]=_0x7d5eb=>new CogniLiving(_0x7d5eb);else new CogniLiving();