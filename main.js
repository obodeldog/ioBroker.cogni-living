const a0_0x3382d1=a0_0x4499;(function(_0xd43696,_0x110aac){const _0x3b13e2=a0_0x4499,_0x3fcef5=_0xd43696();while(!![]){try{const _0x230ee5=parseInt(_0x3b13e2(0x305))/0x1*(parseInt(_0x3b13e2(0x28f))/0x2)+-parseInt(_0x3b13e2(0x214))/0x3+parseInt(_0x3b13e2(0x284))/0x4+-parseInt(_0x3b13e2(0x342))/0x5*(-parseInt(_0x3b13e2(0x2b3))/0x6)+-parseInt(_0x3b13e2(0x33c))/0x7+parseInt(_0x3b13e2(0x2c2))/0x8+-parseInt(_0x3b13e2(0x302))/0x9;if(_0x230ee5===_0x110aac)break;else _0x3fcef5['push'](_0x3fcef5['shift']());}catch(_0x160c07){_0x3fcef5['push'](_0x3fcef5['shift']());}}}(a0_0x5aea,0x7aef8));const a0_0x224323=(function(){let _0xf2f077=!![];return function(_0x59384d,_0x378724){const _0x835d90=_0xf2f077?function(){const _0x35989f=a0_0x4499;if(_0x378724){const _0x523b88=_0x378724[_0x35989f(0x297)](_0x59384d,arguments);return _0x378724=null,_0x523b88;}}:function(){};return _0xf2f077=![],_0x835d90;};}()),a0_0x57df65=a0_0x224323(this,function(){const _0x39daa1=a0_0x4499;return a0_0x57df65[_0x39daa1(0x210)]()[_0x39daa1(0x33e)](_0x39daa1(0x318))['toString']()[_0x39daa1(0x1fe)](a0_0x57df65)['search'](_0x39daa1(0x318));});a0_0x57df65();'use strict';const utils=require(a0_0x3382d1(0x2a6)),{GoogleGenerativeAI}=require('@google/generative-ai'),schedule=require(a0_0x3382d1(0x32d)),{spawn,exec}=require(a0_0x3382d1(0x2e1)),path=require(a0_0x3382d1(0x301)),fs=require('fs'),HISTORY_MAX_SIZE=0x32,RAW_LOG_MAX_SIZE=0x5dc,LTM_MIN_EVENTS_FOR_COMPRESSION=0x5,GEMINI_MODEL='models/gemini-flash-latest',LTM_SCHEDULE=a0_0x3382d1(0x331),MODE_RESET_SCHEDULE=a0_0x3382d1(0x2b7),SEQUENCE_TIMEOUT_MS=0x5*0x3c*0x3e8,MAX_TRAINING_SET_SIZE=0x1f4,THERMO_LOG_SIZE=0x3e8,EXIT_TIMER_MINUTES=0xf,EXIT_GRACE_PERIOD_SECONDS=0x1e,LTM_DP_RAW_LOG=a0_0x3382d1(0x1ea),LTM_DP_DAILY_DIGESTS=a0_0x3382d1(0x2fe),LTM_DP_STATUS='LTM.processingStatus',LTM_DP_TRIGGER_DIGEST=a0_0x3382d1(0x281),LTM_DP_BASELINE_STATUS=a0_0x3382d1(0x27e),LTM_DP_DRIFT_CHANNEL=a0_0x3382d1(0x2da),LTM_DP_DRIFT_STATUS='LTM.driftAnalysis.baselineDrift',LTM_DP_DRIFT_DETAILS=a0_0x3382d1(0x250),LTM_DP_DRIFT_LAST_CHECK=a0_0x3382d1(0x20b),SYSTEM_DP_MODE='system.mode',SYSTEM_MODES={'NORMAL':a0_0x3382d1(0x2e6),'VACATION':a0_0x3382d1(0x26b),'PARTY':'party','GUEST':a0_0x3382d1(0x332)},AUTO_RESET_MODES=[SYSTEM_MODES[a0_0x3382d1(0x260)],SYSTEM_MODES[a0_0x3382d1(0x2c3)]],PERSONA_MAPPING={'generic':a0_0x3382d1(0x225),'senior_aal':a0_0x3382d1(0x31d),'family':'Fokus\x20auf\x20Familienroutinen.','single_comfort':a0_0x3382d1(0x2d0),'security':a0_0x3382d1(0x208)},ACTIVITY_LEVEL_MAP={'sehr\x20hoch':0x64,'hoch':0x50,'normal':0x3c,'niedrig':0x28,'sehr\x20niedrig':0x14,'inaktiv':0x0},IS_WIN=process[a0_0x3382d1(0x248)]===a0_0x3382d1(0x288),VENV_PATH=path[a0_0x3382d1(0x292)](__dirname,a0_0x3382d1(0x1f3)),PYTHON_EXE=IS_WIN?path['join'](VENV_PATH,'Scripts',a0_0x3382d1(0x1ff)):path['join'](VENV_PATH,'bin',a0_0x3382d1(0x295)),PIP_EXE=IS_WIN?path[a0_0x3382d1(0x292)](VENV_PATH,a0_0x3382d1(0x28c),a0_0x3382d1(0x1dc)):path[a0_0x3382d1(0x292)](VENV_PATH,a0_0x3382d1(0x2f8),'pip');let activeSequence=[],sequenceTimer=null;async function startSystem(_0x5e7e13){const _0x21efd8=a0_0x3382d1;_0x5e7e13['log'][_0x21efd8(0x2b8)](_0x21efd8(0x2c5)),await initZombies(_0x5e7e13);try{_0x5e7e13['isProVersion']=await checkLicense(_0x5e7e13[_0x21efd8(0x2b9)][_0x21efd8(0x200)]);}catch(_0x49a15f){}if(!_0x5e7e13['config'][_0x21efd8(0x33f)]||_0x5e7e13['config']['inactivityThresholdHours']<0.1)_0x5e7e13[_0x21efd8(0x2b9)][_0x21efd8(0x33f)]=0xc;await initHistory(_0x5e7e13),await initSystemConfig(_0x5e7e13);if(_0x5e7e13[_0x21efd8(0x2b9)][_0x21efd8(0x1e0)])try{_0x5e7e13[_0x21efd8(0x2c4)]=new GoogleGenerativeAI(_0x5e7e13[_0x21efd8(0x2b9)]['geminiApiKey']),_0x5e7e13[_0x21efd8(0x1d2)]=_0x5e7e13[_0x21efd8(0x2c4)]['getGenerativeModel']({'model':GEMINI_MODEL,'generationConfig':{'responseMimeType':_0x21efd8(0x2fc)}}),_0x5e7e13['log'][_0x21efd8(0x2b8)](_0x21efd8(0x1fa));}catch(_0x602673){_0x5e7e13[_0x21efd8(0x343)]['error'](_0x21efd8(0x2ae)+_0x602673[_0x21efd8(0x1f5)]);}await createAllObjects(_0x5e7e13),await loadSystemMode(_0x5e7e13),await loadRawEventLog(_0x5e7e13),await loadDailyDigests(_0x5e7e13),_0x5e7e13['subscribeStates']('analysis.trigger'),_0x5e7e13[_0x21efd8(0x262)](LTM_DP_TRIGGER_DIGEST),_0x5e7e13[_0x21efd8(0x262)](_0x21efd8(0x272)),_0x5e7e13[_0x21efd8(0x262)](_0x21efd8(0x2ad)),_0x5e7e13[_0x21efd8(0x262)]('analysis.automation.triggerAction'),_0x5e7e13[_0x21efd8(0x262)](_0x21efd8(0x25a)),_0x5e7e13[_0x21efd8(0x262)]('analysis.training.triggerSecurity'),_0x5e7e13['subscribeStates']('analysis.training.triggerHealth'),_0x5e7e13[_0x21efd8(0x262)](_0x21efd8(0x21c)),await initSensorSubscriptions(_0x5e7e13),await initPresenceSubscriptions(_0x5e7e13),await setupTelegramListener(_0x5e7e13),setTimeout(()=>checkWifiPresence(_0x5e7e13),0x1388);if(_0x5e7e13[_0x21efd8(0x310)])clearInterval(_0x5e7e13[_0x21efd8(0x310)]);const _0x3a8766=_0x5e7e13['config']['analysisInterval']||0xf;_0x3a8766>0x0&&(_0x5e7e13[_0x21efd8(0x310)]=setInterval(()=>{runAutopilot(_0x5e7e13);},_0x3a8766*0x3c*0x3e8)),setupLtmScheduler(_0x5e7e13),setupModeResetScheduler(_0x5e7e13),setupDriftAnalysisScheduler(_0x5e7e13),setupBriefingScheduler(_0x5e7e13),startPythonService(_0x5e7e13),setTimeout(()=>{if(_0x5e7e13['pythonProcess'])runPythonHealthCheck(_0x5e7e13);},0x1388);}function checkAndInstall(_0x468e6a){const _0x26df2c=a0_0x3382d1;if(!fs[_0x26df2c(0x1f2)](VENV_PATH)||!fs[_0x26df2c(0x1f2)](PIP_EXE))return _0x468e6a['log']['warn'](_0x26df2c(0x2ef)),installPythonDependencies(_0x468e6a),![];return!![];}function installPythonDependencies(_0x3acc34){const _0x9d428c=a0_0x3382d1;if(_0x3acc34[_0x9d428c(0x203)])return;_0x3acc34['dependencyInstallInProgress']=!![];const _0x1d206b=path[_0x9d428c(0x292)](__dirname,_0x9d428c(0x2d2),'requirements.txt');_0x3acc34[_0x9d428c(0x343)][_0x9d428c(0x2b8)](_0x9d428c(0x328)),stopPythonService(_0x3acc34);if(fs[_0x9d428c(0x1f2)](VENV_PATH))try{fs[_0x9d428c(0x269)](VENV_PATH,{'recursive':!![],'force':!![]});}catch(_0x1ce9c9){}exec(_0x9d428c(0x300)+VENV_PATH+'\x22',_0x25e10f=>{const _0x4170b2=_0x9d428c;if(_0x25e10f){_0x3acc34[_0x4170b2(0x343)][_0x4170b2(0x32f)]('âŒ\x20VENV\x20FAILED.\x20Run:\x20sudo\x20apt\x20install\x20python3-venv'),_0x3acc34['dependencyInstallInProgress']=![];return;}installRequirementsInVenv(_0x3acc34,_0x1d206b);});}function installRequirementsInVenv(_0x430b82,_0x4eeb49){const _0x5d06c7=a0_0x3382d1;_0x430b82[_0x5d06c7(0x343)][_0x5d06c7(0x2b8)](_0x5d06c7(0x35c));const _0x3379cd='\x22'+PIP_EXE+'\x22\x20install\x20--no-cache-dir\x20--force-reinstall\x20-r\x20\x22'+_0x4eeb49+'\x22';exec(_0x3379cd,{'timeout':0x124f80},(_0x26044f,_0x153a36,_0x349f06)=>{const _0x272ca5=_0x5d06c7;_0x430b82[_0x272ca5(0x203)]=![],_0x26044f?_0x430b82[_0x272ca5(0x343)][_0x272ca5(0x32f)](_0x272ca5(0x2a7)+(_0x349f06||_0x26044f[_0x272ca5(0x1f5)])):(_0x430b82['log'][_0x272ca5(0x2b8)](_0x272ca5(0x329)),startSystem(_0x430b82));});}async function initZombies(_0x5c26f1){const _0x361b37=a0_0x3382d1;try{const _0x16a317=[_0x361b37(0x229),_0x361b37(0x2a8)];for(const _0x5351a9 of _0x16a317){try{const _0x4f2cd2=await _0x5c26f1[_0x361b37(0x349)](_0x5351a9);if(_0x4f2cd2)await _0x5c26f1[_0x361b37(0x2d5)](_0x5351a9);}catch(_0x1c5f23){}}}catch(_0x304edb){}}async function checkLicense(_0x20adeb){return!![];}async function initHistory(_0x56a2d9){const _0x5be78e=a0_0x3382d1;try{const _0xaf4d8a=await _0x56a2d9[_0x5be78e(0x31b)]('events.history');_0xaf4d8a&&_0xaf4d8a['val']&&(_0x56a2d9['eventHistory']=JSON[_0x5be78e(0x34a)](_0xaf4d8a[_0x5be78e(0x344)][_0x5be78e(0x210)]()));}catch(_0x300c35){_0x56a2d9[_0x5be78e(0x2f3)]=[];}try{const _0x29f52f=await _0x56a2d9[_0x5be78e(0x31b)](_0x5be78e(0x21a));if(_0x29f52f&&_0x29f52f[_0x5be78e(0x344)])_0x56a2d9[_0x5be78e(0x1ec)]=JSON[_0x5be78e(0x34a)](_0x29f52f[_0x5be78e(0x344)][_0x5be78e(0x210)]());}catch(_0x54acb4){_0x56a2d9[_0x5be78e(0x1ec)]=[];}if(_0x56a2d9[_0x5be78e(0x2f3)]&&_0x56a2d9[_0x5be78e(0x2f3)]['length']>0x0){_0x56a2d9[_0x5be78e(0x343)][_0x5be78e(0x2b8)](_0x5be78e(0x2bc));for(let _0x2f77aa=_0x56a2d9['eventHistory'][_0x5be78e(0x239)]-0x1;_0x2f77aa>=0x0;_0x2f77aa--){const _0x322ee2=_0x56a2d9[_0x5be78e(0x2f3)][_0x2f77aa];if(_0x322ee2&&_0x322ee2['id']!==undefined&&_0x322ee2[_0x5be78e(0x1fc)]!==undefined)_0x56a2d9[_0x5be78e(0x228)][_0x322ee2['id']]=_0x322ee2[_0x5be78e(0x1fc)];}}}async function initSystemConfig(_0x5d3913){const _0x4b5acf=a0_0x3382d1;try{const _0x2ef732=await _0x5d3913[_0x4b5acf(0x237)](_0x4b5acf(0x2fd));if(_0x2ef732&&_0x2ef732[_0x4b5acf(0x1ce)])_0x5d3913[_0x4b5acf(0x254)]={'latitude':_0x2ef732[_0x4b5acf(0x1ce)][_0x4b5acf(0x350)]||0x0,'longitude':_0x2ef732['common'][_0x4b5acf(0x32b)]||0x0,'city':_0x2ef732['common'][_0x4b5acf(0x27c)]||''};}catch(_0x947155){}}async function createAllObjects(_0x439b76){const _0x561e62=a0_0x3382d1;await _0x439b76[_0x561e62(0x330)](_0x561e62(0x264),{'type':'channel','common':{'name':_0x561e62(0x336)},'native':{}}),await _0x439b76[_0x561e62(0x330)](SYSTEM_DP_MODE,{'type':_0x561e62(0x2e3),'common':{'name':'System\x20Mode','type':_0x561e62(0x2d4),'role':_0x561e62(0x2e3),'read':!![],'write':!![],'def':SYSTEM_MODES[_0x561e62(0x2cc)]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x1d6),{'type':'state','common':{'name':'Who\x20is\x20present?','type':'string','role':_0x561e62(0x306),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x21f),{'type':_0x561e62(0x2e3),'common':{'name':'Last\x20raw\x20event','type':'string','role':_0x561e62(0x2b1),'read':!![],'write':![]},'native':{}}),await _0x439b76['setObjectNotExistsAsync'](_0x561e62(0x245),{'type':'state','common':{'name':_0x561e62(0x1c9),'type':_0x561e62(0x2d4),'role':_0x561e62(0x2b1),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x330)](_0x561e62(0x247),{'type':'channel','common':{'name':'AI\x20Training'},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x29b),{'type':'state','common':{'name':'Train\x20Security','type':_0x561e62(0x231),'role':_0x561e62(0x256),'read':!![],'write':!![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x313),{'type':'state','common':{'name':_0x561e62(0x2dd),'type':_0x561e62(0x231),'role':_0x561e62(0x256),'read':!![],'write':!![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x21c),{'type':'state','common':{'name':_0x561e62(0x23f),'type':_0x561e62(0x231),'role':'button','read':!![],'write':!![]},'native':{}}),await _0x439b76['setObjectNotExistsAsync']('analysis.training.status',{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x24f),'type':_0x561e62(0x2d4),'role':_0x561e62(0x306),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x330)](_0x561e62(0x2ff),{'type':'channel','common':{'name':_0x561e62(0x2b2)},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x320),{'type':'state','common':{'name':_0x561e62(0x290),'type':_0x561e62(0x34c),'role':_0x561e62(0x1fc),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x267),{'type':'state','common':{'name':_0x561e62(0x1f8),'type':_0x561e62(0x34c),'role':_0x561e62(0x1fc),'read':!![],'write':![],'def':0.05},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x360),{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x232),'type':_0x561e62(0x2d4),'role':_0x561e62(0x1e7),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x330)](_0x561e62(0x1db),{'type':_0x561e62(0x220),'common':{'name':_0x561e62(0x23e)},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x2a5),{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x232),'type':_0x561e62(0x2d4),'role':_0x561e62(0x1e7),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x286),{'type':'state','common':{'name':_0x561e62(0x1d8),'type':'boolean','role':_0x561e62(0x2f9),'read':!![],'write':![]},'native':{}}),await _0x439b76['setObjectNotExistsAsync']('analysis.health.trendDiagnosis',{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x365),'type':_0x561e62(0x2d4),'role':'text','read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x2f4),{'type':'state','common':{'name':_0x561e62(0x235),'type':_0x561e62(0x34c),'role':_0x561e62(0x1fc),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x330)](_0x561e62(0x2b6),{'type':'channel','common':{'name':_0x561e62(0x2a2)},'native':{}}),await _0x439b76[_0x561e62(0x224)]('analysis.energy.insulationScore',{'type':_0x561e62(0x2e3),'common':{'name':'Insulation\x20Score','type':_0x561e62(0x2d4),'role':_0x561e62(0x306),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)]('analysis.energy.heatingScore',{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x221),'type':_0x561e62(0x2d4),'role':_0x561e62(0x306),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x330)]('LTM',{'type':'channel','common':{'name':'LTM'},'native':{}}),await _0x439b76['extendObjectAsync'](LTM_DP_RAW_LOG,{'type':_0x561e62(0x2e3),'common':{'name':'Raw\x20Log','type':'string','role':_0x561e62(0x2b1),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x330)](LTM_DP_DAILY_DIGESTS,{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x1ee),'type':_0x561e62(0x2d4),'role':_0x561e62(0x2b1),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x27f),{'type':_0x561e62(0x2e3),'common':{'name':'Sequences','type':_0x561e62(0x2d4),'role':'json','read':!![],'write':![]},'native':{}}),await _0x439b76['setObjectNotExistsAsync']('LTM.trainingData.thermodynamics',{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x1f6),'type':_0x561e62(0x2d4),'role':_0x561e62(0x2b1),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x363),{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x2fb),'type':_0x561e62(0x231),'role':_0x561e62(0x256),'read':!![],'write':!![]},'native':{}}),await _0x439b76['setObjectNotExistsAsync'](_0x561e62(0x2ad),{'type':_0x561e62(0x2e3),'common':{'name':'Trigger\x20Briefing','type':_0x561e62(0x231),'role':_0x561e62(0x256),'read':!![],'write':!![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x21d),{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x2a9),'type':'boolean','role':_0x561e62(0x34d),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x2dc),{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x1d1),'type':_0x561e62(0x2d4),'role':_0x561e62(0x325),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x2d1),{'type':_0x561e62(0x2e3),'common':{'name':'Activity\x20Summary','type':'string','role':'text','read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x29d),{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x244),'type':_0x561e62(0x231),'role':'indicator','read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x25f),{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x315),'type':_0x561e62(0x2d4),'role':'text','read':!![],'write':![]},'native':{}}),await _0x439b76['setObjectNotExistsAsync'](_0x561e62(0x2f6),{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x282),'type':_0x561e62(0x2d4),'role':'text','read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x341),{'type':_0x561e62(0x2e3),'common':{'name':_0x561e62(0x206),'type':_0x561e62(0x2d4),'role':_0x561e62(0x306),'read':!![],'write':![]},'native':{}}),await _0x439b76[_0x561e62(0x224)](_0x561e62(0x25a),{'type':_0x561e62(0x2e3),'common':{'name':'Auto\x20Apply','type':_0x561e62(0x231),'role':_0x561e62(0x24d),'read':!![],'write':!![]},'native':{}}),await _0x439b76['setObjectNotExistsAsync'](_0x561e62(0x335),{'type':'state','common':{'name':_0x561e62(0x22e),'type':_0x561e62(0x231),'role':_0x561e62(0x256),'read':!![],'write':!![]},'native':{}});}async function loadSystemMode(_0xf7e524){const _0x4b9f6c=a0_0x3382d1;try{const _0x40718e=await _0xf7e524[_0x4b9f6c(0x31b)](SYSTEM_DP_MODE);_0x40718e&&_0x40718e[_0x4b9f6c(0x344)]&&Object[_0x4b9f6c(0x30f)](SYSTEM_MODES)[_0x4b9f6c(0x218)](_0x40718e[_0x4b9f6c(0x344)])?_0xf7e524[_0x4b9f6c(0x333)]=_0x40718e[_0x4b9f6c(0x344)]:(_0xf7e524[_0x4b9f6c(0x333)]=SYSTEM_MODES[_0x4b9f6c(0x2cc)],await _0xf7e524[_0x4b9f6c(0x279)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':!![]}));}catch(_0x3ae2aa){_0xf7e524[_0x4b9f6c(0x333)]=SYSTEM_MODES[_0x4b9f6c(0x2cc)];}}async function loadRawEventLog(_0x39abad){const _0x2374ec=a0_0x3382d1;try{const _0x68e81c=await _0x39abad['getStateAsync'](LTM_DP_RAW_LOG);if(_0x68e81c&&_0x68e81c['val'])_0x39abad['rawEventLog']=JSON[_0x2374ec(0x34a)](_0x68e81c[_0x2374ec(0x344)]);}catch(_0x2888a4){_0x39abad['rawEventLog']=[];}}async function saveRawEventLog(_0x5d1e82){const _0x4ac552=a0_0x3382d1;if(_0x5d1e82[_0x4ac552(0x34f)]['length']>RAW_LOG_MAX_SIZE)_0x5d1e82[_0x4ac552(0x34f)][_0x4ac552(0x2e0)](0x0,_0x5d1e82['rawEventLog']['length']-RAW_LOG_MAX_SIZE);await _0x5d1e82['setStateAsync'](LTM_DP_RAW_LOG,{'val':JSON[_0x4ac552(0x2b0)](_0x5d1e82['rawEventLog']),'ack':!![]});}async function loadDailyDigests(_0x2d367e){const _0xb3cf18=a0_0x3382d1;try{const _0x294684=await _0x2d367e[_0xb3cf18(0x31b)](LTM_DP_DAILY_DIGESTS);if(_0x294684&&_0x294684['val'])_0x2d367e[_0xb3cf18(0x241)]=JSON[_0xb3cf18(0x34a)](_0x294684['val']);}catch(_0xda12d4){_0x2d367e[_0xb3cf18(0x241)]=[];}await updateBaselineStatus(_0x2d367e);}async function saveDailyDigests(_0xb4e129,_0x2193f8=!![]){const _0x5260e8=a0_0x3382d1,_0x5e282c=_0xb4e129[_0x5260e8(0x2b9)][_0x5260e8(0x1ef)]||0x3c;_0xb4e129[_0x5260e8(0x241)][_0x5260e8(0x239)]>_0x5e282c&&_0xb4e129[_0x5260e8(0x241)][_0x5260e8(0x2e0)](0x0,_0xb4e129[_0x5260e8(0x241)][_0x5260e8(0x239)]-_0x5e282c);await _0xb4e129[_0x5260e8(0x279)](LTM_DP_DAILY_DIGESTS,{'val':JSON[_0x5260e8(0x2b0)](_0xb4e129[_0x5260e8(0x241)]),'ack':!![]});if(_0x2193f8)await updateBaselineStatus(_0xb4e129);}async function updateAnalysisHistory(_0x34c898,_0x403a6f){const _0x576f3a=a0_0x3382d1;_0x34c898['analysisHistory'][_0x576f3a(0x276)](_0x403a6f);if(_0x34c898[_0x576f3a(0x1ec)][_0x576f3a(0x239)]>HISTORY_MAX_SIZE)_0x34c898[_0x576f3a(0x1ec)][_0x576f3a(0x291)]();await _0x34c898[_0x576f3a(0x279)](_0x576f3a(0x21a),{'val':JSON[_0x576f3a(0x2b0)](_0x34c898['analysisHistory']),'ack':!![]});}async function updateBaselineStatus(_0x46ad2a){const _0x578fa2=a0_0x3382d1;if(!_0x46ad2a[_0x578fa2(0x348)]){await _0x46ad2a['setStateAsync'](LTM_DP_BASELINE_STATUS,{'val':_0x578fa2(0x209),'ack':!![]});return;}const _0x3aa274=_0x46ad2a[_0x578fa2(0x241)][_0x578fa2(0x239)]>=(_0x46ad2a[_0x578fa2(0x2b9)]['minDaysForBaseline']||0x7)?_0x578fa2(0x314)+_0x46ad2a[_0x578fa2(0x241)][_0x578fa2(0x239)]+'\x20Tage)':_0x578fa2(0x35e)+_0x46ad2a[_0x578fa2(0x241)][_0x578fa2(0x239)]+'/'+(_0x46ad2a[_0x578fa2(0x2b9)]['minDaysForBaseline']||0x7)+')';await _0x46ad2a[_0x578fa2(0x279)](LTM_DP_BASELINE_STATUS,{'val':_0x3aa274,'ack':!![]});}async function initSensorSubscriptions(_0x523090){const _0x331325=a0_0x3382d1,_0x4a93a7=_0x523090['config']['devices'];if(_0x4a93a7)for(const _0x359881 of _0x4a93a7){await _0x523090[_0x331325(0x23a)](_0x359881['id']);}}async function initPresenceSubscriptions(_0x34bfee){const _0x12f09a=a0_0x3382d1,_0x315f06=_0x34bfee[_0x12f09a(0x2b9)][_0x12f09a(0x242)];if(_0x315f06)for(const _0x1995cf of _0x315f06){await _0x34bfee['subscribeForeignStatesAsync'](_0x1995cf);}}function a0_0x5aea(){const _0x3d9ad5=['isPresent','systemConfig','getDate','button','analysis.lastResult','setState','generateContent','analysis.automation.autoApply','type','exitGraceTimer','automation.triggerAction','ltmStbWindowDays','analysis.automation.description','PARTY','analysis.training.status','subscribeStates','loc','system','notifyEmailRecipient','stdout','analysis.security.currentThreshold','expire','rmSync','âš ï¸\x20ALARM:\x20','vacation','testContext','telegram','ðŸ§ª\x20Simulating\x20Butler\x20Proposal:\x20','Error\x20launching\x20Python:\x20','.Current.Temperature','accuweather','system.mode','Alarm','KI-Modell\x20nicht\x20initialisiert','toLowerCase','unshift','generic','Kein\x20API\x20Key!','setStateAsync','submitFeedback','success','city','status','LTM.baselineStatus','LTM.trainingData.sequences','from','LTM.triggerDailyDigest','Target\x20ID','TRAINING_COMPLETE','434344ASmkXv','door','analysis.health.isAnomaly','weatherInstance','win32','isEmergency','name','now','Scripts','[PYTHON]\x20','.forecast.current.temp','2sfNmVg','Anomaly\x20Score','pop','join','ðŸ\x20Python\x20Pong','.\x20ANWESEND:\x20','python','TRAIN_HEALTH','apply','object','notifyPushoverInstance','bind','analysis.training.triggerSecurity','ðŸ§ \x20Triggering\x20Security\x20Training...','analysis.automation.patternDetected','substring','getCalendarNames','getForeignObjectsAsync','contact','Energy\x20Intelligence','endsWith','reason','analysis.health.lastCheck','@iobroker/adapter-core','âŒ\x20INSTALL\x20FAILED:\x20','events.history_debug_00','Alert\x20Status','driftAnalysisTimer','ltmDriftCheckIntervalHours','.forecast.current.temperature','analysis.triggerBriefing','Gemini\x20Init\x20Error:\x20','isExit','stringify','json','Security\x20Monitor','3579666lwlvde','startsWith','location','analysis.energy','0\x204\x20*\x20*\x20*','info','config','dimmer','close','Restoring\x20sensor\x20cache...','toISOString','unload','Kein\x20API\x20Key.','notifyTelegramRecipient','TRAIN_SECURITY','7025552MhZMuA','GUEST','genAI','ðŸš€\x20Starting\x20System\x20Logic...','LTM.trainingData.thermodynamics','triggerDailyDigest','map','targetId','analysis.energy.heatingScore','Vom\x20Benutzer\x20bestÃ¤tigt\x20(OK).','NORMAL','push','âœ…\x20Alarm\x20quittiert.\x20System\x20normal.','.NextHours.Location_1.Day_1.current.temp_value','Fokus\x20auf\x20Komfort.','analysis.activitySummary','python_service','occupancy','string','delObjectAsync','ltmJob','stateChange','Training\x20Error:\x20','siren','LTM.driftAnalysis','logDuplicates','analysis.alertReason','Train\x20Health','ðŸ“ž\x20RÃ¼ckruf\x20anfordern','.\x20KONTEXT:\x20','splice','child_process','kill','state','activityLevel','ðŸ¤–\x20BUTLER:\x20No\x20valid\x20target\x20ID\x20or\x20value\x20stored\x20for\x20execution.','normal','Success:\x20','ðŸ¤–\x20BUTLER:\x20Executing\x20Action\x20->\x20','main','COGNI_CONFIRM_OK','outdoorSensorId','LTM\x20Sched\x20Error:\x20','getFullYear','Skipped\x20(No\x20AI\x20or\x20Data)','âš ï¸\x20Python\x20VENV\x20missing/broken.\x20Starting\x20MAINTENANCE\x20MODE...','OK:\x20','livingContext','Success','eventHistory','analysis.health.trendValue','notifyPushoverEnabled','analysis.automation.targetId','Sec-Training\x20started...','bin','indicator','bewegung','Trigger\x20Analysis','application/json','system.config','LTM.dailyDigests','analysis.security','python3\x20-m\x20venv\x20\x22','path','6484851VteSbP','prÃ¤senz','Err:\x20','178819FCNvKa','text','UngewÃ¶hnliches\x20Bewegungsmuster!\x20(Score:\x20','scheduleJob','getGenerativeModel','notifyEmailEnabled','timestamp','TRAIN_ENERGY','automationProposal','details','values','analysisTimer','setForeignStateAsync','onMessage','analysis.training.triggerHealth','Aktiv\x20(','Description','modeResetJob','âœ…\x20HEALTH\x20TRAINED.','(((.+)+)+)+$','getLtmData','Gemini\x20Error:\x20','getStateAsync','find','PRIORITÃ„T:\x20Gesundheit/AAL.','triggerBriefing','Drift\x20Sched\x20Error:\x20','analysis.security.lastScore','[RESULT]','description','08:00','send','text.alarm','sendTo','isAlert','ðŸ› ï¸\x20Installing\x20Python\x20environment.\x20Do\x20not\x20restart!','âœ…\x20INSTALL\x20SUCCESS.','isGracePeriodActive','longitude','heizung','node-schedule','alertReason','error','extendObjectAsync','0\x203\x20*\x20*\x20*','guest','currentSystemMode','.\x20EMERGENCY:\x20','analysis.automation.triggerAction','System','devices','.\x20AUFGABE:\x201.\x20Gesundheit?\x202.\x20Komfort?\x20FORMAT\x20(JSON):\x20{\x20\x22isAlert\x22:\x20boolean,\x20\x22alertReason\x22:\x20\x22string\x22,\x20\x22isEmergency\x22:\x20boolean,\x20\x22summary\x22:\x20\x22string\x22,\x20\x22automationProposal\x22:\x20{\x20\x22detected\x22:\x20boolean,\x20\x22description\x22:\x20\x22string\x22,\x20\x22targetId\x22:\x20\x22string\x22,\x20\x22targetValue\x22:\x20\x22any\x22\x20}\x20}','openweathermap','getMonth','getHours','686224vLbcro','.\x20EVENTS:\x20','search','inactivityThresholdHours','is_anomaly','analysis.automation.targetValue','5skDYMY','log','val','onStateChange','analysis.energy.insulationScore','payload','isProVersion','getObjectAsync','parse','âš ï¸\x20SECURITY\x20ALARM:\x20','number','indicator.alarm','forEach','rawEventLog','latitude','presence','\x20=\x20','insulation','writable','enum.functions.*','PONG','briefingJob','ack','callback','baselineDrift','cancel','Installing\x20pip\x20packages...','round','Lernphase\x20(','shift','analysis.security.lastCheck','simulateButler','getTime','analysis.trigger','Adapter','Trend','Event\x20History','analysis.health.trendDiagnosis','SIMULATION:\x20Test-Vorschlag\x20fÃ¼r\x20','WiFi\x20Presence\x20detected.','response','common','window','ROLLE:\x20Data\x20Compression\x20Agent.\x20SPRACHE:\x20DE.\x20FORMAT:\x20JSON.\x20ANWEISUNG:\x20Fasse\x20Sensor-Events\x20zusammen.\x20SCHEMA:\x20{\x20\x22summary\x22:\x20\x22string\x22,\x20\x22activityLevel\x22:\x20\x22string\x22\x20}\x20\x0a\x0aEVENTS:\x0a','Alert\x20Reason','geminiModel','indexOf','SECURITY_RESULT','notifyPushoverRecipient','system.presenceWho','onReady','Anomaly\x20Detected','detected','namespace','analysis.health','pip.exe','No\x20instance','some','N/A','geminiApiKey','Reset\x20Sched\x20Error:\x20','slice','driftDetails','Started...','pythonProcess','\x20->\x20','date','Keine\x20Details.','enum','LTM.rawEventLog','\x20*\x20*\x20*','analysisHistory','HEALTH_RESULT','Daily\x20Digests','ltmLtbWindowDays','warn','VACATION','existsSync','.venv','write','message','Thermodynamics','ROLLE:\x20KI-Hausverwalter.\x20PERSONA:\x20','Current\x20Threshold','systemUUID','Gemini\x20AI\x20initialized.','ready','value','toFixed','constructor','python.exe','licenseKey','replace','getEnums','dependencyInstallInProgress','cogni-living\x20adapter\x20starting\x20(v','daswetter','Target\x20Value','schalter','PRIORITÃ„T:\x20Sicherheit.','Deaktiviert\x20(Pro-Feature)','getForeignStateAsync','LTM.driftAnalysis.lastCheck','retry','split','licht','klima','toString','Missing\x20data','exitTimer','toLocaleTimeString','1320285KuYPxg','trim','cogni-living','fill','includes','heating','analysis.analysisHistory','TREND_RESULT','analysis.training.triggerEnergy','analysis.isAlert','onUnload','events.lastEvent','channel','Heating\x20Score','ðŸš¨\x20EMERGENCY','testApiKey','setObjectNotExistsAsync','Analysiere\x20ausgewogen.','data','notifyTelegramInstance','sensorLastValues','analysis.history_debug_00','exports','filter','command','notifyTelegramEnabled','Trigger\x20Action','useWeather','weatherunderground','boolean','Last\x20Check','targetValue','N/A\x20(Learning)','Trend\x20Value','temperatur','getForeignObjectAsync','diagnosis','length','subscribeForeignStatesAsync','light','lastAlertState','minDaysForBaseline','Health\x20Analysis','Train\x20Energy','Cogni-Living','dailyDigests','presenceDevices','system.isPresent','Pattern\x20Detected','events.history','version','analysis.training','platform','sendToAsync','summary','debug','getOverviewData','switch','Unknown','Training\x20Status','LTM.driftAnalysis.driftDetails','ðŸ›¡ï¸\x20SECURITY\x20CHECK:\x20Score\x20','Unbekannt'];a0_0x5aea=function(){return _0x3d9ad5;};return a0_0x5aea();}async function setupTelegramListener(_0x2f512b){const _0xcf3969=a0_0x3382d1,_0x3d068e=_0x2f512b['config'][_0xcf3969(0x227)];if(_0x2f512b[_0xcf3969(0x2b9)][_0xcf3969(0x22d)]&&_0x3d068e)await _0x2f512b[_0xcf3969(0x23a)](_0x3d068e+'.communicate.request');}async function checkWifiPresence(_0x484482){const _0x55c5e3=a0_0x3382d1;try{const _0x52d149=_0x484482[_0x55c5e3(0x2b9)][_0x55c5e3(0x242)]||[];let _0x2806a6=![];const _0x36c039=[];for(const _0x3344f2 of _0x52d149){try{const _0x1deb14=await _0x484482[_0x55c5e3(0x20a)](_0x3344f2);_0x1deb14&&(_0x1deb14[_0x55c5e3(0x344)]===!![]||_0x1deb14[_0x55c5e3(0x344)]==='online'||_0x1deb14[_0x55c5e3(0x344)]===0x1)&&(_0x2806a6=!![],_0x36c039['push'](_0x3344f2));}catch(_0x2925f8){}}return await _0x484482[_0x55c5e3(0x279)](_0x55c5e3(0x1d6),{'val':_0x36c039['join'](',\x20'),'ack':!![]}),_0x2806a6&&(_0x484482[_0x55c5e3(0x212)]&&(_0x484482[_0x55c5e3(0x343)][_0x55c5e3(0x2b8)](_0x55c5e3(0x1cc)),abortExitTimer(_0x484482)),!_0x484482[_0x55c5e3(0x253)]&&_0x484482[_0x55c5e3(0x333)]===SYSTEM_MODES[_0x55c5e3(0x2cc)]&&await setPresence(_0x484482,!![])),_0x2806a6;}catch(_0x297388){return![];}}function startExitTimer(_0x380198){const _0x9176ee=a0_0x3382d1;abortExitTimer(_0x380198),_0x380198[_0x9176ee(0x32a)]=!![],_0x380198[_0x9176ee(0x25c)]=setTimeout(()=>{const _0x47df51=_0x9176ee;_0x380198[_0x47df51(0x32a)]=![];},EXIT_GRACE_PERIOD_SECONDS*0x3e8),_0x380198[_0x9176ee(0x212)]=setTimeout(()=>{setPresence(_0x380198,![]),_0x380198['exitTimer']=null;},EXIT_TIMER_MINUTES*0x3c*0x3e8);}function abortExitTimer(_0x201774){const _0x55dcc1=a0_0x3382d1;if(_0x201774[_0x55dcc1(0x212)])clearTimeout(_0x201774[_0x55dcc1(0x212)]);if(_0x201774[_0x55dcc1(0x25c)])clearTimeout(_0x201774['exitGraceTimer']);_0x201774['exitTimer']=null,_0x201774[_0x55dcc1(0x25c)]=null,_0x201774[_0x55dcc1(0x32a)]=![];}function a0_0x4499(_0x32461b,_0x3ba8ad){const _0x1213b8=a0_0x5aea();return a0_0x4499=function(_0x57df65,_0x224323){_0x57df65=_0x57df65-0x1c9;let _0x5aeaeb=_0x1213b8[_0x57df65];return _0x5aeaeb;},a0_0x4499(_0x32461b,_0x3ba8ad);}async function setPresence(_0x1c87c2,_0x35f382){const _0x1e0b05=a0_0x3382d1;if(_0x1c87c2['isPresent']===_0x35f382)return;_0x1c87c2['isPresent']=_0x35f382,await _0x1c87c2['setStateAsync'](_0x1e0b05(0x243),{'val':_0x35f382,'ack':!![]});}async function executeAutomationAction(_0x26bcf8){const _0xc32724=a0_0x3382d1;try{const _0x4b4328=await _0x26bcf8[_0xc32724(0x31b)](_0xc32724(0x2f6)),_0x39c8c5=await _0x26bcf8[_0xc32724(0x31b)](_0xc32724(0x341));if(_0x4b4328&&_0x4b4328[_0xc32724(0x344)]&&_0x39c8c5){const _0x319997=_0x4b4328[_0xc32724(0x344)];let _0x43378d=_0x39c8c5[_0xc32724(0x344)];try{_0x43378d=JSON[_0xc32724(0x34a)](_0x43378d);}catch(_0x5c40f0){}_0x26bcf8['log'][_0xc32724(0x2b8)](_0xc32724(0x2e8)+_0x319997+_0xc32724(0x352)+_0x43378d),await _0x26bcf8[_0xc32724(0x311)](_0x319997,_0x43378d);}else _0x26bcf8[_0xc32724(0x343)][_0xc32724(0x1f0)](_0xc32724(0x2e5));}catch(_0x222c9e){_0x26bcf8[_0xc32724(0x343)]['error']('BUTLER\x20Execution\x20Error:\x20'+_0x222c9e[_0xc32724(0x1f5)]);}}async function processSensorEvent(_0x5bf391,_0xb12f87,_0x47356e,_0x5e3cf0){const _0x34a616=a0_0x3382d1;if(!_0x5e3cf0)return;const _0x3d614f=_0x47356e['val'],_0x5e7cc7=Date[_0x34a616(0x28b)](),_0x37645d=_0x5bf391['sensorLastValues'][_0xb12f87];_0x5bf391[_0x34a616(0x228)][_0xb12f87]=_0x3d614f;if(!_0x5e3cf0[_0x34a616(0x2db)]&&_0x37645d!=undefined&&_0x37645d==_0x3d614f)return;const _0x385fe0=(_0x5e3cf0[_0x34a616(0x25b)]||'')[_0x34a616(0x275)](),_0xa1f534=_0x385fe0[_0x34a616(0x218)]('temperature')||_0x385fe0['includes'](_0x34a616(0x236))||_0x385fe0[_0x34a616(0x218)](_0x34a616(0x20f))||_0x385fe0[_0x34a616(0x218)](_0x34a616(0x32c));_0x5bf391[_0x34a616(0x348)]&&_0xa1f534&&recordThermodynamics(_0x5bf391,_0xb12f87,_0x3d614f,_0x5e3cf0[_0x34a616(0x2b5)]);const _0x4264b3={'timestamp':_0x5e7cc7,'id':_0xb12f87,'name':_0x5e3cf0['name'],'type':_0x5e3cf0[_0x34a616(0x25b)],'location':_0x5e3cf0[_0x34a616(0x2b5)],'value':_0x3d614f};_0x5bf391['eventHistory']['unshift'](_0x4264b3);if(_0x5bf391[_0x34a616(0x2f3)][_0x34a616(0x239)]>HISTORY_MAX_SIZE)_0x5bf391[_0x34a616(0x2f3)]['pop']();await _0x5bf391[_0x34a616(0x279)](_0x34a616(0x21f),{'val':JSON['stringify'](_0x4264b3),'ack':!![]}),await _0x5bf391['setStateAsync'](_0x34a616(0x245),{'val':JSON[_0x34a616(0x2b0)](_0x5bf391[_0x34a616(0x2f3)]),'ack':!![]});_0x5bf391[_0x34a616(0x348)]&&(_0x5bf391['rawEventLog'][_0x34a616(0x2cd)](_0x4264b3),await saveRawEventLog(_0x5bf391),recordSequence(_0x5bf391,_0x4264b3));if(_0x5e3cf0[_0x34a616(0x2af)]&&_0x3d614f===!![]){if(_0x5bf391[_0x34a616(0x253)]&&!_0x5bf391[_0x34a616(0x32a)])startExitTimer(_0x5bf391);else{if(!_0x5bf391['isPresent'])setPresence(_0x5bf391,!![]);}}else{if(_0x5e3cf0[_0x34a616(0x25b)]==='motion'&&_0x3d614f===!![]){if(_0x5bf391['exitTimer'])abortExitTimer(_0x5bf391);if(!_0x5bf391[_0x34a616(0x253)]&&_0x5bf391[_0x34a616(0x333)]===SYSTEM_MODES[_0x34a616(0x2cc)])setPresence(_0x5bf391,!![]);}}}async function recordThermodynamics(_0x44de62,_0xeddb06,_0x41b1d3,_0x36b4ec){const _0x5c023f=a0_0x3382d1,_0x3f0741=await getOutsideTemperatureNumeric(_0x44de62),_0x30d761=await _0x44de62[_0x5c023f(0x31b)](_0x5c023f(0x2c6));let _0x335d80=[];if(_0x30d761&&_0x30d761['val'])try{_0x335d80=JSON[_0x5c023f(0x34a)](_0x30d761['val']);}catch(_0x332092){}_0x335d80['push']({'ts':Date['now'](),'room':_0x36b4ec||_0x5c023f(0x24e),'t_in':_0x41b1d3,'t_out':_0x3f0741});if(_0x335d80[_0x5c023f(0x239)]>THERMO_LOG_SIZE)_0x335d80[_0x5c023f(0x35f)]();await _0x44de62[_0x5c023f(0x279)](_0x5c023f(0x2c6),{'val':JSON[_0x5c023f(0x2b0)](_0x335d80),'ack':!![]});}async function getOutsideTemperatureNumeric(_0x3bac34){const _0x122253=a0_0x3382d1;if(_0x3bac34['config'][_0x122253(0x2eb)])try{const _0x1dd21c=await _0x3bac34[_0x122253(0x20a)](_0x3bac34[_0x122253(0x2b9)][_0x122253(0x2eb)]);if(_0x1dd21c&&_0x1dd21c[_0x122253(0x344)]!==undefined&&_0x1dd21c[_0x122253(0x344)]!==null)return parseFloat(_0x1dd21c[_0x122253(0x344)]);}catch(_0x36dfc3){}const _0x33205d=_0x3bac34[_0x122253(0x2b9)][_0x122253(0x287)];if(!_0x3bac34[_0x122253(0x2b9)][_0x122253(0x22f)]||!_0x33205d)return null;try{let _0x3659a6='';if(_0x33205d['includes'](_0x122253(0x271)))_0x3659a6=_0x33205d+_0x122253(0x270);else{if(_0x33205d[_0x122253(0x218)](_0x122253(0x205)))_0x3659a6=_0x33205d+_0x122253(0x2cf);else{if(_0x33205d['includes'](_0x122253(0x339)))_0x3659a6=_0x33205d+_0x122253(0x2ac);else{if(_0x33205d[_0x122253(0x218)](_0x122253(0x230)))_0x3659a6=_0x33205d+_0x122253(0x28e);}}}if(_0x3659a6){const _0x26e369=await _0x3bac34[_0x122253(0x20a)](_0x3659a6);if(_0x26e369&&_0x26e369[_0x122253(0x344)]!==undefined&&_0x26e369[_0x122253(0x344)]!==null)return parseFloat(_0x26e369[_0x122253(0x344)]);}}catch(_0x716080){}return null;}async function recordSequence(_0xec34a1,_0x55ea4f){const _0x3e758c=a0_0x3382d1,_0x5df631=(_0x55ea4f[_0x3e758c(0x25b)]||'')[_0x3e758c(0x275)](),_0x321c49=['motion',_0x3e758c(0x2fa),_0x3e758c(0x303),_0x3e758c(0x351),_0x3e758c(0x2d3),_0x3e758c(0x285),'tÃ¼r',_0x3e758c(0x1cf),'fenster',_0x3e758c(0x2a1),'kontakt',_0x3e758c(0x23b),_0x3e758c(0x20e),_0x3e758c(0x24d),_0x3e758c(0x207),_0x3e758c(0x2ba),'lampe'];if(!_0x321c49[_0x3e758c(0x1de)](_0x2a98c2=>_0x5df631['includes'](_0x2a98c2)))return;if(!_0x55ea4f[_0x3e758c(0x1fc)])return;if(sequenceTimer)clearTimeout(sequenceTimer);activeSequence[_0x3e758c(0x2cd)]({'loc':_0x55ea4f[_0x3e758c(0x2b5)]||_0x3e758c(0x24e),'id':_0x55ea4f['id'],'ts':Date[_0x3e758c(0x28b)]()}),sequenceTimer=setTimeout(async()=>{const _0x1ca651=_0x3e758c;if(activeSequence[_0x1ca651(0x239)]>0x1)await saveCompletedSequence(_0xec34a1);activeSequence=[];},SEQUENCE_TIMEOUT_MS);}async function saveCompletedSequence(_0x2962b8){const _0x179bc5=a0_0x3382d1;try{const _0x2ac54c=await _0x2962b8[_0x179bc5(0x31b)](_0x179bc5(0x27f));let _0x144570=[];if(_0x2ac54c&&_0x2ac54c['val'])try{_0x144570=JSON[_0x179bc5(0x34a)](_0x2ac54c['val']);}catch(_0x4429b4){}const _0x3770d6=activeSequence[0x0]['ts'],_0x285370=activeSequence[_0x179bc5(0x2c8)](_0x57a9ab=>({'loc':_0x57a9ab[_0x179bc5(0x263)],'t_delta':Math[_0x179bc5(0x35d)]((_0x57a9ab['ts']-_0x3770d6)/0x3e8)})),_0x3d314d={'timestamp':new Date(_0x3770d6)[_0x179bc5(0x2bd)](),'steps':_0x285370,'duration':Math[_0x179bc5(0x35d)]((activeSequence[activeSequence['length']-0x1]['ts']-_0x3770d6)/0x3e8),'daytime':new Date(_0x3770d6)[_0x179bc5(0x33b)]()};_0x144570[_0x179bc5(0x2cd)](_0x3d314d);if(_0x144570[_0x179bc5(0x239)]>MAX_TRAINING_SET_SIZE)_0x144570[_0x179bc5(0x35f)]();await _0x2962b8['setStateAsync']('LTM.trainingData.sequences',{'val':JSON['stringify'](_0x144570),'ack':!![]}),runSecurityCheck(_0x2962b8,_0x3d314d);}catch(_0x543838){_0x2962b8['log'][_0x179bc5(0x32f)]('[RECORDER]\x20Error:\x20'+_0x543838[_0x179bc5(0x1f5)]);}}function runSecurityCheck(_0x544561,_0x3a6c25){if(!_0x544561['isProVersion'])return;sendToPython(_0x544561,'ANALYZE_SEQUENCE',{'sequence':_0x3a6c25});}function sendToPython(_0x13b3aa,_0x470d76,_0xcb16bf={}){const _0x143443=a0_0x3382d1;if(!_0x13b3aa[_0x143443(0x1e5)]||!_0x13b3aa[_0x143443(0x1e5)]['stdin'][_0x143443(0x354)])return;const _0x14fa04=JSON[_0x143443(0x2b0)]({'command':_0x470d76,..._0xcb16bf});try{_0x13b3aa['pythonProcess']['stdin'][_0x143443(0x1f4)](_0x14fa04+'\x0a');}catch(_0x269eb5){}}function startPythonService(_0x51b72e){const _0x218e1a=a0_0x3382d1;let _0x549b9e='python3';if(fs[_0x218e1a(0x1f2)](PYTHON_EXE))_0x549b9e=PYTHON_EXE;try{const _0x524c00=path['join'](__dirname,_0x218e1a(0x2d2),'service.py');_0x51b72e[_0x218e1a(0x1e5)]=spawn(_0x549b9e,[_0x524c00]),_0x51b72e[_0x218e1a(0x1e5)][_0x218e1a(0x266)]['on'](_0x218e1a(0x226),_0x1c1397=>{const _0x37a9cb=_0x218e1a,_0x594aaa=_0x1c1397[_0x37a9cb(0x210)]()[_0x37a9cb(0x20d)]('\x0a');_0x594aaa[_0x37a9cb(0x34e)](_0x3a080f=>{const _0x46f530=_0x37a9cb,_0x4716db=_0x3a080f[_0x46f530(0x215)]();if(!_0x4716db)return;if(_0x4716db[_0x46f530(0x2b4)]('[LOG]'))_0x51b72e[_0x46f530(0x343)][_0x46f530(0x24b)](_0x46f530(0x28d)+_0x4716db[_0x46f530(0x29e)](0x5)[_0x46f530(0x215)]());else{if(_0x4716db[_0x46f530(0x2b4)](_0x46f530(0x321)))try{const _0x44e29e=JSON[_0x46f530(0x34a)](_0x4716db[_0x46f530(0x29e)](0x8)[_0x46f530(0x215)]());handlePythonResult(_0x51b72e,_0x44e29e);}catch(_0xc537db){}}});}),_0x51b72e['pythonProcess']['on'](_0x218e1a(0x2bb),_0x9d5ef0=>{_0x51b72e['pythonProcess']=null;});}catch(_0x3c136c){_0x51b72e['log'][_0x218e1a(0x32f)](_0x218e1a(0x26f)+_0x3c136c['message']);}}function stopPythonService(_0x4ae32a){const _0x521787=a0_0x3382d1;if(_0x4ae32a[_0x521787(0x1e5)]){try{_0x4ae32a[_0x521787(0x1e5)][_0x521787(0x2e2)]();}catch(_0x4e9a45){}_0x4ae32a[_0x521787(0x1e5)]=null;}}function handlePythonResult(_0x245ae2,_0xd1d6b3){const _0x1cf94d=a0_0x3382d1;if(_0xd1d6b3['type']===_0x1cf94d(0x356))_0x245ae2[_0x1cf94d(0x343)]['debug'](_0x1cf94d(0x293));else{if(_0xd1d6b3[_0x1cf94d(0x25b)]===_0x1cf94d(0x1d4)){const {anomaly_score:_0x454062,is_anomaly:_0x1e1e28,threshold:_0x3b13ac}=_0xd1d6b3['payload'];_0x245ae2[_0x1cf94d(0x343)]['info'](_0x1cf94d(0x251)+_0x454062['toFixed'](0x5)+_0x1cf94d(0x1e6)+(_0x1e1e28?'ANOMALY':'OK')),_0x245ae2[_0x1cf94d(0x279)](_0x1cf94d(0x320),{'val':_0x454062,'ack':!![]}),_0x245ae2['setStateAsync'](_0x1cf94d(0x360),{'val':new Date()[_0x1cf94d(0x2bd)](),'ack':!![]});if(_0x3b13ac)_0x245ae2['setStateAsync'](_0x1cf94d(0x267),{'val':_0x3b13ac,'ack':!![]});if(_0x1e1e28){const _0x114e3c=_0x1cf94d(0x307)+_0x454062[_0x1cf94d(0x1fd)](0x4)+')';_0x245ae2[_0x1cf94d(0x279)](_0x1cf94d(0x21d),{'val':!![],'ack':!![]}),_0x245ae2[_0x1cf94d(0x279)](_0x1cf94d(0x2dc),{'val':_0x114e3c,'ack':!![]}),sendNotification(_0x245ae2,_0x1cf94d(0x34b)+_0x114e3c,![],!![]);}}else{if(_0xd1d6b3[_0x1cf94d(0x25b)]===_0x1cf94d(0x283)){const _0x12935d=_0xd1d6b3[_0x1cf94d(0x347)][_0x1cf94d(0x30e)]||'',_0x4b57a8=_0xd1d6b3['payload'][_0x1cf94d(0x27b)]?_0x1cf94d(0x2e7)+new Date()[_0x1cf94d(0x213)]()+'\x20('+_0x12935d+')':'Failed:\x20'+_0xd1d6b3['payload'][_0x1cf94d(0x2a4)];_0x245ae2[_0x1cf94d(0x279)](_0x1cf94d(0x261),{'val':_0x4b57a8,'ack':!![]});}else{if(_0xd1d6b3[_0x1cf94d(0x25b)]==='ENERGY_TRAIN_RESULT'){if(_0xd1d6b3[_0x1cf94d(0x347)][_0x1cf94d(0x27b)])try{const _0x56407e=JSON[_0x1cf94d(0x34a)](_0xd1d6b3[_0x1cf94d(0x347)][_0x1cf94d(0x30e)]);if(_0x56407e['insulation'])_0x245ae2['setStateAsync'](_0x1cf94d(0x346),{'val':JSON['stringify'](_0x56407e[_0x1cf94d(0x353)]),'ack':!![]});if(_0x56407e[_0x1cf94d(0x219)])_0x245ae2[_0x1cf94d(0x279)](_0x1cf94d(0x2ca),{'val':JSON[_0x1cf94d(0x2b0)](_0x56407e[_0x1cf94d(0x219)]),'ack':!![]});}catch(_0x592cf1){}}else{if(_0xd1d6b3[_0x1cf94d(0x25b)]==='HEALTH_TRAIN_RESULT'){if(_0xd1d6b3['payload']['success'])_0x245ae2['log'][_0x1cf94d(0x2b8)](_0x1cf94d(0x317));}else{if(_0xd1d6b3['type']===_0x1cf94d(0x1ed))_0x245ae2['setStateAsync']('analysis.health.lastCheck',{'val':new Date()['toISOString'](),'ack':!![]}),_0x245ae2[_0x1cf94d(0x279)](_0x1cf94d(0x286),{'val':_0xd1d6b3[_0x1cf94d(0x347)][_0x1cf94d(0x340)],'ack':!![]});else _0xd1d6b3[_0x1cf94d(0x25b)]===_0x1cf94d(0x21b)&&(_0x245ae2['setStateAsync'](_0x1cf94d(0x1ca),{'val':_0xd1d6b3['payload'][_0x1cf94d(0x238)],'ack':!![]}),_0x245ae2[_0x1cf94d(0x279)](_0x1cf94d(0x2f4),{'val':_0xd1d6b3[_0x1cf94d(0x347)]['change_percent'],'ack':!![]}));}}}}}}function runPythonHealthCheck(_0x224386){const _0x529d24=a0_0x3382d1;if(!_0x224386[_0x529d24(0x241)]||_0x224386[_0x529d24(0x241)][_0x529d24(0x239)]<0x2)return;const _0x394247=_0x224386[_0x529d24(0x241)][_0x529d24(0x2c8)](_0x2f94f5=>{const _0x1405dd=_0x529d24,_0xd4fcc1=(_0x2f94f5[_0x1405dd(0x2e4)]||'')[_0x1405dd(0x275)]();return ACTIVITY_LEVEL_MAP[_0xd4fcc1]||0x32;});sendToPython(_0x224386,'ANALYZE_TREND',{'values':_0x394247,'tag':'Activity-Level'});}async function handleTelegramResponse(_0x2335cd,_0x4ba927){const _0x14063b=a0_0x3382d1;let _0x3401b3=_0x4ba927;_0x4ba927[_0x14063b(0x2b4)]('[')&&(_0x3401b3=_0x4ba927['substring'](_0x4ba927[_0x14063b(0x1d3)](']')+0x1));if(_0x3401b3===_0x14063b(0x2ea))await _0x2335cd[_0x14063b(0x279)](_0x14063b(0x21d),{'val':![],'ack':!![]}),await _0x2335cd[_0x14063b(0x279)]('analysis.alertReason',{'val':_0x14063b(0x2cb),'ack':!![]}),_0x2335cd[_0x14063b(0x23c)]=![],sendNotification(_0x2335cd,_0x14063b(0x2ce),![]);else _0x3401b3==='COGNI_REQUEST_CALL'&&sendNotification(_0x2335cd,'ðŸ“ž\x20RÃœCKRUF\x20BITTE!\x20Der\x20Bewohner\x20hat\x20den\x20RÃ¼ckruf-Button\x20gedrÃ¼ckt.',![],!![]);}async function sendNotification(_0x56af1f,_0x405a5e,_0x2ac8e0=![],_0x291685=![]){const _0x571971=a0_0x3382d1,_0x5a292b=_0x56af1f[_0x571971(0x2b9)];if(_0x5a292b[_0x571971(0x22d)]){let _0x3cf8a3={};(_0x405a5e[_0x571971(0x218)](_0x571971(0x273))||_0x291685)&&(_0x3cf8a3={'reply_markup':{'inline_keyboard':[[{'text':'âœ…\x20Alles\x20OK\x20(Reset)','callback_data':'COGNI_CONFIRM_OK'}],[{'text':_0x571971(0x2de),'callback_data':'COGNI_REQUEST_CALL'}]]}}),await _0x56af1f[_0x571971(0x249)](_0x5a292b[_0x571971(0x227)],_0x571971(0x324),{'text':_0x405a5e,'user':_0x5a292b[_0x571971(0x2c0)],..._0x3cf8a3});}if(_0x5a292b[_0x571971(0x2f5)]){let _0x5367bd={'message':_0x405a5e,'title':_0x291685?_0x571971(0x222):_0x571971(0x240),'priority':_0x291685?0x2:0x1,'device':_0x5a292b[_0x571971(0x1d5)]};_0x291685&&(_0x5367bd[_0x571971(0x20c)]=0x1e,_0x5367bd[_0x571971(0x268)]=0xe10,_0x5367bd['sound']=_0x571971(0x2d9)),await _0x56af1f[_0x571971(0x249)](_0x5a292b[_0x571971(0x299)],'send',_0x5367bd);}_0x5a292b[_0x571971(0x30a)]&&await _0x56af1f[_0x571971(0x249)](_0x5a292b['notifyEmailInstance'],'send',{'text':_0x405a5e,'to':_0x5a292b[_0x571971(0x265)]});}async function runGeminiAnalysis(_0xedbcdd,_0x49edc5=''){const _0x1ae05a=a0_0x3382d1;if(!_0xedbcdd[_0x1ae05a(0x1d2)])return;if(_0xedbcdd['eventHistory'][_0x1ae05a(0x239)]===0x0)return;const _0x53283f=_0xedbcdd[_0x1ae05a(0x2f3)][_0x1ae05a(0x1e2)](0x0,0xf),_0x3be7be=await getWeatherContext(_0xedbcdd),_0x5ed1a5=_0xedbcdd[_0x1ae05a(0x333)],_0x2f80cb=PERSONA_MAPPING[_0xedbcdd[_0x1ae05a(0x2b9)]['aiPersona']||_0x1ae05a(0x277)],_0x1aca62=_0xedbcdd[_0x1ae05a(0x2b9)][_0x1ae05a(0x2f1)]||_0x1ae05a(0x1e8);let _0x180e37=_0x1ae05a(0x252);try{const _0x3ecb56=await _0xedbcdd[_0x1ae05a(0x31b)](_0x1ae05a(0x1d6));if(_0x3ecb56&&_0x3ecb56[_0x1ae05a(0x344)])_0x180e37=_0x3ecb56[_0x1ae05a(0x344)];}catch(_0x4ac8c6){}let _0x54a4ad=![];try{const _0x2ed251=await _0xedbcdd[_0x1ae05a(0x31b)](_0x1ae05a(0x25a));if(_0x2ed251&&_0x2ed251[_0x1ae05a(0x344)])_0x54a4ad=!![];}catch(_0x153d53){}const _0x1bb13b=_0x1ae05a(0x1f7)+_0x2f80cb+_0x1ae05a(0x2df)+_0x1aca62+'.\x20SYSTEM_MODE:\x20'+_0x5ed1a5+'.\x20WETTER:\x20'+_0x3be7be+_0x1ae05a(0x294)+_0x180e37+_0x1ae05a(0x33d)+JSON['stringify'](_0x53283f)+_0x1ae05a(0x334)+_0x49edc5+_0x1ae05a(0x338);try{const _0x57acbf=await _0xedbcdd[_0x1ae05a(0x1d2)][_0x1ae05a(0x259)](_0x1bb13b),_0x5f2d02=JSON[_0x1ae05a(0x34a)](_0x57acbf['response'][_0x1ae05a(0x306)]()[_0x1ae05a(0x201)](/```json|```/g,'')[_0x1ae05a(0x215)]());await _0xedbcdd[_0x1ae05a(0x279)](_0x1ae05a(0x257),{'val':JSON[_0x1ae05a(0x2b0)](_0x5f2d02),'ack':!![]});if(_0x5f2d02['summary'])await _0xedbcdd['setStateAsync'](_0x1ae05a(0x2d1),{'val':_0x5f2d02[_0x1ae05a(0x24a)],'ack':!![]});const _0xc84fb8={'timestamp':Date['now'](),'id':Date[_0x1ae05a(0x28b)]()['toString'](),'analysis':{'activity':{'summary':_0x5f2d02[_0x1ae05a(0x24a)],'isAlert':_0x5f2d02[_0x1ae05a(0x327)],'alertReason':_0x5f2d02['alertReason']},'comfort':{'automationProposal':_0x5f2d02[_0x1ae05a(0x30d)]}}};await updateAnalysisHistory(_0xedbcdd,_0xc84fb8);const _0x4172d4=_0x5f2d02[_0x1ae05a(0x327)]||![];_0x4172d4!==_0xedbcdd[_0x1ae05a(0x23c)]&&(await _0xedbcdd[_0x1ae05a(0x279)](_0x1ae05a(0x21d),{'val':_0x4172d4,'ack':!![]}),_0xedbcdd[_0x1ae05a(0x23c)]=_0x4172d4,_0x4172d4&&(await _0xedbcdd[_0x1ae05a(0x279)](_0x1ae05a(0x2dc),{'val':_0x5f2d02[_0x1ae05a(0x32e)],'ack':!![]}),sendNotification(_0xedbcdd,_0x1ae05a(0x26a)+_0x5f2d02[_0x1ae05a(0x32e)],![],_0x5f2d02[_0x1ae05a(0x289)])));if(_0x5f2d02['automationProposal']&&_0x5f2d02[_0x1ae05a(0x30d)][_0x1ae05a(0x1d9)]){await _0xedbcdd[_0x1ae05a(0x279)](_0x1ae05a(0x29d),{'val':!![],'ack':!![]}),await _0xedbcdd[_0x1ae05a(0x279)](_0x1ae05a(0x25f),{'val':_0x5f2d02[_0x1ae05a(0x30d)][_0x1ae05a(0x322)],'ack':!![]}),await _0xedbcdd[_0x1ae05a(0x279)](_0x1ae05a(0x2f6),{'val':_0x5f2d02[_0x1ae05a(0x30d)][_0x1ae05a(0x2c9)],'ack':!![]}),await _0xedbcdd[_0x1ae05a(0x279)](_0x1ae05a(0x341),{'val':JSON[_0x1ae05a(0x2b0)](_0x5f2d02[_0x1ae05a(0x30d)][_0x1ae05a(0x233)]),'ack':!![]});if(_0x54a4ad)executeAutomationAction(_0xedbcdd);}}catch(_0x4c9099){_0xedbcdd['log']['error'](_0x1ae05a(0x31a)+_0x4c9099[_0x1ae05a(0x1f5)]);}}async function createDailyDigest(_0x45f501){const _0x2d21ca=a0_0x3382d1;if(!_0x45f501['isProVersion'])return;await _0x45f501[_0x2d21ca(0x279)](LTM_DP_STATUS,{'val':_0x2d21ca(0x1e4),'ack':!![]});if(!_0x45f501[_0x2d21ca(0x1d2)]||_0x45f501[_0x2d21ca(0x34f)][_0x2d21ca(0x239)]<LTM_MIN_EVENTS_FOR_COMPRESSION){await _0x45f501[_0x2d21ca(0x279)](LTM_DP_STATUS,{'val':_0x2d21ca(0x2ee),'ack':!![]});return;}const _0x116f90=JSON[_0x2d21ca(0x34a)](JSON[_0x2d21ca(0x2b0)](_0x45f501[_0x2d21ca(0x34f)])),_0x518a0a=_0x116f90[_0x2d21ca(0x239)],_0x47295f=_0x2d21ca(0x1d0)+JSON[_0x2d21ca(0x2b0)](_0x116f90);try{const _0x1e7a68=await _0x45f501['geminiModel']['generateContent'](_0x47295f),_0x1cd9aa=JSON[_0x2d21ca(0x34a)](_0x1e7a68[_0x2d21ca(0x1cd)]['text']()['replace'](/```json|```/g,'')[_0x2d21ca(0x215)]()),_0x2ffa3d={'timestamp':new Date()[_0x2d21ca(0x2bd)](),'eventCount':_0x518a0a,'summary':_0x1cd9aa[_0x2d21ca(0x24a)]||'Digest','activityLevel':_0x1cd9aa['activityLevel']||'normal','systemMode':_0x45f501[_0x2d21ca(0x333)]};_0x45f501[_0x2d21ca(0x241)]['push'](_0x2ffa3d),await saveDailyDigests(_0x45f501),_0x45f501[_0x2d21ca(0x34f)]=[],await saveRawEventLog(_0x45f501),await _0x45f501[_0x2d21ca(0x279)](LTM_DP_STATUS,{'val':_0x2d21ca(0x2f2),'ack':!![]});if(_0x45f501[_0x2d21ca(0x348)])sendToPython(_0x45f501,'ANALYZE_HEALTH',{'digest':_0x2ffa3d});}catch(_0x1a76aa){_0x45f501['log']['error'](_0x1a76aa['message']);}}function setupLtmScheduler(_0x5a3574){const _0x115b50=a0_0x3382d1;try{if(_0x5a3574['ltmJob'])_0x5a3574[_0x115b50(0x2d6)][_0x115b50(0x35b)]();if(!_0x5a3574[_0x115b50(0x348)])return;_0x5a3574[_0x115b50(0x2d6)]=schedule[_0x115b50(0x308)](LTM_SCHEDULE,()=>createDailyDigest(_0x5a3574));}catch(_0x25c4bf){_0x5a3574['log'][_0x115b50(0x32f)](_0x115b50(0x2ec)+_0x25c4bf[_0x115b50(0x1f5)]);}}function setupModeResetScheduler(_0x1e3e87){const _0x145fce=a0_0x3382d1;try{if(_0x1e3e87['modeResetJob'])_0x1e3e87['modeResetJob']['cancel']();_0x1e3e87['modeResetJob']=schedule['scheduleJob'](MODE_RESET_SCHEDULE,async()=>{const _0x4bc755=a0_0x4499;await loadSystemMode(_0x1e3e87),AUTO_RESET_MODES[_0x4bc755(0x218)](_0x1e3e87[_0x4bc755(0x333)])&&await _0x1e3e87[_0x4bc755(0x279)](SYSTEM_DP_MODE,{'val':SYSTEM_MODES['NORMAL'],'ack':![]});});}catch(_0x1bcf88){_0x1e3e87['log'][_0x145fce(0x32f)](_0x145fce(0x1e1)+_0x1bcf88[_0x145fce(0x1f5)]);}}function setupDriftAnalysisScheduler(_0x14d70b){const _0x4164c1=a0_0x3382d1;try{if(_0x14d70b[_0x4164c1(0x2aa)])clearInterval(_0x14d70b[_0x4164c1(0x2aa)]);if(!_0x14d70b[_0x4164c1(0x348)])return;_0x14d70b[_0x4164c1(0x2aa)]=setInterval(()=>runBaselineDriftAnalysis(_0x14d70b),(_0x14d70b[_0x4164c1(0x2b9)][_0x4164c1(0x2ab)]||0x18)*0x36ee80),setTimeout(()=>runBaselineDriftAnalysis(_0x14d70b),0x1388);}catch(_0x1f8a16){_0x14d70b[_0x4164c1(0x343)][_0x4164c1(0x32f)](_0x4164c1(0x31f)+_0x1f8a16[_0x4164c1(0x1f5)]);}}function setupBriefingScheduler(_0x224d96){const _0x48d6f4=a0_0x3382d1;try{if(_0x224d96[_0x48d6f4(0x357)])_0x224d96[_0x48d6f4(0x357)][_0x48d6f4(0x35b)]();if(!_0x224d96[_0x48d6f4(0x2b9)]['briefingEnabled'])return;const _0x2f6282=(_0x224d96[_0x48d6f4(0x2b9)]['briefingTime']||_0x48d6f4(0x323))[_0x48d6f4(0x20d)](':'),_0x25da29=parseInt(_0x2f6282[0x0])||0x8,_0x554c11=parseInt(_0x2f6282[0x1])||0x0,_0x4556bf=_0x554c11+'\x20'+_0x25da29+_0x48d6f4(0x1eb);_0x224d96[_0x48d6f4(0x357)]=schedule['scheduleJob'](_0x4556bf,()=>{sendMorningBriefing(_0x224d96);});}catch(_0x4da9d3){_0x224d96[_0x48d6f4(0x343)]['error']('Briefing\x20Sched\x20Error:\x20'+_0x4da9d3[_0x48d6f4(0x1f5)]);}}async function runBaselineDriftAnalysis(_0x59707e){const _0x2264d3=a0_0x3382d1;if(!_0x59707e[_0x2264d3(0x348)]||!_0x59707e[_0x2264d3(0x1d2)])return;const _0x5ac7b6=_0x59707e[_0x2264d3(0x2b9)][_0x2264d3(0x25e)]||0xe;if(_0x59707e[_0x2264d3(0x241)][_0x2264d3(0x239)]<_0x5ac7b6+0x7){await _0x59707e[_0x2264d3(0x279)](LTM_DP_DRIFT_STATUS,{'val':_0x2264d3(0x234),'ack':!![]});return;}const _0x1fd25d=_0x59707e[_0x2264d3(0x241)][_0x2264d3(0x1e2)](-_0x5ac7b6),_0x3a56f4=_0x59707e[_0x2264d3(0x241)][_0x2264d3(0x1e2)](0x0,_0x59707e[_0x2264d3(0x241)][_0x2264d3(0x239)]-_0x5ac7b6),_0x2f0492='ROLLE:\x20Data\x20Scientist.\x20ZIEL:\x20Drift\x20erkennen.\x20SCHEMA:\x20{\x20\x22baselineDrift\x22:\x20\x22none|slight|significant|critical\x22,\x20\x22driftDetails\x22:\x20\x22string\x22\x20}\x0a\x0aLTB:\x20'+JSON[_0x2264d3(0x2b0)](_0x3a56f4)+'\x0aSTB:\x20'+JSON[_0x2264d3(0x2b0)](_0x1fd25d);try{const _0x52a3aa=await _0x59707e['geminiModel'][_0x2264d3(0x259)](_0x2f0492),_0x28cfde=JSON[_0x2264d3(0x34a)](_0x52a3aa[_0x2264d3(0x1cd)][_0x2264d3(0x306)]()[_0x2264d3(0x201)](/```json|```/g,'')[_0x2264d3(0x215)]());_0x28cfde['baselineDrift']&&(await _0x59707e['setStateAsync'](LTM_DP_DRIFT_STATUS,{'val':_0x28cfde[_0x2264d3(0x35a)],'ack':!![]}),await _0x59707e[_0x2264d3(0x279)](LTM_DP_DRIFT_DETAILS,{'val':_0x28cfde[_0x2264d3(0x1e3)],'ack':!![]}),await _0x59707e[_0x2264d3(0x279)](LTM_DP_DRIFT_LAST_CHECK,{'val':Date[_0x2264d3(0x28b)](),'ack':!![]}));}catch(_0x5eb177){}}class CogniLiving extends utils[a0_0x3382d1(0x364)]{constructor(_0x40d14e){const _0x131604=a0_0x3382d1;super({..._0x40d14e,'name':_0x131604(0x216)}),this[_0x131604(0x2f3)]=[],this[_0x131604(0x1ec)]=[],this[_0x131604(0x34f)]=[],this[_0x131604(0x241)]=[],this[_0x131604(0x228)]={},this[_0x131604(0x254)]={'latitude':0x0,'longitude':0x0,'city':''},this[_0x131604(0x253)]=!![],this[_0x131604(0x212)]=null,this['exitGraceTimer']=null,this[_0x131604(0x32a)]=![],this['genAI']=null,this[_0x131604(0x1d2)]=null,this[_0x131604(0x333)]=SYSTEM_MODES[_0x131604(0x2cc)],this[_0x131604(0x348)]=![],this['lastAlertState']=![],this[_0x131604(0x1f9)]='unknown',this[_0x131604(0x310)]=null,this[_0x131604(0x2d6)]=null,this['modeResetJob']=null,this[_0x131604(0x2aa)]=null,this[_0x131604(0x357)]=null,this['pythonProcess']=null,this[_0x131604(0x203)]=![],this['on'](_0x131604(0x1fb),this[_0x131604(0x1d7)][_0x131604(0x29a)](this)),this['on'](_0x131604(0x2d7),this[_0x131604(0x345)]['bind'](this)),this['on'](_0x131604(0x2be),this[_0x131604(0x21e)][_0x131604(0x29a)](this)),this['on']('message',this[_0x131604(0x312)][_0x131604(0x29a)](this));}async[a0_0x3382d1(0x1d7)](){const _0x5b7864=a0_0x3382d1;this[_0x5b7864(0x343)][_0x5b7864(0x2b8)](_0x5b7864(0x204)+this[_0x5b7864(0x246)]+')\x20-\x20SAFE\x20BOOT');if(!checkAndInstall(this))return;await startSystem(this);}['onUnload'](_0x114f88){const _0x93e8b=a0_0x3382d1;if(this[_0x93e8b(0x310)])clearInterval(this[_0x93e8b(0x310)]);if(this[_0x93e8b(0x2aa)])clearInterval(this[_0x93e8b(0x2aa)]);if(this['ltmJob'])this[_0x93e8b(0x2d6)]['cancel']();if(this[_0x93e8b(0x316)])this['modeResetJob']['cancel']();if(this[_0x93e8b(0x357)])this[_0x93e8b(0x357)]['cancel']();if(this[_0x93e8b(0x212)])clearTimeout(this[_0x93e8b(0x212)]);if(this[_0x93e8b(0x25c)])clearTimeout(this[_0x93e8b(0x25c)]);stopPythonService(this),_0x114f88();}async[a0_0x3382d1(0x345)](_0x24d578,_0x213b82){const _0x2f4a8d=a0_0x3382d1;if(!_0x213b82||this[_0x2f4a8d(0x203)])return;if(_0x24d578[_0x2f4a8d(0x218)](_0x2f4a8d(0x26d))&&_0x24d578[_0x2f4a8d(0x2a3)]('communicate.request')&&_0x213b82['val']){await handleTelegramResponse(this,_0x213b82[_0x2f4a8d(0x344)]);return;}if(_0x24d578===this[_0x2f4a8d(0x1da)]+'.'+SYSTEM_DP_MODE){if(_0x213b82[_0x2f4a8d(0x344)]&&Object[_0x2f4a8d(0x30f)](SYSTEM_MODES)[_0x2f4a8d(0x218)](_0x213b82['val'])){this[_0x2f4a8d(0x333)]=_0x213b82[_0x2f4a8d(0x344)];if(_0x213b82[_0x2f4a8d(0x344)]===SYSTEM_MODES[_0x2f4a8d(0x1f1)])await setPresence(this,![]);else await setPresence(this,!![]);}if(!_0x213b82[_0x2f4a8d(0x358)])this['setState'](_0x24d578,{'val':this[_0x2f4a8d(0x333)],'ack':!![]});return;}if(!_0x213b82[_0x2f4a8d(0x358)]){_0x24d578['includes'](_0x2f4a8d(0x363))&&_0x213b82[_0x2f4a8d(0x344)]&&(this[_0x2f4a8d(0x258)](_0x24d578,{'val':![],'ack':!![]}),runGeminiAnalysis(this));if(_0x24d578[_0x2f4a8d(0x218)](_0x2f4a8d(0x2c7))&&_0x213b82[_0x2f4a8d(0x344)]){this[_0x2f4a8d(0x258)](_0x24d578,{'val':![],'ack':!![]});if(this[_0x2f4a8d(0x348)])createDailyDigest(this);}_0x24d578[_0x2f4a8d(0x218)](_0x2f4a8d(0x31e))&&_0x213b82[_0x2f4a8d(0x344)]&&(this[_0x2f4a8d(0x258)](_0x24d578,{'val':![],'ack':!![]}),sendMorningBriefing(this));_0x24d578[_0x2f4a8d(0x218)](_0x2f4a8d(0x25d))&&_0x213b82[_0x2f4a8d(0x344)]&&(this[_0x2f4a8d(0x258)](_0x24d578,{'val':![],'ack':!![]}),executeAutomationAction(this));if(_0x24d578['includes']('analysis.training.triggerSecurity')&&_0x213b82['val']){this[_0x2f4a8d(0x258)](_0x24d578,{'val':![],'ack':!![]});if(this[_0x2f4a8d(0x348)])try{const _0x1a3a58=await this[_0x2f4a8d(0x31b)](_0x2f4a8d(0x27f));if(_0x1a3a58&&_0x1a3a58['val']){const _0x115c31=JSON[_0x2f4a8d(0x34a)](_0x1a3a58['val']);this['log'][_0x2f4a8d(0x2b8)](_0x2f4a8d(0x29c)),this[_0x2f4a8d(0x279)]('analysis.training.status',{'val':_0x2f4a8d(0x2f7),'ack':!![]}),sendToPython(this,_0x2f4a8d(0x2c1),{'sequences':_0x115c31});}}catch(_0x24a7bb){this[_0x2f4a8d(0x343)][_0x2f4a8d(0x32f)](_0x2f4a8d(0x2d8)+_0x24a7bb[_0x2f4a8d(0x1f5)]);}}if(_0x24d578[_0x2f4a8d(0x218)](_0x2f4a8d(0x313))&&_0x213b82[_0x2f4a8d(0x344)]){this[_0x2f4a8d(0x258)](_0x24d578,{'val':![],'ack':!![]});if(this[_0x2f4a8d(0x348)])try{const _0x5f1d1a=await this[_0x2f4a8d(0x31b)](LTM_DP_DAILY_DIGESTS);if(_0x5f1d1a&&_0x5f1d1a[_0x2f4a8d(0x344)])sendToPython(this,_0x2f4a8d(0x296),{'digests':JSON['parse'](_0x5f1d1a[_0x2f4a8d(0x344)])});}catch(_0x9bc824){}}if(_0x24d578[_0x2f4a8d(0x218)]('analysis.training.triggerEnergy')&&_0x213b82[_0x2f4a8d(0x344)]){this['setState'](_0x24d578,{'val':![],'ack':!![]});if(this[_0x2f4a8d(0x348)])try{const _0x15dc3e=await this[_0x2f4a8d(0x31b)](_0x2f4a8d(0x2c6));if(_0x15dc3e&&_0x15dc3e[_0x2f4a8d(0x344)])sendToPython(this,_0x2f4a8d(0x30c),{'points':JSON[_0x2f4a8d(0x34a)](_0x15dc3e[_0x2f4a8d(0x344)])});}catch(_0x4fc21b){}}return;}if(this[_0x2f4a8d(0x2b9)][_0x2f4a8d(0x242)]&&this[_0x2f4a8d(0x2b9)][_0x2f4a8d(0x242)]['includes'](_0x24d578)){await checkWifiPresence(this);return;}const _0x7a85ae=(this[_0x2f4a8d(0x2b9)][_0x2f4a8d(0x337)]||[])[_0x2f4a8d(0x31c)](_0x4a7dd2=>_0x4a7dd2['id']===_0x24d578);if(_0x7a85ae)processSensorEvent(this,_0x24d578,_0x213b82,_0x7a85ae);}async[a0_0x3382d1(0x312)](_0x443b09){const _0x498e57=a0_0x3382d1;if(typeof _0x443b09===_0x498e57(0x298)&&_0x443b09['message']){if(_0x443b09['command']===_0x498e57(0x223)){const _0x423fb2=_0x443b09[_0x498e57(0x1f5)]['apiKey']||this[_0x498e57(0x2b9)][_0x498e57(0x1e0)];if(!_0x423fb2)return this['sendTo'](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':![],'message':_0x498e57(0x2bf)},_0x443b09[_0x498e57(0x359)]);try{const _0x289577=new GoogleGenerativeAI(_0x423fb2),_0x5c1081=_0x289577[_0x498e57(0x309)]({'model':GEMINI_MODEL}),_0x40614e=await _0x5c1081['generateContent']('Hi');this[_0x498e57(0x326)](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':!![],'message':_0x498e57(0x2f0)+_0x40614e['response'][_0x498e57(0x306)]()},_0x443b09[_0x498e57(0x359)]);}catch(_0x26410e){this[_0x498e57(0x326)](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':![],'message':_0x498e57(0x304)+_0x26410e[_0x498e57(0x1f5)]},_0x443b09[_0x498e57(0x359)]);}}else{if(_0x443b09['command']===_0x498e57(0x26c)){const _0x250237=await getWeatherContext(this),_0x5242cd=await getCalendarContext(this);this['sendTo'](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':!![],'weather':_0x250237,'calendar':_0x5242cd},_0x443b09[_0x498e57(0x359)]);}else{if(_0x443b09[_0x498e57(0x22c)]===_0x498e57(0x319)){if(!this['isProVersion'])return this[_0x498e57(0x326)](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':![],'isPro':![]},_0x443b09[_0x498e57(0x359)]);let _0x562ce8={'status':_0x498e57(0x1df)};try{const _0x5746c4=await this['getStateAsync'](LTM_DP_DRIFT_STATUS);_0x562ce8[_0x498e57(0x27d)]=_0x5746c4?_0x5746c4[_0x498e57(0x344)]:'N/A';}catch(_0x56d34a){}this['sendTo'](_0x443b09['from'],_0x443b09[_0x498e57(0x22c)],{'success':!![],'isPro':!![],'dailyDigests':this[_0x498e57(0x241)],'driftAnalysis':_0x562ce8,'analysisHistory':this['analysisHistory']},_0x443b09['callback']);}else{if(_0x443b09['command']===_0x498e57(0x24c)){const _0x48d65b=this[_0x498e57(0x241)]['length'],_0x51c309=new Date(),_0x338c90=new Date(_0x51c309[_0x498e57(0x2ed)](),_0x51c309[_0x498e57(0x33a)](),_0x51c309[_0x498e57(0x255)]())[_0x498e57(0x362)](),_0x220ba6=this[_0x498e57(0x34f)][_0x498e57(0x22b)](_0x42da89=>new Date(_0x42da89['timestamp'])['getTime']()>_0x338c90)['length'],_0x57a398=new Array(0x18)[_0x498e57(0x217)](0x0);this[_0x498e57(0x34f)][_0x498e57(0x34e)](_0x40c3aa=>{const _0x232f52=_0x498e57,_0xa9cf07=new Date(_0x40c3aa[_0x232f52(0x30b)]);if(_0xa9cf07[_0x232f52(0x362)]()>_0x338c90)_0x57a398[_0xa9cf07[_0x232f52(0x33b)]()]++;});let _0x476ac7={'status':_0x498e57(0x1df)};try{const _0x43da20=await this[_0x498e57(0x31b)](LTM_DP_DRIFT_STATUS);_0x476ac7['status']=_0x43da20?_0x43da20[_0x498e57(0x344)]:'N/A';}catch(_0x1e2bac){}let _0x186039='';try{const _0x29032b=await this[_0x498e57(0x31b)](_0x498e57(0x1d6));_0x186039=_0x29032b?_0x29032b[_0x498e57(0x344)]:'';}catch(_0x536855){}let _0x577f9b=null;!this['geminiModel']&&(_0x577f9b=this[_0x498e57(0x2b9)][_0x498e57(0x1e0)]?_0x498e57(0x274):_0x498e57(0x278));let _0x1dfafd={'detected':![],'description':'','targetId':'','targetValue':'','autoApply':![]};try{const _0x59bd3d=await this[_0x498e57(0x31b)](_0x498e57(0x29d));if(_0x59bd3d&&_0x59bd3d[_0x498e57(0x344)]){_0x1dfafd[_0x498e57(0x1d9)]=!![];const _0x568376=await this[_0x498e57(0x31b)](_0x498e57(0x25f));_0x1dfafd[_0x498e57(0x322)]=_0x568376?_0x568376[_0x498e57(0x344)]:'';const _0x5a7a10=await this[_0x498e57(0x31b)](_0x498e57(0x2f6));_0x1dfafd['targetId']=_0x5a7a10?_0x5a7a10[_0x498e57(0x344)]:'';const _0x411633=await this[_0x498e57(0x31b)](_0x498e57(0x341));_0x1dfafd[_0x498e57(0x233)]=_0x411633?_0x411633['val']:'';}const _0x38ae3e=await this[_0x498e57(0x31b)]('analysis.automation.autoApply');_0x1dfafd['autoApply']=_0x38ae3e?!!_0x38ae3e[_0x498e57(0x344)]:![];}catch(_0x550997){}this['sendTo'](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':!![],'eventHistory':this[_0x498e57(0x2f3)]['slice'](0x0,0xf),'stats':{'digestCount':_0x48d65b,'eventCountToday':_0x220ba6,'hourlyActivity':_0x57a398,'driftStatus':_0x476ac7[_0x498e57(0x27d)],'isPresent':this['isPresent'],'presenceWho':_0x186039,'minDays':this[_0x498e57(0x2b9)][_0x498e57(0x23d)]||0x7,'stbDays':this['config'][_0x498e57(0x25e)]||0xe,'ltbDays':this[_0x498e57(0x2b9)][_0x498e57(0x1ef)]||0x3c,'systemError':_0x577f9b},'automation':_0x1dfafd},_0x443b09[_0x498e57(0x359)]);}else{if(_0x443b09[_0x498e57(0x22c)]==='scanDevices')try{const _0x464d21=await scanForDevices(this,_0x443b09['message']||{});this[_0x498e57(0x326)](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':!![],'devices':_0x464d21},_0x443b09[_0x498e57(0x359)]);}catch(_0x126320){this[_0x498e57(0x326)](_0x443b09['from'],_0x443b09[_0x498e57(0x22c)],{'success':![],'error':_0x126320[_0x498e57(0x1f5)]},_0x443b09['callback']);}else{if(_0x443b09[_0x498e57(0x22c)]===_0x498e57(0x202)){const _0x17b43e=await this[_0x498e57(0x2a0)](_0x498e57(0x355),_0x498e57(0x1e9)),_0x49b8f6=[];if(_0x17b43e)for(const _0x2dda1c in _0x17b43e){const _0x1ed740=_0x17b43e[_0x2dda1c],_0x2dd004=(_0x1ed740['common']&&typeof _0x1ed740['common']['name']==='object'?_0x1ed740[_0x498e57(0x1ce)][_0x498e57(0x28a)]['de']:_0x1ed740[_0x498e57(0x1ce)][_0x498e57(0x28a)])||_0x1ed740[_0x498e57(0x1ce)]['name'];_0x49b8f6[_0x498e57(0x2cd)]({'id':_0x2dda1c,'name':_0x2dd004});}this['sendTo'](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':!![],'enums':_0x49b8f6},_0x443b09[_0x498e57(0x359)]);}else{if(_0x443b09[_0x498e57(0x22c)]===_0x498e57(0x29f)){const _0x3fa278=_0x443b09['message']['instance'];if(!_0x3fa278)return this['sendTo'](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':![],'error':_0x498e57(0x1dd)},_0x443b09[_0x498e57(0x359)]);const _0x181a87=await getCalendarNames(this,_0x3fa278);this[_0x498e57(0x326)](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':!![],'names':_0x181a87},_0x443b09[_0x498e57(0x359)]);}else{if(_0x443b09['command']===_0x498e57(0x361)){const {targetId:_0x32a559,targetValue:_0x10176b}=_0x443b09['message'];this[_0x498e57(0x343)][_0x498e57(0x2b8)](_0x498e57(0x26e)+_0x32a559+'\x20=\x20'+_0x10176b),await this[_0x498e57(0x279)]('analysis.automation.patternDetected',{'val':!![],'ack':!![]}),await this[_0x498e57(0x279)]('analysis.automation.description',{'val':_0x498e57(0x1cb)+_0x32a559,'ack':!![]}),await this[_0x498e57(0x279)](_0x498e57(0x2f6),{'val':_0x32a559,'ack':!![]}),await this[_0x498e57(0x279)](_0x498e57(0x341),{'val':_0x10176b,'ack':!![]}),this[_0x498e57(0x326)](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':!![]},_0x443b09[_0x498e57(0x359)]);}else{if(_0x443b09[_0x498e57(0x22c)]===_0x498e57(0x27a)){const {historyId:_0x201411,rating:_0x3530fb,comment:_0x4b0dd0,alertReason:_0x5808db}=_0x443b09[_0x498e57(0x1f5)];_0x201411&&_0x3530fb?(await saveFeedback(this,{'timestamp':Date['now'](),'historyId':_0x201411,'rating':_0x3530fb,'comment':_0x4b0dd0,'alertReason':_0x5808db}),this['sendTo'](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':!![]},_0x443b09[_0x498e57(0x359)])):this['sendTo'](_0x443b09[_0x498e57(0x280)],_0x443b09['command'],{'success':![],'error':_0x498e57(0x211)},_0x443b09[_0x498e57(0x359)]);}else _0x443b09['command']==='dismissAutomation'&&(this['log'][_0x498e57(0x2b8)]('User\x20dismissed\x20automation\x20proposal.'),await this['setStateAsync'](_0x498e57(0x29d),{'val':![],'ack':!![]}),await this['setStateAsync']('analysis.automation.description',{'val':'','ack':!![]}),this[_0x498e57(0x326)](_0x443b09[_0x498e57(0x280)],_0x443b09[_0x498e57(0x22c)],{'success':!![]},_0x443b09[_0x498e57(0x359)]));}}}}}}}}}}}if(require[a0_0x3382d1(0x2e9)]!==module)module[a0_0x3382d1(0x22a)]=_0x53210b=>new CogniLiving(_0x53210b);else new CogniLiving();